2025-11-14 00:57:58 | INFO | __main__ | 
================================================================================
2025-11-14 00:57:58 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 00:57:58 | INFO | __main__ | ================================================================================
2025-11-14 00:57:58 | INFO | __main__ | 
[1/4] Validating target configuration...
2025-11-14 00:57:58 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 00:57:58 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 00:57:58 | INFO | __main__ | 
[2/4] Validating model objectives...
2025-11-14 00:57:58 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 00:57:58 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 00:57:58 | INFO | __main__ | 
[3/4] Validating quantile configuration...
2025-11-14 00:57:58 | ERROR | __main__ | ❌ Quantile objective missing
2025-11-14 00:57:58 | INFO | __main__ | 
[4/4] Validating expected model count...
2025-11-14 00:57:58 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 00:57:58 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 00:57:58 | INFO | __main__ |     - 1 direction classifier
2025-11-14 00:57:58 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 00:57:58 | ERROR | __main__ | 
❌ Configuration validation FAILED
2025-11-14 00:57:58 | ERROR | __main__ |    Please fix configuration before training
2025-11-14 00:57:58 | INFO | __main__ | ================================================================================

2025-11-14 00:57:58 | ERROR | __main__ | ❌ Configuration validation failed. Aborting.
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | ================================================================================
2025-11-14 01:04:59 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:04:59 | INFO | __main__ | ================================================================================
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:04:59 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:04:59 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:04:59 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:04:59 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:04:59 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:04:59 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:04:59 | INFO | __main__ | 
2025-11-14 01:04:59 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:04:59 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:04:59 | INFO | __main__ | ================================================================================
2025-11-14 01:04:59 | INFO | __main__ | 
================================================================================
2025-11-14 01:04:59 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:04:59 | INFO | __main__ | ================================================================================
2025-11-14 01:04:59 | INFO | __main__ | 
[1/3] Fetching market data...
2025-11-14 01:04:59 | ERROR | __main__ | 
❌ Training failed with error: 'UnifiedDataFetcher' object has no attribute 'fetch_all_data'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 439, in main
    features_df, spx_returns, market_data = prepare_training_data()
                                            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 66, in prepare_training_data
    market_data = data_fetcher.fetch_all_data(years=10)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'UnifiedDataFetcher' object has no attribute 'fetch_all_data'. Did you mean: 'fetch_all_cboe'?
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | ================================================================================
2025-11-14 01:09:46 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:09:46 | INFO | __main__ | ================================================================================
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:09:46 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:09:46 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:09:46 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:09:46 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:09:46 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:09:46 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:09:46 | INFO | __main__ | 
2025-11-14 01:09:46 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:09:46 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:09:46 | INFO | __main__ | ================================================================================
2025-11-14 01:09:46 | INFO | __main__ | 
================================================================================
2025-11-14 01:09:46 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:09:46 | INFO | __main__ | ================================================================================
2025-11-14 01:09:46 | INFO | __main__ | 
[1/3] Fetching market data...
2025-11-14 01:09:46 | INFO | __main__ |   Fetching VIX...
2025-11-14 01:09:47 | INFO | __main__ |     VIX: 1062 rows
2025-11-14 01:09:47 | INFO | __main__ |   Fetching SPX...
2025-11-14 01:09:47 | INFO | __main__ |     SPX: 1062 rows
2025-11-14 01:09:47 | INFO | __main__ |   Fetching FRED series...
2025-11-14 01:09:52 | ERROR | __main__ | 
❌ Training failed with error: name 'pd' is not defined
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 506, in main
    features_df, spx_returns, market_data = prepare_training_data()
                                            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 113, in prepare_training_data
    market_data["treasury"] = pd.DataFrame(treasury_series)
                              ^^
NameError: name 'pd' is not defined
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | ================================================================================
2025-11-14 01:10:28 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:10:28 | INFO | __main__ | ================================================================================
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:10:28 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:10:28 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:10:28 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:10:28 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:10:28 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:10:28 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:10:28 | INFO | __main__ | 
2025-11-14 01:10:28 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:10:28 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:10:28 | INFO | __main__ | ================================================================================
2025-11-14 01:10:28 | INFO | __main__ | 
================================================================================
2025-11-14 01:10:28 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:10:28 | INFO | __main__ | ================================================================================
2025-11-14 01:10:28 | INFO | __main__ | 
[1/3] Fetching market data...
2025-11-14 01:10:28 | INFO | __main__ |   Fetching VIX...
2025-11-14 01:10:28 | INFO | __main__ |     VIX: 1062 rows
2025-11-14 01:10:28 | INFO | __main__ |   Fetching SPX...
2025-11-14 01:10:28 | INFO | __main__ |     SPX: 1062 rows
2025-11-14 01:10:28 | INFO | __main__ |   Fetching FRED series...
2025-11-14 01:10:33 | INFO | __main__ |     Treasury: 14 series
2025-11-14 01:10:33 | INFO | __main__ |     Macro: 11 series
2025-11-14 01:10:33 | INFO | __main__ |   Fetching CBOE data...
2025-11-14 01:10:33 | INFO | __main__ |     CBOE: 20 series
2025-11-14 01:10:33 | INFO | __main__ | 
[2/3] Engineering features...
2025-11-14 01:10:33 | ERROR | __main__ | 
❌ Training failed with error: FeatureEngineer.__init__() missing 1 required positional argument: 'data_fetcher'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 508, in main
    features_df, spx_returns, market_data = prepare_training_data()
                                            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 147, in prepare_training_data
    feature_engineer = FeatureEngineer()
                       ^^^^^^^^^^^^^^^^^
TypeError: FeatureEngineer.__init__() missing 1 required positional argument: 'data_fetcher'
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | ================================================================================
2025-11-14 01:11:24 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:11:24 | INFO | __main__ | ================================================================================
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:11:24 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:11:24 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:11:24 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:11:24 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:11:24 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:11:24 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:11:24 | INFO | __main__ | 
2025-11-14 01:11:24 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:11:24 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:11:24 | INFO | __main__ | ================================================================================
2025-11-14 01:11:24 | INFO | __main__ | 
================================================================================
2025-11-14 01:11:24 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:11:24 | INFO | __main__ | ================================================================================
2025-11-14 01:11:24 | INFO | __main__ | 
[1/3] Fetching market data...
2025-11-14 01:11:24 | INFO | __main__ |   Fetching VIX...
2025-11-14 01:11:24 | INFO | __main__ |     VIX: 1062 rows
2025-11-14 01:11:24 | INFO | __main__ |   Fetching SPX...
2025-11-14 01:11:24 | INFO | __main__ |     SPX: 1062 rows
2025-11-14 01:11:24 | INFO | __main__ |   Fetching FRED series...
2025-11-14 01:11:28 | INFO | __main__ |     Treasury: 14 series
2025-11-14 01:11:28 | INFO | __main__ |     Macro: 11 series
2025-11-14 01:11:28 | INFO | __main__ |   Fetching CBOE data...
2025-11-14 01:11:28 | INFO | __main__ |     CBOE: 20 series
2025-11-14 01:11:28 | INFO | __main__ | 
[2/3] Engineering features...
2025-11-14 01:11:28 | ERROR | __main__ | 
❌ Training failed with error: 'FeatureEngineer' object has no attribute 'create_features'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 508, in main
    features_df, spx_returns, market_data = prepare_training_data()
                                            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 148, in prepare_training_data
    features_df = feature_engineer.create_features(market_data)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FeatureEngineer' object has no attribute 'create_features'
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | ================================================================================
2025-11-14 01:23:36 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:23:36 | INFO | __main__ | ================================================================================
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:23:36 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:23:36 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:23:36 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:23:36 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:23:36 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:23:36 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:23:36 | INFO | __main__ | 
2025-11-14 01:23:36 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:23:36 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:23:36 | INFO | __main__ | ================================================================================
2025-11-14 01:23:36 | INFO | __main__ | 
================================================================================
2025-11-14 01:23:36 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:23:36 | INFO | __main__ | ================================================================================
2025-11-14 01:23:36 | INFO | __main__ | 
[1/2] Initializing feature engineering pipeline...
2025-11-14 01:23:36 | INFO | __main__ | 
[2/2] Building complete feature set...
2025-11-14 01:23:36 | INFO | __main__ |   Training window: 3 years
2025-11-14 01:23:42 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 01:23:42 | INFO | __main__ | 
  Extracting SPX returns...
2025-11-14 01:23:42 | INFO | __main__ |   SPX returns: 1062 values
  Date range: 2021-08-23 to 2025-11-12
2025-11-14 01:23:42 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 01:23:42 | INFO | __main__ | ================================================================================

2025-11-14 01:23:42 | INFO | __main__ | 
================================================================================
2025-11-14 01:23:42 | INFO | __main__ | MODEL TRAINING
2025-11-14 01:23:42 | INFO | __main__ | ================================================================================
2025-11-14 01:23:42 | INFO | __main__ | 
Starting training...
2025-11-14 01:23:42 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 01:23:42 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 01:23:42 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 01:23:42 | ERROR | __main__ | 
❌ Training failed with error: train_probabilistic_forecaster() got an unexpected keyword argument 'features_df'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 357, in main
    training_results = train_probabilistic_forecaster(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: train_probabilistic_forecaster() got an unexpected keyword argument 'features_df'
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | ================================================================================
2025-11-14 01:26:15 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:26:15 | INFO | __main__ | ================================================================================
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:26:15 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:26:15 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:26:15 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:26:15 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:26:15 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:26:15 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:26:15 | INFO | __main__ | 
2025-11-14 01:26:15 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:26:15 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:26:15 | INFO | __main__ | ================================================================================
2025-11-14 01:26:15 | INFO | __main__ | 
================================================================================
2025-11-14 01:26:15 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:26:15 | INFO | __main__ | ================================================================================
2025-11-14 01:26:15 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 01:26:15 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 01:26:15 | INFO | __main__ |   Training window: 3 years
2025-11-14 01:26:20 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 01:26:20 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 01:26:20 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 01:26:20 | INFO | __main__ |   Cohort distribution:
2025-11-14 01:26:20 | INFO | __main__ |     q1: 1062 samples
2025-11-14 01:26:20 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 01:26:20 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 01:26:20 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 01:26:20 | INFO | __main__ | ================================================================================

2025-11-14 01:26:20 | INFO | __main__ | 
================================================================================
2025-11-14 01:26:20 | INFO | __main__ | MODEL TRAINING
2025-11-14 01:26:20 | INFO | __main__ | ================================================================================
2025-11-14 01:26:20 | INFO | __main__ | 
Starting training...
2025-11-14 01:26:20 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 01:26:20 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 01:26:20 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:26:20 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 01:26:31 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0811
2025-11-14 01:26:45 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0638
2025-11-14 01:27:01 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0699
2025-11-14 01:27:15 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1031
2025-11-14 01:27:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3113
2025-11-14 01:27:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 01:27:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.580
2025-11-14 01:27:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 01:27:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 01:27:36 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 01:27:36 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 01:27:36 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 01:27:37 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 01:27:37 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 01:27:37 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 01:27:37 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:27:37 | INFO | __main__ | 
================================================================================
2025-11-14 01:27:37 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 01:27:37 | INFO | __main__ | ================================================================================
2025-11-14 01:27:37 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 01:27:37 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 01:27:37 | INFO | __main__ | 
================================================================================

2025-11-14 01:27:37 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_012737.json
2025-11-14 01:27:37 | INFO | __main__ | 
================================================================================
2025-11-14 01:27:37 | INFO | __main__ | MODEL VALIDATION
2025-11-14 01:27:37 | INFO | __main__ | ================================================================================
2025-11-14 01:27:37 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 01:27:37 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 01:27:37 | ERROR | __main__ | ❌ Model loading/prediction failed: "['forward_realized_vol'] not in index"
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | ================================================================================
2025-11-14 01:30:40 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:30:40 | INFO | __main__ | ================================================================================
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:30:40 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:30:40 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:30:40 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:30:40 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:30:40 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:30:40 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:30:40 | INFO | __main__ | 
2025-11-14 01:30:40 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:30:40 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:30:40 | INFO | __main__ | ================================================================================
2025-11-14 01:30:40 | INFO | __main__ | 
================================================================================
2025-11-14 01:30:40 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:30:40 | INFO | __main__ | ================================================================================
2025-11-14 01:30:40 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 01:30:40 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 01:30:40 | INFO | __main__ |   Training window: 3 years
2025-11-14 01:30:44 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 01:30:44 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 01:30:44 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 01:30:44 | INFO | __main__ |   Cohort distribution:
2025-11-14 01:30:44 | INFO | __main__ |     q1: 1062 samples
2025-11-14 01:30:44 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 01:30:44 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 01:30:44 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 01:30:44 | INFO | __main__ | ================================================================================

2025-11-14 01:30:44 | INFO | __main__ | 
================================================================================
2025-11-14 01:30:44 | INFO | __main__ | MODEL TRAINING
2025-11-14 01:30:44 | INFO | __main__ | ================================================================================
2025-11-14 01:30:44 | INFO | __main__ | 
Starting training...
2025-11-14 01:30:44 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 01:30:44 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 01:30:44 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:30:44 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 01:30:56 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0811
2025-11-14 01:31:10 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0638
2025-11-14 01:31:24 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0699
2025-11-14 01:31:38 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1031
2025-11-14 01:31:48 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3113
2025-11-14 01:31:48 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 01:31:55 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.580
2025-11-14 01:31:55 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 01:31:55 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 01:31:58 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 01:31:58 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 01:31:58 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 01:31:59 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 01:31:59 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 01:31:59 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 01:31:59 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:31:59 | INFO | __main__ | 
================================================================================
2025-11-14 01:31:59 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 01:31:59 | INFO | __main__ | ================================================================================
2025-11-14 01:31:59 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 01:31:59 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 01:31:59 | INFO | __main__ | 
================================================================================

2025-11-14 01:31:59 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_013159.json
2025-11-14 01:31:59 | INFO | __main__ | 
================================================================================
2025-11-14 01:31:59 | INFO | __main__ | MODEL VALIDATION
2025-11-14 01:31:59 | INFO | __main__ | ================================================================================
2025-11-14 01:31:59 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 01:31:59 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 01:31:59 | ERROR | __main__ | ❌ Model loading/prediction failed: "['forward_realized_vol'] not in index"
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | ================================================================================
2025-11-14 01:36:29 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:36:29 | INFO | __main__ | ================================================================================
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:36:29 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:36:29 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:36:29 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:36:29 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:36:29 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:36:29 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:36:29 | INFO | __main__ | 
2025-11-14 01:36:29 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:36:29 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:36:29 | INFO | __main__ | ================================================================================
2025-11-14 01:36:29 | INFO | __main__ | 
================================================================================
2025-11-14 01:36:29 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:36:29 | INFO | __main__ | ================================================================================
2025-11-14 01:36:29 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 01:36:29 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 01:36:29 | INFO | __main__ |   Training window: 3 years
2025-11-14 01:36:33 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 01:36:33 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 01:36:33 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 01:36:33 | INFO | __main__ |   Cohort distribution:
2025-11-14 01:36:33 | INFO | __main__ |     q1: 1062 samples
2025-11-14 01:36:33 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 01:36:33 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 01:36:33 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 01:36:33 | INFO | __main__ | ================================================================================

2025-11-14 01:36:33 | INFO | __main__ | 
================================================================================
2025-11-14 01:36:33 | INFO | __main__ | MODEL TRAINING
2025-11-14 01:36:33 | INFO | __main__ | ================================================================================
2025-11-14 01:36:33 | INFO | __main__ | 
Starting training...
2025-11-14 01:36:33 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 01:36:33 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 01:36:33 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:36:33 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 01:36:44 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0811
2025-11-14 01:36:59 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0638
2025-11-14 01:37:15 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0699
2025-11-14 01:37:37 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1031
2025-11-14 01:37:53 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3113
2025-11-14 01:37:53 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 01:38:01 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.580
2025-11-14 01:38:01 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 01:38:01 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 01:38:04 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 01:38:04 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 01:38:04 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 01:38:05 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 01:38:05 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 01:38:05 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 01:38:05 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:38:05 | INFO | __main__ | 
================================================================================
2025-11-14 01:38:05 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 01:38:05 | INFO | __main__ | ================================================================================
2025-11-14 01:38:05 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 01:38:05 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 01:38:05 | INFO | __main__ | 
================================================================================

2025-11-14 01:38:05 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_013805.json
2025-11-14 01:38:05 | INFO | __main__ | 
================================================================================
2025-11-14 01:38:05 | INFO | __main__ | MODEL VALIDATION
2025-11-14 01:38:05 | INFO | __main__ | ================================================================================
2025-11-14 01:38:05 | INFO | __main__ | âœ… Models loaded successfully (tested cohort: q1)
2025-11-14 01:38:05 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 01:38:05 | ERROR | __main__ | âŒ Model loading/prediction failed: "['forward_realized_vol'] not in index"
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 467, in main
    predictions = test_forecaster.predict(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 432, in predict
    X_features = X[self.feature_names]
                 ~^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['forward_realized_vol'] not in index"
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | ================================================================================
2025-11-14 01:47:32 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 01:47:32 | INFO | __main__ | ================================================================================
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 01:47:32 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 01:47:32 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 01:47:32 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 01:47:32 | INFO | __main__ |     - 1 direction classifier
2025-11-14 01:47:32 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 01:47:32 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 01:47:32 | INFO | __main__ | 
2025-11-14 01:47:32 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 01:47:32 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 01:47:32 | INFO | __main__ | ================================================================================
2025-11-14 01:47:32 | INFO | __main__ | 
================================================================================
2025-11-14 01:47:32 | INFO | __main__ | DATA PREPARATION
2025-11-14 01:47:32 | INFO | __main__ | ================================================================================
2025-11-14 01:47:32 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 01:47:32 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 01:47:32 | INFO | __main__ |   Training window: 3 years
2025-11-14 01:47:36 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 01:47:36 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 01:47:36 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 01:47:36 | INFO | __main__ |   Cohort distribution:
2025-11-14 01:47:36 | INFO | __main__ |     q1: 1062 samples
2025-11-14 01:47:36 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 01:47:36 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 01:47:36 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 01:47:36 | INFO | __main__ | ================================================================================

2025-11-14 01:47:36 | INFO | __main__ | 
================================================================================
2025-11-14 01:47:36 | INFO | __main__ | MODEL TRAINING
2025-11-14 01:47:36 | INFO | __main__ | ================================================================================
2025-11-14 01:47:36 | INFO | __main__ | 
Starting training...
2025-11-14 01:47:36 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 01:47:36 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 01:47:36 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 01:47:36 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 01:47:48 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3652
2025-11-14 01:48:02 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3433
2025-11-14 01:48:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3683
2025-11-14 01:48:33 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4429
2025-11-14 01:48:45 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5751
2025-11-14 01:48:45 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 01:48:52 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.586
2025-11-14 01:48:52 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 01:48:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 01:48:55 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 01:48:55 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 01:48:55 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 01:48:56 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 01:48:56 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 01:48:56 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 01:48:56 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 01:48:56 | INFO | __main__ | 
================================================================================
2025-11-14 01:48:56 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 01:48:56 | INFO | __main__ | ================================================================================
2025-11-14 01:48:56 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 01:48:56 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 01:48:56 | INFO | __main__ | 
================================================================================

2025-11-14 01:48:56 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_014856.json
2025-11-14 01:48:56 | INFO | __main__ | 
================================================================================
2025-11-14 01:48:56 | INFO | __main__ | MODEL VALIDATION
2025-11-14 01:48:56 | INFO | __main__ | ================================================================================
2025-11-14 01:48:56 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 01:48:56 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 01:48:56 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 01:48:56 | INFO | __main__ |    Median forecast: -28.21%
2025-11-14 01:48:56 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 01:48:56 | INFO | __main__ |    Direction prob: 0.01
2025-11-14 01:48:56 | INFO | __main__ | 
================================================================================
2025-11-14 01:48:56 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 01:48:56 | INFO | __main__ | ================================================================================
2025-11-14 01:48:56 | INFO | __main__ | 
Models saved to: models
2025-11-14 01:48:56 | INFO | __main__ | 
Next steps:
2025-11-14 01:48:56 | INFO | __main__ |   1. Review training report
2025-11-14 01:48:56 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 01:48:56 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 01:48:56 | INFO | __main__ | ================================================================================

2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | ================================================================================
2025-11-14 10:56:35 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 10:56:35 | INFO | __main__ | ================================================================================
2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 10:56:35 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 10:56:35 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 10:56:35 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 10:56:35 | INFO | __main__ |     - 1 direction classifier
2025-11-14 10:56:35 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 10:56:35 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 10:56:35 | INFO | __main__ | 
2025-11-14 10:56:35 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 10:56:35 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 10:56:35 | INFO | __main__ | ================================================================================
2025-11-14 10:56:35 | INFO | __main__ | 
================================================================================
2025-11-14 10:56:35 | INFO | __main__ | DATA PREPARATION
2025-11-14 10:56:35 | INFO | __main__ | ================================================================================
2025-11-14 10:56:35 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 10:56:35 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 10:56:35 | INFO | __main__ |   Training window: 3 years
2025-11-14 10:56:35 | INFO | __main__ |   Training end date: 2022-12-31
2025-11-14 10:56:36 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 10:56:36 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 10:56:36 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 10:56:37 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 10:56:37 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 10:56:41 | ERROR | __main__ | 
❌ Training failed with error: '<=' not supported between instances of 'int' and 'NoneType'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 397, in main
    complete_df = prepare_training_data()
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 78, in prepare_training_data
    result = feature_engineer.build_complete_features(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/feature_engineer.py", line 770, in build_complete_features
    "calendar_cohort": self.get_calendar_cohort(date)[0],
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/feature_engineer.py", line 552, in get_calendar_cohort
    if range_min <= days_to_opex <= range_max:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | ================================================================================
2025-11-14 11:01:34 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:01:34 | INFO | __main__ | ================================================================================
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:01:34 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:01:34 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:01:34 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:01:34 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:01:34 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:01:34 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:01:34 | INFO | __main__ | 
2025-11-14 11:01:34 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:01:34 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:01:34 | INFO | __main__ | ================================================================================
2025-11-14 11:01:34 | INFO | __main__ | 
================================================================================
2025-11-14 11:01:34 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:01:34 | INFO | __main__ | ================================================================================
2025-11-14 11:01:34 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 11:01:34 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 11:01:34 | INFO | __main__ |   Training window: 3 years
2025-11-14 11:01:34 | INFO | __main__ |   Training end date: 2022-12-31
2025-11-14 11:01:35 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:01:35 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 11:01:36 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:01:36 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:01:37 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:01:42 | ERROR | __main__ | 
❌ Training failed with error: '<=' not supported between instances of 'int' and 'NoneType'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 397, in main
    complete_df = prepare_training_data()
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 78, in prepare_training_data
    result = feature_engineer.build_complete_features(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/feature_engineer.py", line 770, in build_complete_features
    "calendar_cohort": self.get_calendar_cohort(date)[0],
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/feature_engineer.py", line 552, in get_calendar_cohort
    if range_min <= days_to_opex <= range_max:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '<=' not supported between instances of 'int' and 'NoneType'
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | ================================================================================
2025-11-14 11:04:38 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:04:38 | INFO | __main__ | ================================================================================
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:04:38 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:04:38 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:04:38 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:04:38 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:04:38 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:04:38 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:04:38 | INFO | __main__ | 
2025-11-14 11:04:38 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:04:38 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:04:38 | INFO | __main__ | ================================================================================
2025-11-14 11:04:38 | INFO | __main__ | 
================================================================================
2025-11-14 11:04:38 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:04:38 | INFO | __main__ | ================================================================================
2025-11-14 11:04:38 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 11:04:38 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 11:04:38 | INFO | __main__ |   Training window: 3 years
2025-11-14 11:04:38 | INFO | __main__ |   Training end date: 2022-12-31
2025-11-14 11:04:38 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:04:38 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 11:04:39 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:04:39 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:04:40 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:04:43 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 11:04:43 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 11:04:43 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 11:04:43 | INFO | __main__ |   Cohort distribution:
2025-11-14 11:04:43 | INFO | __main__ |     q1: 1062 samples
2025-11-14 11:04:43 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 11:04:43 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 11:04:43 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 11:04:43 | INFO | __main__ | ================================================================================

2025-11-14 11:04:43 | INFO | __main__ | 
================================================================================
2025-11-14 11:04:43 | INFO | __main__ | MODEL TRAINING
2025-11-14 11:04:43 | INFO | __main__ | ================================================================================
2025-11-14 11:04:43 | INFO | __main__ | 
Starting training...
2025-11-14 11:04:43 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 11:04:43 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 11:04:43 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:04:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 11:04:57 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3670
2025-11-14 11:05:11 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3420
2025-11-14 11:05:26 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3663
2025-11-14 11:05:40 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4364
2025-11-14 11:05:51 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5798
2025-11-14 11:05:51 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 11:05:59 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.584
2025-11-14 11:05:59 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 11:05:59 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 11:06:02 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 11:06:02 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 11:06:02 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 11:06:03 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 11:06:03 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 11:06:03 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 11:06:03 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:06:03 | INFO | __main__ | 
================================================================================
2025-11-14 11:06:03 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 11:06:03 | INFO | __main__ | ================================================================================
2025-11-14 11:06:03 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 11:06:03 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 11:06:03 | INFO | __main__ | 
================================================================================

2025-11-14 11:06:03 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_110603.json
2025-11-14 11:06:03 | INFO | __main__ | 
================================================================================
2025-11-14 11:06:03 | INFO | __main__ | MODEL VALIDATION
2025-11-14 11:06:03 | INFO | __main__ | ================================================================================
2025-11-14 11:06:03 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 11:06:03 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 11:06:03 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 11:06:03 | INFO | __main__ |    Median forecast: -30.65%
2025-11-14 11:06:03 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 11:06:03 | INFO | __main__ |    Direction prob: 0.01
2025-11-14 11:06:03 | INFO | __main__ | 
================================================================================
2025-11-14 11:06:03 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 11:06:03 | INFO | __main__ | ================================================================================
2025-11-14 11:06:03 | INFO | __main__ | 
Models saved to: models
2025-11-14 11:06:03 | INFO | __main__ | 
Next steps:
2025-11-14 11:06:03 | INFO | __main__ |   1. Review training report
2025-11-14 11:06:03 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 11:06:03 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 11:06:03 | INFO | __main__ | ================================================================================

2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | ================================================================================
2025-11-14 11:18:54 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:18:54 | INFO | __main__ | ================================================================================
2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:18:54 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:18:54 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:18:54 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:18:54 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:18:54 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:18:54 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:18:54 | INFO | __main__ | 
2025-11-14 11:18:54 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:18:54 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:18:54 | INFO | __main__ | ================================================================================
2025-11-14 11:18:54 | INFO | __main__ | 
================================================================================
2025-11-14 11:18:54 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:18:54 | INFO | __main__ | ================================================================================
2025-11-14 11:18:54 | INFO | __main__ | 
[1/3] Initializing feature engineering pipeline...
2025-11-14 11:18:54 | INFO | __main__ | 
[2/3] Building complete feature set...
2025-11-14 11:18:54 | INFO | __main__ |   Training window: 3 years
2025-11-14 11:18:54 | INFO | __main__ |   Training end date: 2022-12-31
2025-11-14 11:18:55 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:18:55 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 11:18:56 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:18:56 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:18:57 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 11:18:59 | INFO | __main__ |   Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 11:18:59 | INFO | __main__ | 
[3/3] Merging features with price data...
2025-11-14 11:18:59 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 11:18:59 | INFO | __main__ |   Cohort distribution:
2025-11-14 11:18:59 | INFO | __main__ |     q1: 1062 samples
2025-11-14 11:18:59 | INFO | __main__ | 
  Final dataframe shape: (1062, 236)
2025-11-14 11:18:59 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 11:18:59 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 11:18:59 | INFO | __main__ | ================================================================================

2025-11-14 11:18:59 | INFO | __main__ | 
================================================================================
2025-11-14 11:18:59 | INFO | __main__ | MODEL TRAINING
2025-11-14 11:18:59 | INFO | __main__ | ================================================================================
2025-11-14 11:18:59 | INFO | __main__ | 
Starting training...
2025-11-14 11:18:59 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 11:18:59 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 11:18:59 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1062 samples)
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:18:59 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 11:19:11 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3670
2025-11-14 11:19:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3420
2025-11-14 11:19:41 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3663
2025-11-14 11:19:56 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4364
2025-11-14 11:20:07 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5798
2025-11-14 11:20:07 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 11:20:15 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.584
2025-11-14 11:20:15 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 11:20:15 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 11:20:18 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.018
2025-11-14 11:20:18 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 11:20:18 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 11:20:19 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 11:20:19 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 11:20:19 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 11:20:19 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:20:19 | INFO | __main__ | 
================================================================================
2025-11-14 11:20:19 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 11:20:19 | INFO | __main__ | ================================================================================
2025-11-14 11:20:19 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 11:20:19 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 11:20:19 | INFO | __main__ | 
================================================================================

2025-11-14 11:20:19 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_112019.json
2025-11-14 11:20:19 | INFO | __main__ | 
================================================================================
2025-11-14 11:20:19 | INFO | __main__ | MODEL VALIDATION
2025-11-14 11:20:19 | INFO | __main__ | ================================================================================
2025-11-14 11:20:19 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 11:20:19 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 11:20:19 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 11:20:19 | INFO | __main__ |    Median forecast: -30.65%
2025-11-14 11:20:19 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 11:20:19 | INFO | __main__ |    Direction prob: 0.01
2025-11-14 11:20:19 | INFO | __main__ | 
================================================================================
2025-11-14 11:20:19 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 11:20:19 | INFO | __main__ | ================================================================================
2025-11-14 11:20:19 | INFO | __main__ | 
Models saved to: models
2025-11-14 11:20:19 | INFO | __main__ | 
Next steps:
2025-11-14 11:20:19 | INFO | __main__ |   1. Review training report
2025-11-14 11:20:19 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 11:20:19 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 11:20:19 | INFO | __main__ | ================================================================================

2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | ================================================================================
2025-11-14 11:28:03 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:28:03 | INFO | __main__ | ================================================================================
2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:28:03 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:28:03 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:28:03 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:28:03 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:28:03 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:28:03 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:28:03 | INFO | __main__ | 
2025-11-14 11:28:03 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:28:03 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:28:03 | INFO | __main__ | ================================================================================
2025-11-14 11:28:03 | INFO | __main__ | 
================================================================================
2025-11-14 11:28:03 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:28:03 | INFO | __main__ | ================================================================================
2025-11-14 11:28:03 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 11:28:03 | INFO | __main__ | 
[2/4] Building complete feature set (all available data)...
2025-11-14 11:28:03 | INFO | __main__ |   Feature lookback window: 3 years
2025-11-14 11:28:03 | INFO | __main__ |   Training will be filtered to end: 2022-12-31
2025-11-14 11:28:09 | INFO | __main__ |   Features created: 235
  Full date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 11:28:09 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 11:28:09 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 11:28:09 | INFO | __main__ | 
[4/4] Filtering to training period (≤ 2022-12-31)...
2025-11-14 11:28:09 | INFO | __main__ |   Filtered date range: 2021-08-23 to 2022-12-30
  Training samples: 343 (was 1062)
2025-11-14 11:28:09 | INFO | __main__ |   Cohort distribution:
2025-11-14 11:28:09 | INFO | __main__ |     q1: 343 samples
2025-11-14 11:28:09 | INFO | __main__ | 
  Final dataframe shape: (343, 236)
2025-11-14 11:28:09 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 11:28:09 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 11:28:09 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 11:28:09 | INFO | __main__ | ================================================================================

2025-11-14 11:28:09 | INFO | __main__ | 
================================================================================
2025-11-14 11:28:09 | INFO | __main__ | MODEL TRAINING
2025-11-14 11:28:09 | INFO | __main__ | ================================================================================
2025-11-14 11:28:09 | INFO | __main__ | 
Starting training...
2025-11-14 11:28:09 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 11:28:09 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 11:28:09 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (343 samples)
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:28:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 11:28:14 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5385
2025-11-14 11:28:20 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3941
2025-11-14 11:28:27 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3418
2025-11-14 11:28:33 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3275
2025-11-14 11:28:38 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3625
2025-11-14 11:28:38 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 11:28:40 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.529
2025-11-14 11:28:40 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 11:28:40 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 11:28:42 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 11:28:42 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 11:28:42 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 11:28:43 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 11:28:43 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 11:28:43 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 11:28:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:28:43 | INFO | __main__ | 
================================================================================
2025-11-14 11:28:43 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 11:28:43 | INFO | __main__ | ================================================================================
2025-11-14 11:28:43 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 11:28:43 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 11:28:43 | INFO | __main__ | 
================================================================================

2025-11-14 11:28:43 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_112843.json
2025-11-14 11:28:43 | INFO | __main__ | 
================================================================================
2025-11-14 11:28:43 | INFO | __main__ | MODEL VALIDATION
2025-11-14 11:28:43 | INFO | __main__ | ================================================================================
2025-11-14 11:28:43 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 11:28:43 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 11:28:43 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 11:28:43 | INFO | __main__ |    Median forecast: -5.64%
2025-11-14 11:28:43 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 11:28:43 | INFO | __main__ |    Direction prob: 0.02
2025-11-14 11:28:43 | INFO | __main__ | 
================================================================================
2025-11-14 11:28:43 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 11:28:43 | INFO | __main__ | ================================================================================
2025-11-14 11:28:43 | INFO | __main__ | 
Models saved to: models
2025-11-14 11:28:43 | INFO | __main__ | 
Next steps:
2025-11-14 11:28:43 | INFO | __main__ |   1. Review training report
2025-11-14 11:28:43 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 11:28:43 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 11:28:43 | INFO | __main__ | ================================================================================

2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | ================================================================================
2025-11-14 11:29:58 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:29:58 | INFO | __main__ | ================================================================================
2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:29:58 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:29:58 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:29:58 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:29:58 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:29:58 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:29:58 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:29:58 | INFO | __main__ | 
2025-11-14 11:29:58 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:29:58 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:29:58 | INFO | __main__ | ================================================================================
2025-11-14 11:29:58 | INFO | __main__ | 
================================================================================
2025-11-14 11:29:58 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:29:58 | INFO | __main__ | ================================================================================
2025-11-14 11:29:58 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 11:29:58 | INFO | __main__ | 
[2/4] Building complete feature set (all available data)...
2025-11-14 11:29:58 | INFO | __main__ |   Feature lookback window: 3 years
2025-11-14 11:29:58 | INFO | __main__ |   Training will be filtered to end: 2022-12-31
2025-11-14 11:30:02 | INFO | __main__ |   Features created: 235
  Full date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 11:30:02 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 11:30:02 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 11:30:02 | INFO | __main__ | 
[4/4] Filtering to training period (≤ 2022-12-31)...
2025-11-14 11:30:02 | INFO | __main__ |   Filtered date range: 2021-08-23 to 2022-12-30
  Training samples: 343 (was 1062)
2025-11-14 11:30:02 | INFO | __main__ |   Cohort distribution:
2025-11-14 11:30:02 | INFO | __main__ |     q1: 343 samples
2025-11-14 11:30:02 | INFO | __main__ | 
  Final dataframe shape: (343, 236)
2025-11-14 11:30:02 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 11:30:02 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 11:30:02 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 11:30:02 | INFO | __main__ | ================================================================================

2025-11-14 11:30:02 | INFO | __main__ | 
================================================================================
2025-11-14 11:30:02 | INFO | __main__ | MODEL TRAINING
2025-11-14 11:30:02 | INFO | __main__ | ================================================================================
2025-11-14 11:30:02 | INFO | __main__ | 
Starting training...
2025-11-14 11:30:02 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 11:30:02 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 11:30:02 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 |     Total samples: 343
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 |     Valid targets: 338
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (343 samples)
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:30:02 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 11:30:07 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5385
2025-11-14 11:30:13 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3941
2025-11-14 11:30:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3418
2025-11-14 11:30:26 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3275
2025-11-14 11:30:30 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3625
2025-11-14 11:30:30 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 11:30:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.529
2025-11-14 11:30:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 11:30:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 11:30:35 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:30:35 | INFO | __main__ | 
================================================================================
2025-11-14 11:30:35 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 11:30:35 | INFO | __main__ | ================================================================================
2025-11-14 11:30:35 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 11:30:35 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 11:30:35 | INFO | __main__ | 
================================================================================

2025-11-14 11:30:35 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_113035.json
2025-11-14 11:30:35 | INFO | __main__ | 
================================================================================
2025-11-14 11:30:35 | INFO | __main__ | MODEL VALIDATION
2025-11-14 11:30:35 | INFO | __main__ | ================================================================================
2025-11-14 11:30:35 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 11:30:35 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 11:30:35 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 11:30:35 | INFO | __main__ |    Median forecast: -5.64%
2025-11-14 11:30:35 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 11:30:35 | INFO | __main__ |    Direction prob: 0.02
2025-11-14 11:30:35 | INFO | __main__ | 
================================================================================
2025-11-14 11:30:35 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 11:30:35 | INFO | __main__ | ================================================================================
2025-11-14 11:30:35 | INFO | __main__ | 
Models saved to: models
2025-11-14 11:30:35 | INFO | __main__ | 
Next steps:
2025-11-14 11:30:35 | INFO | __main__ |   1. Review training report
2025-11-14 11:30:35 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 11:30:35 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 11:30:35 | INFO | __main__ | ================================================================================

2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | ================================================================================
2025-11-14 11:31:22 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 11:31:22 | INFO | __main__ | ================================================================================
2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 11:31:22 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 11:31:22 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 11:31:22 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 11:31:22 | INFO | __main__ |     - 1 direction classifier
2025-11-14 11:31:22 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 11:31:22 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 11:31:22 | INFO | __main__ | 
2025-11-14 11:31:22 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 11:31:22 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 11:31:22 | INFO | __main__ | ================================================================================
2025-11-14 11:31:22 | INFO | __main__ | 
================================================================================
2025-11-14 11:31:22 | INFO | __main__ | DATA PREPARATION
2025-11-14 11:31:22 | INFO | __main__ | ================================================================================
2025-11-14 11:31:22 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 11:31:22 | INFO | __main__ | 
[2/4] Building complete feature set (all available data)...
2025-11-14 11:31:22 | INFO | __main__ |   Feature lookback window: 3 years
2025-11-14 11:31:22 | INFO | __main__ |   Training will be filtered to end: 2022-12-31
2025-11-14 11:31:26 | INFO | __main__ |   Features created: 235
  Full date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 11:31:26 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 11:31:26 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 11:31:26 | INFO | __main__ | 
[4/4] Filtering to training period (≤ 2022-12-31)...
2025-11-14 11:31:26 | INFO | __main__ |   Filtered date range: 2021-08-23 to 2022-12-30
  Training samples: 343 (was 1062)
2025-11-14 11:31:26 | INFO | __main__ |   Cohort distribution:
2025-11-14 11:31:26 | INFO | __main__ |     q1: 343 samples
2025-11-14 11:31:26 | INFO | __main__ | 
  Final dataframe shape: (343, 236)
2025-11-14 11:31:26 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 11:31:26 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 11:31:26 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 11:31:26 | INFO | __main__ | ================================================================================

2025-11-14 11:31:26 | INFO | __main__ | 
================================================================================
2025-11-14 11:31:26 | INFO | __main__ | MODEL TRAINING
2025-11-14 11:31:26 | INFO | __main__ | ================================================================================
2025-11-14 11:31:26 | INFO | __main__ | 
Starting training...
2025-11-14 11:31:26 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 11:31:26 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 11:31:26 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 |     Total samples: 343
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 |     Valid targets: 338
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (343 samples)
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 11:31:26 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 11:31:31 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5385
2025-11-14 11:31:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3941
2025-11-14 11:31:44 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3418
2025-11-14 11:31:50 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3275
2025-11-14 11:31:55 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3625
2025-11-14 11:31:55 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 11:31:58 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.529
2025-11-14 11:31:58 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 11:31:58 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 11:31:59 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 11:31:59 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 11:31:59 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 11:32:00 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 11:32:00 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 11:32:00 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 11:32:00 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 11:32:00 | INFO | __main__ | 
================================================================================
2025-11-14 11:32:00 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 11:32:00 | INFO | __main__ | ================================================================================
2025-11-14 11:32:00 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 11:32:00 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 11:32:00 | INFO | __main__ | 
================================================================================

2025-11-14 11:32:00 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_113200.json
2025-11-14 11:32:00 | INFO | __main__ | 
================================================================================
2025-11-14 11:32:00 | INFO | __main__ | MODEL VALIDATION
2025-11-14 11:32:00 | INFO | __main__ | ================================================================================
2025-11-14 11:32:00 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 11:32:00 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 11:32:00 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 11:32:00 | INFO | __main__ |    Median forecast: -5.64%
2025-11-14 11:32:00 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 11:32:00 | INFO | __main__ |    Direction prob: 0.02
2025-11-14 11:32:00 | INFO | __main__ | 
================================================================================
2025-11-14 11:32:00 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 11:32:00 | INFO | __main__ | ================================================================================
2025-11-14 11:32:00 | INFO | __main__ | 
Models saved to: models
2025-11-14 11:32:00 | INFO | __main__ | 
Next steps:
2025-11-14 11:32:00 | INFO | __main__ |   1. Review training report
2025-11-14 11:32:00 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 11:32:00 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 11:32:00 | INFO | __main__ | ================================================================================

2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | ================================================================================
2025-11-14 12:26:40 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 12:26:40 | INFO | __main__ | ================================================================================
2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 12:26:40 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 12:26:40 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 12:26:40 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 12:26:40 | INFO | __main__ |     - 1 direction classifier
2025-11-14 12:26:40 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 12:26:40 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 12:26:40 | INFO | __main__ | 
2025-11-14 12:26:40 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 12:26:40 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 12:26:40 | INFO | __main__ | ================================================================================
2025-11-14 12:26:40 | INFO | __main__ | 
================================================================================
2025-11-14 12:26:40 | INFO | __main__ | DATA PREPARATION
2025-11-14 12:26:40 | INFO | __main__ | ================================================================================
2025-11-14 12:26:40 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 12:26:40 | INFO | __main__ | 
[2/4] Building complete feature set (anchored to training end)...
2025-11-14 12:26:40 | INFO | __main__ |   Feature lookback window: 3 years
2025-11-14 12:26:40 | INFO | __main__ |   Training end date: 2022-12-31
2025-11-14 12:26:40 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:26:41 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 12:26:41 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:26:41 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:26:42 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:26:44 | INFO | __main__ |   Features created: 235
  Full date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 12:26:44 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 12:26:44 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 12:26:44 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 12:26:44 | WARNING | __main__ | ⚠️  Data extends beyond training end (2025-11-12 > 2022-12-31)
2025-11-14 12:26:44 | INFO | __main__ |   Filtered to: 2022-12-30
2025-11-14 12:26:44 | INFO | __main__ |   Final date range: 2021-08-23 to 2022-12-30
  Training samples: 343
2025-11-14 12:26:44 | INFO | __main__ |   Cohort distribution:
2025-11-14 12:26:44 | INFO | __main__ |     q1: 343 samples
2025-11-14 12:26:44 | INFO | __main__ | 
  Final dataframe shape: (343, 236)
2025-11-14 12:26:44 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 12:26:44 | ERROR | __main__ | 
❌ Training failed with error: ❌ DATA LEAKAGE DETECTED! Latest training date 2025-11-12 exceeds training_end_date 2022-12-31
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 427, in main
    complete_df = prepare_training_data()
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 141, in prepare_training_data
    raise ValueError(
ValueError: ❌ DATA LEAKAGE DETECTED! Latest training date 2025-11-12 exceeds training_end_date 2022-12-31
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | ================================================================================
2025-11-14 12:33:52 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 12:33:52 | INFO | __main__ | ================================================================================
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 12:33:52 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 12:33:52 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 12:33:52 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 12:33:52 | INFO | __main__ |     - 1 direction classifier
2025-11-14 12:33:52 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 12:33:52 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 12:33:52 | INFO | __main__ | 
2025-11-14 12:33:52 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 12:33:52 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 12:33:52 | INFO | __main__ | ================================================================================
2025-11-14 12:33:52 | INFO | __main__ | 
================================================================================
2025-11-14 12:33:52 | INFO | __main__ | DATA PREPARATION
2025-11-14 12:33:52 | INFO | __main__ | ================================================================================
2025-11-14 12:33:52 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 12:33:52 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 12:33:52 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 12:33:52 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 12:33:55 | INFO | __main__ | 
  Features created: 235
  Date range: 2021-08-23 to 2022-12-30
  Total samples: 343
2025-11-14 12:33:55 | INFO | __main__ |   Usable training samples (after warmup): 31
  Effective training period: 2022-11-16 to 2022-12-30
2025-11-14 12:33:55 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 12:33:55 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 12:33:55 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 12:33:55 | INFO | __main__ |   Cohort distribution:
2025-11-14 12:33:55 | INFO | __main__ |     q1: 343 samples
2025-11-14 12:33:55 | INFO | __main__ | 
  Final dataframe shape: (343, 236)
2025-11-14 12:33:55 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 12:33:55 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 12:33:55 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 12:33:55 | INFO | __main__ | ================================================================================

2025-11-14 12:33:55 | INFO | __main__ | 
================================================================================
2025-11-14 12:33:55 | INFO | __main__ | MODEL TRAINING
2025-11-14 12:33:55 | INFO | __main__ | ================================================================================
2025-11-14 12:33:55 | INFO | __main__ | 
Starting training...
2025-11-14 12:33:55 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 12:33:55 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 12:33:55 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 |     Total samples: 343
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 |     Valid targets: 338
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (343 samples)
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 12:33:55 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 12:33:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5356
2025-11-14 12:34:05 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4077
2025-11-14 12:34:12 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3412
2025-11-14 12:34:18 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3438
2025-11-14 12:34:22 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3678
2025-11-14 12:34:22 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 12:34:25 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 12:34:25 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 12:34:25 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 12:34:27 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 12:34:27 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 12:34:27 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 12:34:28 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 12:34:28 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 12:34:28 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 12:34:28 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:34:28 | INFO | __main__ | 
================================================================================
2025-11-14 12:34:28 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 12:34:28 | INFO | __main__ | ================================================================================
2025-11-14 12:34:28 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 12:34:28 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 12:34:28 | INFO | __main__ | 
================================================================================

2025-11-14 12:34:28 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_123428.json
2025-11-14 12:34:28 | INFO | __main__ | 
================================================================================
2025-11-14 12:34:28 | INFO | __main__ | MODEL VALIDATION
2025-11-14 12:34:28 | INFO | __main__ | ================================================================================
2025-11-14 12:34:28 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 12:34:28 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 12:34:28 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 12:34:28 | INFO | __main__ |    Median forecast: -6.56%
2025-11-14 12:34:28 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 12:34:28 | INFO | __main__ |    Direction prob: 0.03
2025-11-14 12:34:28 | INFO | __main__ | 
================================================================================
2025-11-14 12:34:28 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 12:34:28 | INFO | __main__ | ================================================================================
2025-11-14 12:34:28 | INFO | __main__ | 
Models saved to: models
2025-11-14 12:34:28 | INFO | __main__ | 
Next steps:
2025-11-14 12:34:28 | INFO | __main__ |   1. Review training report
2025-11-14 12:34:28 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 12:34:28 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 12:34:28 | INFO | __main__ | ================================================================================

2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | ================================================================================
2025-11-14 12:39:38 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 12:39:38 | INFO | __main__ | ================================================================================
2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 12:39:38 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 12:39:38 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 12:39:38 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 12:39:38 | INFO | __main__ |     - 1 direction classifier
2025-11-14 12:39:38 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 12:39:38 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 12:39:38 | INFO | __main__ | 
2025-11-14 12:39:38 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 12:39:38 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 12:39:38 | INFO | __main__ | ================================================================================
2025-11-14 12:39:38 | INFO | __main__ | 
================================================================================
2025-11-14 12:39:38 | INFO | __main__ | DATA PREPARATION
2025-11-14 12:39:38 | INFO | __main__ | ================================================================================
2025-11-14 12:39:38 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 12:39:38 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 12:39:38 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 12:39:38 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 12:39:39 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:39:39 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 12:39:40 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:39:40 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:39:41 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:39:43 | INFO | __main__ | 
  Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 12:39:43 | INFO | __main__ |   Usable training samples (after warmup): 750
  Effective training period: 2022-11-16 to 2025-11-12
2025-11-14 12:39:43 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 12:39:43 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 12:39:43 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 12:39:43 | ERROR | __main__ | 
❌ Training failed with error: ❌ TEMPORAL ERROR: Data extends beyond training end date!
   Latest: 2025-11-12
   Expected: 2022-12-31
   Check build_complete_features() implementation
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 426, in main
    complete_df = prepare_training_data()
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 127, in prepare_training_data
    raise ValueError(
ValueError: ❌ TEMPORAL ERROR: Data extends beyond training end date!
   Latest: 2025-11-12
   Expected: 2022-12-31
   Check build_complete_features() implementation
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | ================================================================================
2025-11-14 12:40:03 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 12:40:03 | INFO | __main__ | ================================================================================
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 12:40:03 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 12:40:03 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 12:40:03 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 12:40:03 | INFO | __main__ |     - 1 direction classifier
2025-11-14 12:40:03 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 12:40:03 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 12:40:03 | INFO | __main__ | 
2025-11-14 12:40:03 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 12:40:03 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 12:40:03 | INFO | __main__ | ================================================================================
2025-11-14 12:40:03 | INFO | __main__ | 
================================================================================
2025-11-14 12:40:03 | INFO | __main__ | DATA PREPARATION
2025-11-14 12:40:03 | INFO | __main__ | ================================================================================
2025-11-14 12:40:03 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 12:40:03 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 12:40:03 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 12:40:03 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 12:40:03 | ERROR | yfinance | $^GSPC: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:40:04 | ERROR | yfinance | $^VIX: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762754400, endDate = 1672466400")
2025-11-14 12:40:04 | ERROR | yfinance | $CL=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:40:04 | ERROR | yfinance | $DX-Y.NYB: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:40:05 | ERROR | yfinance | $GC=F: possibly delisted; no price data found  (1d 2025-11-10 -> 2022-12-31) (Yahoo error = "Invalid input - start date cannot be after end date. startDate = 1762750800, endDate = 1672462800")
2025-11-14 12:40:07 | INFO | __main__ | 
  Features created: 235
  Date range: 2021-08-23 to 2025-11-12
  Total samples: 1062
2025-11-14 12:40:07 | INFO | __main__ |   Usable training samples (after warmup): 750
  Effective training period: 2022-11-16 to 2025-11-12
2025-11-14 12:40:07 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 12:40:07 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 12:40:07 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 12:40:07 | ERROR | __main__ | 
❌ Training failed with error: ❌ TEMPORAL ERROR: Data extends beyond training end date!
   Latest: 2025-11-12
   Expected: 2022-12-31
   Check build_complete_features() implementation
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 426, in main
    complete_df = prepare_training_data()
                  ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 127, in prepare_training_data
    raise ValueError(
ValueError: ❌ TEMPORAL ERROR: Data extends beyond training end date!
   Latest: 2025-11-12
   Expected: 2022-12-31
   Check build_complete_features() implementation
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | ================================================================================
2025-11-14 12:40:59 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 12:40:59 | INFO | __main__ | ================================================================================
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 12:40:59 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 12:40:59 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 12:40:59 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 12:40:59 | INFO | __main__ |     - 1 direction classifier
2025-11-14 12:40:59 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 12:40:59 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 12:40:59 | INFO | __main__ | 
2025-11-14 12:40:59 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 12:40:59 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 12:40:59 | INFO | __main__ | ================================================================================
2025-11-14 12:40:59 | INFO | __main__ | 
================================================================================
2025-11-14 12:40:59 | INFO | __main__ | DATA PREPARATION
2025-11-14 12:40:59 | INFO | __main__ | ================================================================================
2025-11-14 12:40:59 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 12:40:59 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 12:40:59 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 12:40:59 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 12:41:03 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 12:41:03 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 12:41:03 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 12:41:03 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 12:41:03 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 12:41:03 | INFO | __main__ |   Cohort distribution:
2025-11-14 12:41:03 | INFO | __main__ |     q1: 1066 samples
2025-11-14 12:41:03 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 12:41:03 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 12:41:03 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 12:41:03 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 12:41:03 | INFO | __main__ | ================================================================================

2025-11-14 12:41:03 | INFO | __main__ | 
================================================================================
2025-11-14 12:41:03 | INFO | __main__ | MODEL TRAINING
2025-11-14 12:41:03 | INFO | __main__ | ================================================================================
2025-11-14 12:41:03 | INFO | __main__ | 
Starting training...
2025-11-14 12:41:03 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 12:41:03 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 12:41:03 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1066 samples)
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 12:41:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 12:41:14 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6215
2025-11-14 12:41:28 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4779
2025-11-14 12:41:43 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4007
2025-11-14 12:41:56 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3929
2025-11-14 12:42:07 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4465
2025-11-14 12:42:07 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 12:42:14 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.562
2025-11-14 12:42:14 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 12:42:14 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 12:42:17 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.027
2025-11-14 12:42:17 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 12:42:17 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 12:42:18 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 12:42:18 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 12:42:18 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 12:42:18 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 12:42:18 | INFO | __main__ | 
================================================================================
2025-11-14 12:42:18 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 12:42:18 | INFO | __main__ | ================================================================================
2025-11-14 12:42:18 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 12:42:18 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 12:42:18 | INFO | __main__ | 
================================================================================

2025-11-14 12:42:18 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_124218.json
2025-11-14 12:42:18 | INFO | __main__ | 
================================================================================
2025-11-14 12:42:18 | INFO | __main__ | MODEL VALIDATION
2025-11-14 12:42:18 | INFO | __main__ | ================================================================================
2025-11-14 12:42:18 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 12:42:18 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 12:42:18 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 12:42:18 | INFO | __main__ |    Median forecast: -20.06%
2025-11-14 12:42:18 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 12:42:18 | INFO | __main__ |    Direction prob: 0.02
2025-11-14 12:42:18 | INFO | __main__ | 
================================================================================
2025-11-14 12:42:18 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 12:42:18 | INFO | __main__ | ================================================================================
2025-11-14 12:42:18 | INFO | __main__ | 
Models saved to: models
2025-11-14 12:42:18 | INFO | __main__ | 
Next steps:
2025-11-14 12:42:18 | INFO | __main__ |   1. Review training report
2025-11-14 12:42:18 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 12:42:18 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 12:42:18 | INFO | __main__ | ================================================================================

2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | ================================================================================
2025-11-14 13:33:21 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 13:33:21 | INFO | __main__ | ================================================================================
2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 13:33:21 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 13:33:21 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 13:33:21 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 13:33:21 | INFO | __main__ |     - 1 direction classifier
2025-11-14 13:33:21 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 13:33:21 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 13:33:21 | INFO | __main__ | 
2025-11-14 13:33:21 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 13:33:21 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 13:33:21 | INFO | __main__ | ================================================================================
2025-11-14 13:33:21 | INFO | __main__ | 
================================================================================
2025-11-14 13:33:21 | INFO | __main__ | DATA PREPARATION
2025-11-14 13:33:21 | INFO | __main__ | ================================================================================
2025-11-14 13:33:21 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 13:33:21 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 13:33:21 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 13:33:21 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 13:33:24 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 13:33:24 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 13:33:24 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 13:33:24 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 13:33:24 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 13:33:24 | INFO | __main__ |   Cohort distribution:
2025-11-14 13:33:24 | INFO | __main__ |     q1: 1066 samples
2025-11-14 13:33:24 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 13:33:24 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 13:33:24 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 13:33:24 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 13:33:24 | INFO | __main__ | ================================================================================

2025-11-14 13:33:24 | INFO | __main__ | 
================================================================================
2025-11-14 13:33:24 | INFO | __main__ | MODEL TRAINING
2025-11-14 13:33:24 | INFO | __main__ | ================================================================================
2025-11-14 13:33:24 | INFO | __main__ | 
Starting training...
2025-11-14 13:33:24 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 13:33:24 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 13:33:24 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1066 samples)
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:33:24 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 13:33:36 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6215
2025-11-14 13:33:52 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4779
2025-11-14 13:34:07 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4007
2025-11-14 13:34:21 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3929
2025-11-14 13:34:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4465
2025-11-14 13:34:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 13:34:39 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.562
2025-11-14 13:34:39 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 13:34:39 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.027
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 13:34:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:34:43 | INFO | __main__ | 
================================================================================
2025-11-14 13:34:43 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 13:34:43 | INFO | __main__ | ================================================================================
2025-11-14 13:34:43 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 13:34:43 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 13:34:43 | INFO | __main__ | 
================================================================================

2025-11-14 13:34:43 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_133443.json
2025-11-14 13:34:43 | INFO | __main__ | 
================================================================================
2025-11-14 13:34:43 | INFO | __main__ | MODEL VALIDATION
2025-11-14 13:34:43 | INFO | __main__ | ================================================================================
2025-11-14 13:34:43 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 13:34:43 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 13:34:43 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 13:34:43 | INFO | __main__ |    Median forecast: -20.06%
2025-11-14 13:34:43 | ERROR | __main__ | ❌ Model loading/prediction failed: 'quantiles'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 489, in main
    f"   Quantiles: {list(predictions['quantiles'].keys())}"
                          ~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'quantiles'
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | ================================================================================
2025-11-14 13:38:55 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 13:38:55 | INFO | __main__ | ================================================================================
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 13:38:55 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 13:38:55 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 13:38:55 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 13:38:55 | INFO | __main__ |     - 1 direction classifier
2025-11-14 13:38:55 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 13:38:55 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 13:38:55 | INFO | __main__ | 
2025-11-14 13:38:55 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 13:38:55 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 13:38:55 | INFO | __main__ | ================================================================================
2025-11-14 13:38:55 | INFO | __main__ | 
================================================================================
2025-11-14 13:38:55 | INFO | __main__ | DATA PREPARATION
2025-11-14 13:38:55 | INFO | __main__ | ================================================================================
2025-11-14 13:38:55 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 13:38:55 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 13:38:55 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 13:38:55 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 13:38:58 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 13:38:58 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 13:38:58 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 13:38:58 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 13:38:58 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 13:38:58 | INFO | __main__ |   Cohort distribution:
2025-11-14 13:38:58 | INFO | __main__ |     q1: 1066 samples
2025-11-14 13:38:58 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 13:38:58 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 13:38:58 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 13:38:58 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 13:38:58 | INFO | __main__ | ================================================================================

2025-11-14 13:38:58 | INFO | __main__ | 
================================================================================
2025-11-14 13:38:58 | INFO | __main__ | MODEL TRAINING
2025-11-14 13:38:58 | INFO | __main__ | ================================================================================
2025-11-14 13:38:58 | INFO | __main__ | 
Starting training...
2025-11-14 13:38:58 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 13:38:58 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 13:38:58 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1066 samples)
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:38:58 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 13:39:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6215
2025-11-14 13:39:23 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4779
2025-11-14 13:39:37 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4007
2025-11-14 13:39:50 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3929
2025-11-14 13:40:02 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4465
2025-11-14 13:40:02 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 13:40:09 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.562
2025-11-14 13:40:09 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 13:40:09 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 13:40:12 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.027
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 13:40:13 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:40:13 | INFO | __main__ | 
================================================================================
2025-11-14 13:40:13 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 13:40:13 | INFO | __main__ | ================================================================================
2025-11-14 13:40:13 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 13:40:13 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 13:40:13 | INFO | __main__ | 
================================================================================

2025-11-14 13:40:13 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_134013.json
2025-11-14 13:40:13 | INFO | __main__ | 
================================================================================
2025-11-14 13:40:13 | INFO | __main__ | MODEL VALIDATION
2025-11-14 13:40:13 | INFO | __main__ | ================================================================================
2025-11-14 13:40:13 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 13:40:13 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 13:40:13 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 13:40:13 | INFO | __main__ |    Median forecast: -20.06%
2025-11-14 13:40:13 | ERROR | __main__ | ❌ Model loading/prediction failed: 'quantiles'
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 489, in main
    f"   Quantiles: {list(predictions['quantiles'].keys())}"
                          ~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'quantiles'
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | ================================================================================
2025-11-14 13:44:15 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 13:44:15 | INFO | __main__ | ================================================================================
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 13:44:15 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 13:44:15 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 13:44:15 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 13:44:15 | INFO | __main__ |     - 1 direction classifier
2025-11-14 13:44:15 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 13:44:15 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 13:44:15 | INFO | __main__ | 
2025-11-14 13:44:15 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 13:44:15 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 13:44:15 | INFO | __main__ | ================================================================================
2025-11-14 13:44:15 | INFO | __main__ | 
================================================================================
2025-11-14 13:44:15 | INFO | __main__ | DATA PREPARATION
2025-11-14 13:44:15 | INFO | __main__ | ================================================================================
2025-11-14 13:44:15 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 13:44:15 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 13:44:15 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 13:44:15 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 13:44:18 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 13:44:18 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 13:44:18 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 13:44:18 | INFO | __main__ |   Assigning calendar cohorts...
2025-11-14 13:44:18 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 13:44:18 | INFO | __main__ |   Cohort distribution:
2025-11-14 13:44:18 | INFO | __main__ |     q1: 1066 samples
2025-11-14 13:44:18 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 13:44:18 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 13:44:18 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 13:44:18 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 13:44:18 | INFO | __main__ | ================================================================================

2025-11-14 13:44:18 | INFO | __main__ | 
================================================================================
2025-11-14 13:44:18 | INFO | __main__ | MODEL TRAINING
2025-11-14 13:44:18 | INFO | __main__ | ================================================================================
2025-11-14 13:44:18 | INFO | __main__ | 
Starting training...
2025-11-14 13:44:18 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 13:44:18 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 13:44:18 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | 
Training 1 cohorts: ['q1']
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | Cohort: q1 (1066 samples)
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 13:44:18 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 13:44:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6215
2025-11-14 13:44:43 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4779
2025-11-14 13:44:58 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4007
2025-11-14 13:45:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3929
2025-11-14 13:45:22 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4465
2025-11-14 13:45:22 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 13:45:29 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.562
2025-11-14 13:45:29 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 13:45:29 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 13:45:32 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.027
2025-11-14 13:45:32 | INFO | core.xgboost_trainer_v3 | ✅ Saved: q1
2025-11-14 13:45:32 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 13:45:33 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 13:45:33 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 13:45:33 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 13:45:33 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 13:45:33 | INFO | __main__ | 
================================================================================
2025-11-14 13:45:33 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 13:45:33 | INFO | __main__ | ================================================================================
2025-11-14 13:45:33 | INFO | __main__ | 
Cohorts trained: 1
2025-11-14 13:45:33 | INFO | __main__ |   q1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 13:45:33 | INFO | __main__ | 
================================================================================

2025-11-14 13:45:33 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_134533.json
2025-11-14 13:45:33 | INFO | __main__ | 
================================================================================
2025-11-14 13:45:33 | INFO | __main__ | MODEL VALIDATION
2025-11-14 13:45:33 | INFO | __main__ | ================================================================================
2025-11-14 13:45:33 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: q1)
2025-11-14 13:45:33 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 13:45:33 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 13:45:33 | INFO | __main__ |    Median forecast: -20.06%
2025-11-14 13:45:33 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 13:45:33 | INFO | __main__ |    Q10: -53.85%, Q50: -20.06%, Q90: +7.13%
2025-11-14 13:45:33 | INFO | __main__ |    Direction prob (up): 0.02
2025-11-14 13:45:33 | INFO | __main__ |    Confidence: 0.94
2025-11-14 13:45:33 | INFO | __main__ | 
================================================================================
2025-11-14 13:45:33 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 13:45:33 | INFO | __main__ | ================================================================================
2025-11-14 13:45:33 | INFO | __main__ | 
Models saved to: models
2025-11-14 13:45:33 | INFO | __main__ | 
Next steps:
2025-11-14 13:45:33 | INFO | __main__ |   1. Review training report
2025-11-14 13:45:33 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 13:45:33 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 13:45:33 | INFO | __main__ | ================================================================================

2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | ================================================================================
2025-11-14 14:15:53 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 14:15:53 | INFO | __main__ | ================================================================================
2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 14:15:53 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 14:15:53 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 14:15:53 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 14:15:53 | INFO | __main__ |     - 1 direction classifier
2025-11-14 14:15:53 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 14:15:53 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 14:15:53 | INFO | __main__ | 
2025-11-14 14:15:53 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 14:15:53 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 14:15:53 | INFO | __main__ | ================================================================================
2025-11-14 14:15:53 | INFO | __main__ | 
================================================================================
2025-11-14 14:15:53 | INFO | __main__ | DATA PREPARATION
2025-11-14 14:15:53 | INFO | __main__ | ================================================================================
2025-11-14 14:15:53 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 14:15:53 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 14:15:53 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 14:15:53 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 14:15:56 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 14:15:56 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 14:15:56 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 14:15:56 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 14:15:56 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 14:15:56 | INFO | __main__ |   Cohort distribution:
2025-11-14 14:15:56 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 14:15:56 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 14:15:56 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 14:15:56 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 14:15:56 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 14:15:56 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 14:15:56 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 14:15:56 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 14:15:56 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 14:15:56 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 14:15:56 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 14:15:56 | INFO | __main__ | ================================================================================

2025-11-14 14:15:56 | INFO | __main__ | 
================================================================================
2025-11-14 14:15:56 | INFO | __main__ | MODEL TRAINING
2025-11-14 14:15:56 | INFO | __main__ | ================================================================================
2025-11-14 14:15:56 | INFO | __main__ | 
Starting training...
2025-11-14 14:15:56 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 14:15:56 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 14:15:56 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 14:15:56 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:15:56 | ERROR | __main__ | 
❌ Training failed with error: Insufficient samples for cohort earnings_heavy: 90
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 436, in main
    forecaster = train_probabilistic_forecaster(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 612, in train_probabilistic_forecaster
    forecaster.train(df, save_dir=save_dir)
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 94, in train
    metrics = self._train_cohort_models(cohort, cohort_df)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 177, in _train_cohort_models
    raise ValueError(f"Insufficient samples for cohort {cohort}: {len(df)}")
ValueError: Insufficient samples for cohort earnings_heavy: 90
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | ================================================================================
2025-11-14 14:16:14 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 14:16:14 | INFO | __main__ | ================================================================================
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 14:16:14 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 14:16:14 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 14:16:14 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 14:16:14 | INFO | __main__ |     - 1 direction classifier
2025-11-14 14:16:14 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 14:16:14 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 14:16:14 | INFO | __main__ | 
2025-11-14 14:16:14 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 14:16:14 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 14:16:14 | INFO | __main__ | ================================================================================
2025-11-14 14:16:14 | INFO | __main__ | 
================================================================================
2025-11-14 14:16:14 | INFO | __main__ | DATA PREPARATION
2025-11-14 14:16:14 | INFO | __main__ | ================================================================================
2025-11-14 14:16:14 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 14:16:14 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 14:16:14 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 14:16:14 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 14:16:17 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 14:16:17 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 14:16:17 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 14:16:17 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 14:16:17 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 14:16:17 | INFO | __main__ |   Cohort distribution:
2025-11-14 14:16:17 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 14:16:17 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 14:16:17 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 14:16:17 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 14:16:17 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 14:16:17 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 14:16:17 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 14:16:17 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 14:16:17 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 14:16:17 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 14:16:17 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 14:16:17 | INFO | __main__ | ================================================================================

2025-11-14 14:16:17 | INFO | __main__ | 
================================================================================
2025-11-14 14:16:17 | INFO | __main__ | MODEL TRAINING
2025-11-14 14:16:17 | INFO | __main__ | ================================================================================
2025-11-14 14:16:17 | INFO | __main__ | 
Starting training...
2025-11-14 14:16:17 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 14:16:17 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 14:16:17 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 14:16:17 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:16:17 | ERROR | __main__ | 
❌ Training failed with error: Insufficient samples for cohort earnings_heavy: 90
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 436, in main
    forecaster = train_probabilistic_forecaster(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 612, in train_probabilistic_forecaster
    forecaster.train(df, save_dir=save_dir)
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 94, in train
    metrics = self._train_cohort_models(cohort, cohort_df)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 177, in _train_cohort_models
    raise ValueError(f"Insufficient samples for cohort {cohort}: {len(df)}")
ValueError: Insufficient samples for cohort earnings_heavy: 90
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | ================================================================================
2025-11-14 14:18:42 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 14:18:42 | INFO | __main__ | ================================================================================
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 14:18:42 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 14:18:42 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 14:18:42 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 14:18:42 | INFO | __main__ |     - 1 direction classifier
2025-11-14 14:18:42 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 14:18:42 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 14:18:42 | INFO | __main__ | 
2025-11-14 14:18:42 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 14:18:42 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 14:18:42 | INFO | __main__ | ================================================================================
2025-11-14 14:18:42 | INFO | __main__ | 
================================================================================
2025-11-14 14:18:42 | INFO | __main__ | DATA PREPARATION
2025-11-14 14:18:42 | INFO | __main__ | ================================================================================
2025-11-14 14:18:42 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 14:18:42 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 14:18:42 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 14:18:42 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 14:18:46 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 14:18:46 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 14:18:46 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 14:18:46 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 14:18:46 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 14:18:46 | INFO | __main__ |   Cohort distribution:
2025-11-14 14:18:46 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 14:18:46 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 14:18:46 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 14:18:46 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 14:18:46 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 14:18:46 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 14:18:46 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 14:18:46 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 14:18:46 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 14:18:46 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 14:18:46 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 14:18:46 | INFO | __main__ | ================================================================================

2025-11-14 14:18:46 | INFO | __main__ | 
================================================================================
2025-11-14 14:18:46 | INFO | __main__ | MODEL TRAINING
2025-11-14 14:18:46 | INFO | __main__ | ================================================================================
2025-11-14 14:18:46 | INFO | __main__ | 
Starting training...
2025-11-14 14:18:46 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 14:18:46 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 14:18:46 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:18:46 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:18:48 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.8420
2025-11-14 14:18:50 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.6713
2025-11-14 14:18:52 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.5645
2025-11-14 14:18:54 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5012
2025-11-14 14:18:55 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4736
2025-11-14 14:18:55 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:18:56 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.617
2025-11-14 14:18:56 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:18:56 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.065
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:18:57 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:18:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5518
2025-11-14 14:19:01 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4550
2025-11-14 14:19:04 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4897
2025-11-14 14:19:06 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4605
2025-11-14 14:19:08 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6032
2025-11-14 14:19:08 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:19:09 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.550
2025-11-14 14:19:09 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:19:09 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:19:10 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort fomc_week: 37 samples (accuracy may be limited)
2025-11-14 14:19:10 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:19:10 | ERROR | __main__ | 
❌ Training failed with error: Too many splits=2 for number of samples=37 with test_size=30 and gap=0.
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 436, in main
    forecaster = train_probabilistic_forecaster(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 619, in train_probabilistic_forecaster
    forecaster.train(df, save_dir=save_dir)
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 94, in train
    metrics = self._train_cohort_models(cohort, cohort_df)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 196, in _train_cohort_models
    model, metric = self._train_quantile_regressor(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 248, in _train_quantile_regressor
    for train_idx, val_idx in tscv.split(X):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sklearn/model_selection/_split.py", line 1250, in _split
    raise ValueError(
ValueError: Too many splits=2 for number of samples=37 with test_size=30 and gap=0.
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | ================================================================================
2025-11-14 14:20:24 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 14:20:24 | INFO | __main__ | ================================================================================
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 14:20:24 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 14:20:24 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 14:20:24 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 14:20:24 | INFO | __main__ |     - 1 direction classifier
2025-11-14 14:20:24 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 14:20:24 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 14:20:24 | INFO | __main__ | 
2025-11-14 14:20:24 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 14:20:24 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 14:20:24 | INFO | __main__ | ================================================================================
2025-11-14 14:20:24 | INFO | __main__ | 
================================================================================
2025-11-14 14:20:24 | INFO | __main__ | DATA PREPARATION
2025-11-14 14:20:24 | INFO | __main__ | ================================================================================
2025-11-14 14:20:24 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 14:20:24 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 14:20:24 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 14:20:24 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 14:20:28 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 14:20:28 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 14:20:28 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 14:20:28 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 14:20:28 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 14:20:28 | INFO | __main__ |   Cohort distribution:
2025-11-14 14:20:28 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 14:20:28 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 14:20:28 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 14:20:28 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 14:20:28 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 14:20:28 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 14:20:28 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 14:20:28 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 14:20:28 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 14:20:28 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 14:20:28 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 14:20:28 | INFO | __main__ | ================================================================================

2025-11-14 14:20:28 | INFO | __main__ | 
================================================================================
2025-11-14 14:20:28 | INFO | __main__ | MODEL TRAINING
2025-11-14 14:20:28 | INFO | __main__ | ================================================================================
2025-11-14 14:20:28 | INFO | __main__ | 
Starting training...
2025-11-14 14:20:28 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 14:20:28 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 14:20:28 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:28 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:20:29 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9789
2025-11-14 14:20:31 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.6217
2025-11-14 14:20:33 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4751
2025-11-14 14:20:35 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4302
2025-11-14 14:20:37 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3387
2025-11-14 14:20:37 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:20:38 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.523
2025-11-14 14:20:38 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:20:38 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.057
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:20:41 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.7149
2025-11-14 14:20:44 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5614
2025-11-14 14:20:47 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4566
2025-11-14 14:20:50 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5271
2025-11-14 14:20:52 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5737
2025-11-14 14:20:52 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:20:54 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-14 14:20:54 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:20:54 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.036
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:20:55 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort fomc_week: 37 samples (accuracy may be limited)
2025-11-14 14:20:55 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:20:56 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4574
2025-11-14 14:20:58 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3824
2025-11-14 14:20:59 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3971
2025-11-14 14:21:00 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4035
2025-11-14 14:21:02 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5957
2025-11-14 14:21:02 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:21:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 14:21:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:21:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.030
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:21:03 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort futures_rollover: 46 samples (accuracy may be limited)
2025-11-14 14:21:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:21:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4570
2025-11-14 14:21:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4545
2025-11-14 14:21:08 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.5088
2025-11-14 14:21:09 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4748
2025-11-14 14:21:10 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4741
2025-11-14 14:21:10 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:21:11 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.455
2025-11-14 14:21:11 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:21:11 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.029
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:21:12 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:21:20 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6560
2025-11-14 14:21:31 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5285
2025-11-14 14:21:42 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4435
2025-11-14 14:21:51 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4291
2025-11-14 14:21:59 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4507
2025-11-14 14:21:59 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:22:04 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.603
2025-11-14 14:22:04 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:22:04 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:22:07 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:22:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6128
2025-11-14 14:22:12 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4120
2025-11-14 14:22:16 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3455
2025-11-14 14:22:19 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3528
2025-11-14 14:22:21 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4249
2025-11-14 14:22:21 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:22:23 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 14:22:23 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:22:23 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.041
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:22:25 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:22:27 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6030
2025-11-14 14:22:30 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3742
2025-11-14 14:22:33 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2812
2025-11-14 14:22:36 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3056
2025-11-14 14:22:38 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3903
2025-11-14 14:22:38 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:22:40 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.609
2025-11-14 14:22:40 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:22:40 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:22:41 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.040
2025-11-14 14:22:41 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 14:22:41 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 14:22:42 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 14:22:42 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 14:22:42 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 14:22:42 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:22:42 | INFO | __main__ | 
================================================================================
2025-11-14 14:22:42 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 14:22:42 | INFO | __main__ | ================================================================================
2025-11-14 14:22:42 | INFO | __main__ | 
Cohorts trained: 7
2025-11-14 14:22:42 | INFO | __main__ |   earnings_heavy: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   fomc_minus_3: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   fomc_week: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   futures_rollover: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   mid_cycle: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   monthly_opex_minus_1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ |   monthly_opex_minus_5: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:22:42 | INFO | __main__ | 
================================================================================

2025-11-14 14:22:42 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_142242.json
2025-11-14 14:22:42 | INFO | __main__ | 
================================================================================
2025-11-14 14:22:42 | INFO | __main__ | MODEL VALIDATION
2025-11-14 14:22:42 | INFO | __main__ | ================================================================================
2025-11-14 14:22:42 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: earnings_heavy)
2025-11-14 14:22:42 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 14:22:42 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 14:22:42 | INFO | __main__ |    Median forecast: -17.93%
2025-11-14 14:22:42 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 14:22:42 | INFO | __main__ |    Q10: -39.42%, Q50: -17.93%, Q90: +2.43%
2025-11-14 14:22:42 | INFO | __main__ |    Direction prob (up): 0.36
2025-11-14 14:22:42 | INFO | __main__ |    Confidence: 0.91
2025-11-14 14:22:42 | INFO | __main__ | 
================================================================================
2025-11-14 14:22:42 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 14:22:42 | INFO | __main__ | ================================================================================
2025-11-14 14:22:42 | INFO | __main__ | 
Models saved to: models
2025-11-14 14:22:42 | INFO | __main__ | 
Next steps:
2025-11-14 14:22:42 | INFO | __main__ |   1. Review training report
2025-11-14 14:22:42 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 14:22:42 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 14:22:42 | INFO | __main__ | ================================================================================

2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | ================================================================================
2025-11-14 14:39:38 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 14:39:38 | INFO | __main__ | ================================================================================
2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 14:39:38 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 14:39:38 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 14:39:38 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 14:39:38 | INFO | __main__ |     - 1 direction classifier
2025-11-14 14:39:38 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 14:39:38 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 14:39:38 | INFO | __main__ | 
2025-11-14 14:39:38 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 14:39:38 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 14:39:38 | INFO | __main__ | ================================================================================
2025-11-14 14:39:38 | INFO | __main__ | 
================================================================================
2025-11-14 14:39:38 | INFO | __main__ | DATA PREPARATION
2025-11-14 14:39:38 | INFO | __main__ | ================================================================================
2025-11-14 14:39:38 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 14:39:38 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 14:39:38 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 14:39:38 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 14:39:41 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 14:39:41 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 14:39:41 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 14:39:41 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 14:39:41 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 14:39:41 | INFO | __main__ |   Cohort distribution:
2025-11-14 14:39:41 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 14:39:41 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 14:39:41 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 14:39:41 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 14:39:41 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 14:39:41 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 14:39:41 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 14:39:41 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 14:39:41 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 14:39:41 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 14:39:41 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 14:39:41 | INFO | __main__ | ================================================================================

2025-11-14 14:39:41 | INFO | __main__ | 
================================================================================
2025-11-14 14:39:41 | INFO | __main__ | MODEL TRAINING
2025-11-14 14:39:41 | INFO | __main__ | ================================================================================
2025-11-14 14:39:41 | INFO | __main__ | 
Starting training...
2025-11-14 14:39:41 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 14:39:41 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 14:39:41 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:39:41 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:39:43 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9789
2025-11-14 14:39:45 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.6217
2025-11-14 14:39:47 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4751
2025-11-14 14:39:49 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4302
2025-11-14 14:39:50 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3387
2025-11-14 14:39:50 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:39:51 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.523
2025-11-14 14:39:51 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.057
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:39:52 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:39:55 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.7149
2025-11-14 14:39:57 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5614
2025-11-14 14:40:01 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4566
2025-11-14 14:40:03 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5271
2025-11-14 14:40:06 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5737
2025-11-14 14:40:06 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:40:07 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-14 14:40:07 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:40:07 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.036
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:09 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort fomc_week: 37 samples (accuracy may be limited)
2025-11-14 14:40:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:40:10 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4574
2025-11-14 14:40:11 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3824
2025-11-14 14:40:13 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3971
2025-11-14 14:40:14 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4035
2025-11-14 14:40:15 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5957
2025-11-14 14:40:15 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:40:16 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 14:40:16 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:40:16 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.030
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:17 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort futures_rollover: 46 samples (accuracy may be limited)
2025-11-14 14:40:17 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:40:18 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4570
2025-11-14 14:40:20 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4545
2025-11-14 14:40:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.5088
2025-11-14 14:40:23 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4748
2025-11-14 14:40:24 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4741
2025-11-14 14:40:24 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:40:25 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.455
2025-11-14 14:40:25 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:40:25 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.029
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:40:26 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:40:34 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6560
2025-11-14 14:40:44 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5285
2025-11-14 14:40:55 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4435
2025-11-14 14:41:04 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4291
2025-11-14 14:41:13 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4507
2025-11-14 14:41:13 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:41:17 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.603
2025-11-14 14:41:17 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:41:18 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:41:20 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:41:23 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6128
2025-11-14 14:41:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4120
2025-11-14 14:41:29 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3455
2025-11-14 14:41:32 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3528
2025-11-14 14:41:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4249
2025-11-14 14:41:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:41:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 14:41:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:41:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.041
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 14:41:38 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 14:41:40 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6030
2025-11-14 14:41:43 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3742
2025-11-14 14:41:46 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2812
2025-11-14 14:41:49 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3056
2025-11-14 14:41:51 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3903
2025-11-14 14:41:51 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 14:41:53 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.609
2025-11-14 14:41:53 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 14:41:53 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 14:41:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.040
2025-11-14 14:41:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 14:41:54 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 14:41:55 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 14:41:55 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 14:41:55 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 14:41:55 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 14:41:55 | INFO | __main__ | 
================================================================================
2025-11-14 14:41:55 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 14:41:55 | INFO | __main__ | ================================================================================
2025-11-14 14:41:55 | INFO | __main__ | 
Cohorts trained: 7
2025-11-14 14:41:55 | INFO | __main__ |   earnings_heavy: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   fomc_minus_3: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   fomc_week: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   futures_rollover: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   mid_cycle: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   monthly_opex_minus_1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ |   monthly_opex_minus_5: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 14:41:55 | INFO | __main__ | 
================================================================================

2025-11-14 14:41:55 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_144155.json
2025-11-14 14:41:55 | INFO | __main__ | 
================================================================================
2025-11-14 14:41:55 | INFO | __main__ | MODEL VALIDATION
2025-11-14 14:41:55 | INFO | __main__ | ================================================================================
2025-11-14 14:41:55 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: earnings_heavy)
2025-11-14 14:41:55 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 14:41:55 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 14:41:55 | INFO | __main__ |    Median forecast: -17.93%
2025-11-14 14:41:55 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 14:41:55 | INFO | __main__ |    Q10: -39.42%, Q50: -17.93%, Q90: +2.43%
2025-11-14 14:41:55 | INFO | __main__ |    Direction prob (up): 0.36
2025-11-14 14:41:55 | INFO | __main__ |    Confidence: 0.91
2025-11-14 14:41:55 | INFO | __main__ | 
================================================================================
2025-11-14 14:41:55 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 14:41:55 | INFO | __main__ | ================================================================================
2025-11-14 14:41:55 | INFO | __main__ | 
Models saved to: models
2025-11-14 14:41:55 | INFO | __main__ | 
Next steps:
2025-11-14 14:41:55 | INFO | __main__ |   1. Review training report
2025-11-14 14:41:55 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 14:41:55 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 14:41:55 | INFO | __main__ | ================================================================================

2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | ================================================================================
2025-11-14 15:00:57 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 15:00:57 | INFO | __main__ | ================================================================================
2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 15:00:57 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 15:00:57 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 15:00:57 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 15:00:57 | INFO | __main__ |     - 1 direction classifier
2025-11-14 15:00:57 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 15:00:57 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 15:00:57 | INFO | __main__ | 
2025-11-14 15:00:57 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 15:00:57 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 15:00:57 | INFO | __main__ | ================================================================================
2025-11-14 15:00:57 | INFO | __main__ | 
================================================================================
2025-11-14 15:00:57 | INFO | __main__ | DATA PREPARATION
2025-11-14 15:00:57 | INFO | __main__ | ================================================================================
2025-11-14 15:00:57 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 15:00:57 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 15:00:57 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 15:00:57 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 15:01:00 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 15:01:00 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 15:01:00 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 15:01:00 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 15:01:00 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 15:01:00 | INFO | __main__ |   Cohort distribution:
2025-11-14 15:01:00 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 15:01:00 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 15:01:00 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 15:01:00 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 15:01:00 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 15:01:00 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 15:01:00 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 15:01:00 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 15:01:00 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 15:01:00 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 15:01:00 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 15:01:00 | INFO | __main__ | ================================================================================

2025-11-14 15:01:00 | INFO | __main__ | 
================================================================================
2025-11-14 15:01:00 | INFO | __main__ | MODEL TRAINING
2025-11-14 15:01:00 | INFO | __main__ | ================================================================================
2025-11-14 15:01:00 | INFO | __main__ | 
Starting training...
2025-11-14 15:01:00 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 15:01:00 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 15:01:00 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:00 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:01:02 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9789
2025-11-14 15:01:03 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.6217
2025-11-14 15:01:06 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4751
2025-11-14 15:01:08 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4302
2025-11-14 15:01:09 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3387
2025-11-14 15:01:09 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:01:10 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.523
2025-11-14 15:01:10 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:01:10 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.057
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:11 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:01:14 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.7149
2025-11-14 15:01:16 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5614
2025-11-14 15:01:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4566
2025-11-14 15:01:22 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5271
2025-11-14 15:01:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5737
2025-11-14 15:01:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:01:26 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-14 15:01:26 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:01:26 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.036
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:28 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort fomc_week: 37 samples (accuracy may be limited)
2025-11-14 15:01:28 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:01:29 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4574
2025-11-14 15:01:31 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3824
2025-11-14 15:01:32 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3971
2025-11-14 15:01:34 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4035
2025-11-14 15:01:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5957
2025-11-14 15:01:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:01:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 15:01:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:01:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.030
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:37 | WARNING | core.xgboost_trainer_v3 | ⚠️ Small cohort futures_rollover: 46 samples (accuracy may be limited)
2025-11-14 15:01:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:01:38 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.4570
2025-11-14 15:01:39 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4545
2025-11-14 15:01:41 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.5088
2025-11-14 15:01:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4748
2025-11-14 15:01:44 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4741
2025-11-14 15:01:44 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:01:45 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.455
2025-11-14 15:01:45 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:01:45 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.029
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:01:46 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:01:54 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6560
2025-11-14 15:02:04 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.5285
2025-11-14 15:02:15 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4435
2025-11-14 15:02:26 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4291
2025-11-14 15:02:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4507
2025-11-14 15:02:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:02:40 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.603
2025-11-14 15:02:40 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:02:40 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:02:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:02:45 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6128
2025-11-14 15:02:48 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4120
2025-11-14 15:02:52 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3455
2025-11-14 15:02:55 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3528
2025-11-14 15:02:57 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4249
2025-11-14 15:02:57 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:02:59 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.500
2025-11-14 15:02:59 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:02:59 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.041
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 15:03:00 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 15:03:03 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6030
2025-11-14 15:03:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3742
2025-11-14 15:03:09 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2812
2025-11-14 15:03:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3056
2025-11-14 15:03:14 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3903
2025-11-14 15:03:14 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 15:03:16 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.609
2025-11-14 15:03:16 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 15:03:16 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 15:03:17 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.040
2025-11-14 15:03:17 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 15:03:17 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 15:03:18 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 15:03:18 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 15:03:18 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 15:03:18 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 15:03:18 | INFO | __main__ | 
================================================================================
2025-11-14 15:03:18 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 15:03:18 | INFO | __main__ | ================================================================================
2025-11-14 15:03:18 | INFO | __main__ | 
Cohorts trained: 7
2025-11-14 15:03:18 | INFO | __main__ |   earnings_heavy: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   fomc_minus_3: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   fomc_week: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   futures_rollover: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   mid_cycle: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   monthly_opex_minus_1: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ |   monthly_opex_minus_5: 7 models - ['q10', 'q25', 'q50', 'q75', 'q90', 'direction', 'confidence']
2025-11-14 15:03:18 | INFO | __main__ | 
================================================================================

2025-11-14 15:03:18 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_150318.json
2025-11-14 15:03:18 | INFO | __main__ | 
================================================================================
2025-11-14 15:03:18 | INFO | __main__ | MODEL VALIDATION
2025-11-14 15:03:18 | INFO | __main__ | ================================================================================
2025-11-14 15:03:18 | INFO | __main__ | ✅ Models loaded successfully (tested cohort: earnings_heavy)
2025-11-14 15:03:18 | INFO | __main__ | 
Testing prediction capability...
2025-11-14 15:03:18 | INFO | __main__ | ✅ Test prediction successful
2025-11-14 15:03:18 | INFO | __main__ |    Median forecast: -17.93%
2025-11-14 15:03:18 | INFO | __main__ |    Quantiles: ['q10', 'q25', 'q50', 'q75', 'q90']
2025-11-14 15:03:18 | INFO | __main__ |    Q10: -39.42%, Q50: -17.93%, Q90: +2.43%
2025-11-14 15:03:18 | INFO | __main__ |    Direction prob (up): 0.36
2025-11-14 15:03:18 | INFO | __main__ |    Confidence: 0.91
2025-11-14 15:03:18 | INFO | __main__ | 
================================================================================
2025-11-14 15:03:18 | INFO | __main__ | ✅ TRAINING COMPLETE!
2025-11-14 15:03:18 | INFO | __main__ | ================================================================================
2025-11-14 15:03:18 | INFO | __main__ | 
Models saved to: models
2025-11-14 15:03:18 | INFO | __main__ | 
Next steps:
2025-11-14 15:03:18 | INFO | __main__ |   1. Review training report
2025-11-14 15:03:18 | INFO | __main__ |   2. Run: python src/integrated_system_production.py --mode predict
2025-11-14 15:03:18 | INFO | __main__ |   3. Backfill actuals: python src/integrated_system_production.py --mode backfill
2025-11-14 15:03:18 | INFO | __main__ | ================================================================================

2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | ================================================================================
2025-11-14 19:58:08 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 19:58:08 | INFO | __main__ | ================================================================================
2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 19:58:08 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 19:58:08 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 19:58:08 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 19:58:08 | INFO | __main__ |     - 1 direction classifier
2025-11-14 19:58:08 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 19:58:08 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 19:58:08 | INFO | __main__ | 
2025-11-14 19:58:08 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 19:58:08 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 19:58:08 | INFO | __main__ | ================================================================================
2025-11-14 19:58:08 | INFO | __main__ | 
================================================================================
2025-11-14 19:58:08 | INFO | __main__ | DATA PREPARATION
2025-11-14 19:58:08 | INFO | __main__ | ================================================================================
2025-11-14 19:58:08 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 19:58:08 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 19:58:08 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 19:58:08 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 19:58:13 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 19:58:13 | INFO | __main__ |   Usable training samples (after warmup): 756
  Effective training period: 2020-01-02 to 2022-12-30
2025-11-14 19:58:13 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 19:58:13 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 19:58:13 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 19:58:13 | INFO | __main__ |   Cohort distribution:
2025-11-14 19:58:13 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 19:58:13 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 19:58:13 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 19:58:13 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 19:58:13 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 19:58:13 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 19:58:13 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 19:58:13 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 19:58:13 | INFO | __main__ |   Columns: features (235) + vix + spx + calendar_cohort
2025-11-14 19:58:13 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 19:58:13 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 19:58:13 | INFO | __main__ | ================================================================================

2025-11-14 19:58:13 | INFO | __main__ | 
================================================================================
2025-11-14 19:58:13 | INFO | __main__ | MODEL TRAINING
2025-11-14 19:58:13 | INFO | __main__ | ================================================================================
2025-11-14 19:58:13 | INFO | __main__ | 
Starting training...
2025-11-14 19:58:13 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 19:58:13 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 19:58:13 | INFO | __main__ |   Target: Log-transformed forward realized volatility

2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 19:58:13 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 19:58:13 | ERROR | __main__ | 
❌ Training failed with error: Insufficient samples for cohort earnings_heavy: 90
Traceback (most recent call last):
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/train_probabilistic_models.py", line 436, in main
    forecaster = train_probabilistic_forecaster(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 646, in train_probabilistic_forecaster
    forecaster.train(df, save_dir=save_dir)
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 95, in train
    metrics = self._train_cohort_models(cohort, cohort_df)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/johnluo/Desktop/GitHub/SPX_Analysis/src/core/xgboost_trainer_v3.py", line 184, in _train_cohort_models
    raise ValueError(f"Insufficient samples for cohort {cohort}: {len(df)}")
ValueError: Insufficient samples for cohort earnings_heavy: 90
2025-11-14 20:41:10 | INFO | __main__ | 
================================================================================
2025-11-14 20:41:10 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 20:41:10 | INFO | __main__ | ================================================================================
2025-11-14 20:41:10 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 20:41:10 | INFO | __main__ | Date: 2025-11-14 20:41:10
2025-11-14 20:41:10 | INFO | __main__ | Output: models
2025-11-14 20:41:10 | INFO | __main__ | ================================================================================

2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | ================================================================================
2025-11-14 20:41:10 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 20:41:10 | INFO | __main__ | ================================================================================
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 20:41:10 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 20:41:10 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 20:41:10 | INFO | __main__ |     - 1 direction classifier
2025-11-14 20:41:10 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 20:41:10 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 20:41:10 | INFO | __main__ | 
2025-11-14 20:41:10 | ERROR | __main__ | ❌ Configuration validation FAILED
2025-11-14 20:41:10 | ERROR | __main__ |    Please fix the following issues:
2025-11-14 20:41:10 | ERROR | __main__ |   ❌ Quantiles not configured
2025-11-14 20:41:10 | INFO | __main__ | ================================================================================
2025-11-14 20:41:10 | ERROR | __main__ | 
❌ Configuration validation failed:
  ❌ Quantiles not configured
2025-11-14 20:48:57 | INFO | __main__ | 
================================================================================
2025-11-14 20:48:57 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================
2025-11-14 20:48:57 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 20:48:57 | INFO | __main__ | Date: 2025-11-14 20:48:57
2025-11-14 20:48:57 | INFO | __main__ | Output: models
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================

2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================
2025-11-14 20:48:57 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 20:48:57 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 20:48:57 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 20:48:57 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 20:48:57 | INFO | __main__ |     - 1 direction classifier
2025-11-14 20:48:57 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 20:48:57 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 20:48:57 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================
2025-11-14 20:48:57 | INFO | __main__ | 
2025-11-14 20:48:57 | INFO | __main__ | 
================================================================================
2025-11-14 20:48:57 | INFO | __main__ | DATA PREPARATION
2025-11-14 20:48:57 | INFO | __main__ | ================================================================================
2025-11-14 20:48:57 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 20:48:57 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 20:48:57 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 20:48:57 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 20:49:01 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 20:49:01 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 20:49:01 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 20:49:01 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 20:49:01 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 20:49:01 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 20:49:01 | INFO | __main__ |   Cohort distribution:
2025-11-14 20:49:01 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 20:49:01 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 20:49:01 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 20:49:01 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 20:49:01 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 20:49:01 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 20:49:01 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 20:49:01 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 20:49:01 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 20:49:01 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 20:49:01 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 20:49:01 | INFO | __main__ | ================================================================================

2025-11-14 20:49:01 | INFO | __main__ | 
2025-11-14 20:49:01 | INFO | __main__ | ================================================================================
2025-11-14 20:49:01 | INFO | __main__ | MODEL TRAINING
2025-11-14 20:49:01 | INFO | __main__ | ================================================================================
2025-11-14 20:49:01 | INFO | __main__ | 
2025-11-14 20:49:01 | INFO | __main__ | Starting training...
2025-11-14 20:49:01 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 20:49:01 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 20:49:01 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 20:49:01 | INFO | __main__ | 
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:01 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 20:49:03 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9559
2025-11-14 20:49:05 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7742
2025-11-14 20:49:07 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6996
2025-11-14 20:49:09 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5783
2025-11-14 20:49:10 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5242
2025-11-14 20:49:10 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 20:49:11 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.633
2025-11-14 20:49:11 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 20:49:11 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.064
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:12 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 20:49:14 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5677
2025-11-14 20:49:16 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4424
2025-11-14 20:49:19 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4701
2025-11-14 20:49:21 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4717
2025-11-14 20:49:22 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6492
2025-11-14 20:49:22 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 20:49:24 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.533
2025-11-14 20:49:24 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 20:49:24 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 20:49:25 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 20:49:25 | ERROR | __main__ | 
❌ Training failed with error: Too many splits=2 for number of samples=37 with test_size=30 and gap=0.
2025-11-14 21:09:00 | INFO | __main__ | 
================================================================================
2025-11-14 21:09:00 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================
2025-11-14 21:09:00 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 21:09:00 | INFO | __main__ | Date: 2025-11-14 21:09:00
2025-11-14 21:09:00 | INFO | __main__ | Output: models
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================

2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================
2025-11-14 21:09:00 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 21:09:00 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 21:09:00 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 21:09:00 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 21:09:00 | INFO | __main__ |     - 1 direction classifier
2025-11-14 21:09:00 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 21:09:00 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 21:09:00 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================
2025-11-14 21:09:00 | INFO | __main__ | 
2025-11-14 21:09:00 | INFO | __main__ | 
================================================================================
2025-11-14 21:09:00 | INFO | __main__ | DATA PREPARATION
2025-11-14 21:09:00 | INFO | __main__ | ================================================================================
2025-11-14 21:09:00 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 21:09:00 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 21:09:00 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 21:09:00 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 21:09:04 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 21:09:04 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 21:09:04 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 21:09:04 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 21:09:04 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 21:09:04 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 21:09:04 | INFO | __main__ |   Cohort distribution:
2025-11-14 21:09:04 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 21:09:04 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 21:09:04 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 21:09:04 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 21:09:04 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 21:09:04 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 21:09:04 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 21:09:04 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 21:09:04 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 21:09:04 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 21:09:04 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 21:09:04 | INFO | __main__ | ================================================================================

2025-11-14 21:09:04 | INFO | __main__ | 
2025-11-14 21:09:04 | INFO | __main__ | ================================================================================
2025-11-14 21:09:04 | INFO | __main__ | MODEL TRAINING
2025-11-14 21:09:04 | INFO | __main__ | ================================================================================
2025-11-14 21:09:04 | INFO | __main__ | 
2025-11-14 21:09:04 | INFO | __main__ | Starting training...
2025-11-14 21:09:04 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 21:09:04 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 21:09:04 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 21:09:04 | INFO | __main__ | 
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:04 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:09:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9952
2025-11-14 21:09:07 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7694
2025-11-14 21:09:10 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6579
2025-11-14 21:09:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5767
2025-11-14 21:09:13 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4714
2025-11-14 21:09:13 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:09:14 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.479
2025-11-14 21:09:14 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:09:14 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.053
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:15 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:09:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5677
2025-11-14 21:09:19 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4424
2025-11-14 21:09:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4701
2025-11-14 21:09:23 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4717
2025-11-14 21:09:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6492
2025-11-14 21:09:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:09:26 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.533
2025-11-14 21:09:26 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:09:26 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:09:27 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1909
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0327
2025-11-14 21:09:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1013
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3302
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:09:29 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2255
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0735
2025-11-14 21:09:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:31 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0162
2025-11-14 21:09:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:31 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1287
2025-11-14 21:09:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3138
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:09:32 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:09:39 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6658
2025-11-14 21:09:48 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4652
2025-11-14 21:09:59 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4307
2025-11-14 21:10:07 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4253
2025-11-14 21:10:14 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5060
2025-11-14 21:10:14 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:10:19 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.592
2025-11-14 21:10:19 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:10:19 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:10:21 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:10:23 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6612
2025-11-14 21:10:25 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4064
2025-11-14 21:10:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3990
2025-11-14 21:10:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3779
2025-11-14 21:10:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3804
2025-11-14 21:10:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:10:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.457
2025-11-14 21:10:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:10:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:10:34 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:10:36 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6448
2025-11-14 21:10:38 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4534
2025-11-14 21:10:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3324
2025-11-14 21:10:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.2684
2025-11-14 21:10:44 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3915
2025-11-14 21:10:44 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:10:45 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 21:10:45 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:10:45 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:10:46 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 21:10:46 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 21:10:46 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 21:10:47 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 21:10:47 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 21:10:47 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 21:10:47 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:10:47 | INFO | __main__ | 
================================================================================
2025-11-14 21:10:47 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 21:10:47 | INFO | __main__ | ================================================================================
2025-11-14 21:10:47 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 21:10:47 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 21:10:47 | INFO | __main__ |   Total models: 49
2025-11-14 21:10:47 | INFO | __main__ |   Feature count: 231
2025-11-14 21:10:47 | INFO | __main__ | 
  Cohorts:
2025-11-14 21:10:47 | INFO | __main__ |     - earnings_heavy
2025-11-14 21:10:47 | INFO | __main__ |     - fomc_minus_3
2025-11-14 21:10:47 | INFO | __main__ |     - fomc_week
2025-11-14 21:10:47 | INFO | __main__ |     - futures_rollover
2025-11-14 21:10:47 | INFO | __main__ |     - mid_cycle
2025-11-14 21:10:47 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 21:10:47 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 21:10:47 | INFO | __main__ | ================================================================================

2025-11-14 21:10:47 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_211047.json
2025-11-14 21:10:47 | INFO | __main__ | 
================================================================================
2025-11-14 21:10:47 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 21:10:47 | INFO | __main__ | ================================================================================
2025-11-14 21:10:47 | INFO | __main__ |   Models saved to: models/
2025-11-14 21:10:47 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 21:10:47 | INFO | __main__ | ================================================================================

2025-11-14 21:44:23 | INFO | __main__ | 
================================================================================
2025-11-14 21:44:23 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================
2025-11-14 21:44:23 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 21:44:23 | INFO | __main__ | Date: 2025-11-14 21:44:23
2025-11-14 21:44:23 | INFO | __main__ | Output: models
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================

2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================
2025-11-14 21:44:23 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 21:44:23 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 21:44:23 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 21:44:23 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 21:44:23 | INFO | __main__ |     - 1 direction classifier
2025-11-14 21:44:23 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 21:44:23 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 21:44:23 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================
2025-11-14 21:44:23 | INFO | __main__ | 
2025-11-14 21:44:23 | INFO | __main__ | 
================================================================================
2025-11-14 21:44:23 | INFO | __main__ | DATA PREPARATION
2025-11-14 21:44:23 | INFO | __main__ | ================================================================================
2025-11-14 21:44:23 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 21:44:23 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 21:44:23 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 21:44:23 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 21:44:26 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 21:44:26 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 21:44:26 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 21:44:26 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 21:44:26 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 21:44:26 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 21:44:26 | INFO | __main__ |   Cohort distribution:
2025-11-14 21:44:26 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 21:44:26 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 21:44:26 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 21:44:26 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 21:44:26 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 21:44:26 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 21:44:26 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 21:44:26 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 21:44:26 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 21:44:26 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 21:44:26 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 21:44:26 | INFO | __main__ | ================================================================================

2025-11-14 21:44:26 | INFO | __main__ | 
2025-11-14 21:44:26 | INFO | __main__ | ================================================================================
2025-11-14 21:44:26 | INFO | __main__ | MODEL TRAINING
2025-11-14 21:44:26 | INFO | __main__ | ================================================================================
2025-11-14 21:44:26 | INFO | __main__ | 
2025-11-14 21:44:26 | INFO | __main__ | Starting training...
2025-11-14 21:44:26 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 21:44:26 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 21:44:26 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 21:44:26 | INFO | __main__ | 
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:26 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:44:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9952
2025-11-14 21:44:30 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7694
2025-11-14 21:44:32 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6579
2025-11-14 21:44:34 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5767
2025-11-14 21:44:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4714
2025-11-14 21:44:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:44:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.479
2025-11-14 21:44:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:44:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.053
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:44:39 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5677
2025-11-14 21:44:41 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4424
2025-11-14 21:44:44 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4701
2025-11-14 21:44:46 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4717
2025-11-14 21:44:47 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6492
2025-11-14 21:44:47 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:44:48 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.533
2025-11-14 21:44:48 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:44:48 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:44:49 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:50 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712
2025-11-14 21:44:50 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:50 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1909
2025-11-14 21:44:50 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0327
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1013
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3302
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:44:51 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2255
2025-11-14 21:44:52 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:53 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0735
2025-11-14 21:44:53 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:53 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0162
2025-11-14 21:44:53 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1287
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3138
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:44:54 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:45:02 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6658
2025-11-14 21:45:11 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4652
2025-11-14 21:45:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4307
2025-11-14 21:45:29 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4253
2025-11-14 21:45:36 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5060
2025-11-14 21:45:36 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:45:41 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.592
2025-11-14 21:45:41 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:45:41 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:45:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:45:45 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6612
2025-11-14 21:45:47 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4064
2025-11-14 21:45:50 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3990
2025-11-14 21:45:52 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3779
2025-11-14 21:45:54 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3804
2025-11-14 21:45:54 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:45:55 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.457
2025-11-14 21:45:55 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:45:55 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 21:45:56 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 21:45:58 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6448
2025-11-14 21:46:00 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4534
2025-11-14 21:46:02 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3324
2025-11-14 21:46:05 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.2684
2025-11-14 21:46:06 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3915
2025-11-14 21:46:06 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 21:46:08 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 21:46:08 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 21:46:08 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 21:46:09 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 21:46:09 | INFO | __main__ | 
================================================================================
2025-11-14 21:46:09 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 21:46:09 | INFO | __main__ | ================================================================================
2025-11-14 21:46:09 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 21:46:09 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 21:46:09 | INFO | __main__ |   Total models: 49
2025-11-14 21:46:09 | INFO | __main__ |   Feature count: 231
2025-11-14 21:46:09 | INFO | __main__ | 
  Cohorts:
2025-11-14 21:46:09 | INFO | __main__ |     - earnings_heavy
2025-11-14 21:46:09 | INFO | __main__ |     - fomc_minus_3
2025-11-14 21:46:09 | INFO | __main__ |     - fomc_week
2025-11-14 21:46:09 | INFO | __main__ |     - futures_rollover
2025-11-14 21:46:09 | INFO | __main__ |     - mid_cycle
2025-11-14 21:46:09 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 21:46:09 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 21:46:09 | INFO | __main__ | ================================================================================

2025-11-14 21:46:09 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_214609.json
2025-11-14 21:46:09 | INFO | __main__ | 
================================================================================
2025-11-14 21:46:09 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 21:46:09 | INFO | __main__ | ================================================================================
2025-11-14 21:46:09 | INFO | __main__ |   Models saved to: models/
2025-11-14 21:46:09 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 21:46:09 | INFO | __main__ | ================================================================================

2025-11-14 22:04:19 | INFO | __main__ | 
================================================================================
2025-11-14 22:04:19 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================
2025-11-14 22:04:19 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:04:19 | INFO | __main__ | Date: 2025-11-14 22:04:19
2025-11-14 22:04:19 | INFO | __main__ | Output: models
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================

2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================
2025-11-14 22:04:19 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:04:19 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:04:19 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:04:19 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:04:19 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:04:19 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:04:19 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:04:19 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================
2025-11-14 22:04:19 | INFO | __main__ | 
2025-11-14 22:04:19 | INFO | __main__ | 
================================================================================
2025-11-14 22:04:19 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:04:19 | INFO | __main__ | ================================================================================
2025-11-14 22:04:19 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:04:19 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:04:19 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:04:19 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:04:22 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:04:22 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:04:22 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:04:22 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:04:22 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:04:22 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:04:22 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:04:22 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:04:22 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:04:22 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:04:22 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:04:22 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:04:22 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:04:22 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:04:22 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:04:22 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:04:22 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:04:22 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:04:22 | INFO | __main__ | ================================================================================

2025-11-14 22:04:22 | INFO | __main__ | 
2025-11-14 22:04:22 | INFO | __main__ | ================================================================================
2025-11-14 22:04:22 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:04:22 | INFO | __main__ | ================================================================================
2025-11-14 22:04:22 | INFO | __main__ | 
2025-11-14 22:04:22 | INFO | __main__ | Starting training...
2025-11-14 22:04:22 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:04:22 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:04:22 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:04:22 | INFO | __main__ | 
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:22 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:04:23 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9952
2025-11-14 22:04:25 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7694
2025-11-14 22:04:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6579
2025-11-14 22:04:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5767
2025-11-14 22:04:31 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4714
2025-11-14 22:04:31 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:04:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.479
2025-11-14 22:04:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:04:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.053
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:34 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:04:35 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5677
2025-11-14 22:04:38 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4424
2025-11-14 22:04:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4701
2025-11-14 22:04:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4717
2025-11-14 22:04:44 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6492
2025-11-14 22:04:44 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:04:45 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.533
2025-11-14 22:04:45 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:04:45 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712
2025-11-14 22:04:46 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:47 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1909
2025-11-14 22:04:47 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:47 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0327
2025-11-14 22:04:47 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1013
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3302
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:04:48 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:49 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2255
2025-11-14 22:04:49 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:49 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0735
2025-11-14 22:04:49 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0162
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1287
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3138
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:04:50 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:04:51 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:04:58 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6658
2025-11-14 22:05:08 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4652
2025-11-14 22:05:17 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4307
2025-11-14 22:05:26 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4253
2025-11-14 22:05:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5060
2025-11-14 22:05:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:05:37 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.592
2025-11-14 22:05:37 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:05:37 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:05:40 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:05:41 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6612
2025-11-14 22:05:44 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4064
2025-11-14 22:05:46 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3990
2025-11-14 22:05:49 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3779
2025-11-14 22:05:50 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3804
2025-11-14 22:05:50 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:05:52 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.457
2025-11-14 22:05:52 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:05:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:05:53 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:05:54 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6448
2025-11-14 22:05:56 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4534
2025-11-14 22:05:59 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3324
2025-11-14 22:06:01 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.2684
2025-11-14 22:06:03 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3915
2025-11-14 22:06:03 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:06:04 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:06:04 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:06:04 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:06:05 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 22:06:05 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:06:05 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:06:06 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:06:06 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:06:06 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:06:06 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:06:06 | INFO | __main__ | 
================================================================================
2025-11-14 22:06:06 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:06:06 | INFO | __main__ | ================================================================================
2025-11-14 22:06:06 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:06:06 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:06:06 | INFO | __main__ |   Total models: 49
2025-11-14 22:06:06 | INFO | __main__ |   Feature count: 231
2025-11-14 22:06:06 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:06:06 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:06:06 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:06:06 | INFO | __main__ |     - fomc_week
2025-11-14 22:06:06 | INFO | __main__ |     - futures_rollover
2025-11-14 22:06:06 | INFO | __main__ |     - mid_cycle
2025-11-14 22:06:06 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:06:06 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:06:06 | INFO | __main__ | ================================================================================

2025-11-14 22:06:06 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_220606.json
2025-11-14 22:06:06 | INFO | __main__ | 
================================================================================
2025-11-14 22:06:06 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:06:06 | INFO | __main__ | ================================================================================
2025-11-14 22:06:06 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:06:06 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:06:06 | INFO | __main__ | ================================================================================

2025-11-14 22:20:39 | INFO | __main__ | 
================================================================================
2025-11-14 22:20:39 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================
2025-11-14 22:20:39 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:20:39 | INFO | __main__ | Date: 2025-11-14 22:20:39
2025-11-14 22:20:39 | INFO | __main__ | Output: models
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================

2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================
2025-11-14 22:20:39 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:20:39 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:20:39 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:20:39 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:20:39 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:20:39 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:20:39 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:20:39 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================
2025-11-14 22:20:39 | INFO | __main__ | 
2025-11-14 22:20:39 | INFO | __main__ | 
================================================================================
2025-11-14 22:20:39 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:20:39 | INFO | __main__ | ================================================================================
2025-11-14 22:20:39 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:20:39 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:20:39 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:20:39 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:20:43 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:20:43 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:20:43 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:20:43 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:20:43 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:20:43 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:20:43 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:20:43 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:20:43 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:20:43 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:20:43 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:20:43 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:20:43 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:20:43 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:20:43 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:20:43 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:20:43 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:20:43 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:20:43 | INFO | __main__ | ================================================================================

2025-11-14 22:20:43 | INFO | __main__ | 
2025-11-14 22:20:43 | INFO | __main__ | ================================================================================
2025-11-14 22:20:43 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:20:43 | INFO | __main__ | ================================================================================
2025-11-14 22:20:43 | INFO | __main__ | 
2025-11-14 22:20:43 | INFO | __main__ | Starting training...
2025-11-14 22:20:43 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:20:43 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:20:43 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:20:43 | INFO | __main__ | 
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:20:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:20:45 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.9952
2025-11-14 22:20:47 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7694
2025-11-14 22:20:49 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6579
2025-11-14 22:20:51 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5767
2025-11-14 22:20:52 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4714
2025-11-14 22:20:52 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:20:53 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.479
2025-11-14 22:20:53 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:20:53 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.053
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:20:54 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:20:56 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5677
2025-11-14 22:20:58 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4424
2025-11-14 22:21:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4701
2025-11-14 22:21:02 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4717
2025-11-14 22:21:04 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6492
2025-11-14 22:21:04 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:21:05 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.533
2025-11-14 22:21:05 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:21:05 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.039
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:21:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:07 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712
2025-11-14 22:21:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:07 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1909
2025-11-14 22:21:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0327
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1013
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3302
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:21:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2255
2025-11-14 22:21:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:10 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0735
2025-11-14 22:21:10 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:10 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0162
2025-11-14 22:21:10 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1287
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3138
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:21:11 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:21:18 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6658
2025-11-14 22:21:27 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4652
2025-11-14 22:21:37 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4307
2025-11-14 22:21:46 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4253
2025-11-14 22:21:53 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5060
2025-11-14 22:21:53 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:21:59 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.592
2025-11-14 22:21:59 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:21:59 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.028
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:22:01 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:22:03 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6612
2025-11-14 22:22:05 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4064
2025-11-14 22:22:08 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3990
2025-11-14 22:22:10 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3779
2025-11-14 22:22:12 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3804
2025-11-14 22:22:12 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:22:14 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.457
2025-11-14 22:22:14 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:22:14 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:22:15 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:22:16 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6448
2025-11-14 22:22:18 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4534
2025-11-14 22:22:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3324
2025-11-14 22:22:23 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.2684
2025-11-14 22:22:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3915
2025-11-14 22:22:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:22:26 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:22:26 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:22:26 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:22:27 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.043
2025-11-14 22:22:27 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:22:27 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:22:28 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:22:28 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:22:28 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:22:28 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:22:28 | INFO | __main__ | 
================================================================================
2025-11-14 22:22:28 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:22:28 | INFO | __main__ | ================================================================================
2025-11-14 22:22:28 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:22:28 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:22:28 | INFO | __main__ |   Total models: 49
2025-11-14 22:22:28 | INFO | __main__ |   Feature count: 231
2025-11-14 22:22:28 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:22:28 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:22:28 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:22:28 | INFO | __main__ |     - fomc_week
2025-11-14 22:22:28 | INFO | __main__ |     - futures_rollover
2025-11-14 22:22:28 | INFO | __main__ |     - mid_cycle
2025-11-14 22:22:28 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:22:28 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:22:28 | INFO | __main__ | ================================================================================

2025-11-14 22:22:28 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_222228.json
2025-11-14 22:22:28 | INFO | __main__ | 
================================================================================
2025-11-14 22:22:28 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:22:28 | INFO | __main__ | ================================================================================
2025-11-14 22:22:28 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:22:28 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:22:28 | INFO | __main__ | ================================================================================

2025-11-14 22:23:59 | INFO | __main__ | 
================================================================================
2025-11-14 22:23:59 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================
2025-11-14 22:23:59 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:23:59 | INFO | __main__ | Date: 2025-11-14 22:23:59
2025-11-14 22:23:59 | INFO | __main__ | Output: models
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================

2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================
2025-11-14 22:23:59 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:23:59 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:23:59 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:23:59 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:23:59 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:23:59 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:23:59 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:23:59 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================
2025-11-14 22:23:59 | INFO | __main__ | 
2025-11-14 22:23:59 | INFO | __main__ | 
================================================================================
2025-11-14 22:23:59 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:23:59 | INFO | __main__ | ================================================================================
2025-11-14 22:23:59 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:23:59 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:23:59 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:23:59 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:24:04 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:24:04 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:24:04 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:24:04 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:24:04 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:24:04 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:24:04 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:24:04 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:24:04 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:24:04 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:24:04 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:24:04 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:24:04 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:24:04 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:24:04 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:24:04 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:24:04 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:24:04 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:24:04 | INFO | __main__ | ================================================================================

2025-11-14 22:24:04 | INFO | __main__ | 
2025-11-14 22:24:04 | INFO | __main__ | ================================================================================
2025-11-14 22:24:04 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:24:04 | INFO | __main__ | ================================================================================
2025-11-14 22:24:04 | INFO | __main__ | 
2025-11-14 22:24:04 | INFO | __main__ | Starting training...
2025-11-14 22:24:04 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:24:04 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:24:04 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:24:04 | INFO | __main__ | 
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:04 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:24:06 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0774
2025-11-14 22:24:08 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7772
2025-11-14 22:24:10 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6611
2025-11-14 22:24:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.6246
2025-11-14 22:24:13 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4666
2025-11-14 22:24:13 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:24:14 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.542
2025-11-14 22:24:14 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:24:14 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.034
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:15 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:24:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5936
2025-11-14 22:24:19 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4282
2025-11-14 22:24:22 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4936
2025-11-14 22:24:24 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4694
2025-11-14 22:24:26 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6441
2025-11-14 22:24:26 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:24:27 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:24:27 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:24:27 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3499
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1678
2025-11-14 22:24:28 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:29 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0176
2025-11-14 22:24:29 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:29 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1381
2025-11-14 22:24:29 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3402
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2200
2025-11-14 22:24:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:31 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0661
2025-11-14 22:24:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:31 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0163
2025-11-14 22:24:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1195
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3897
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.978
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:24:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:24:33 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:24:40 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6750
2025-11-14 22:24:50 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4889
2025-11-14 22:25:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4444
2025-11-14 22:25:08 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4443
2025-11-14 22:25:15 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5254
2025-11-14 22:25:15 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:25:20 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.601
2025-11-14 22:25:20 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:25:20 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:25:22 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:25:24 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6401
2025-11-14 22:25:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4623
2025-11-14 22:25:29 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3677
2025-11-14 22:25:31 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3336
2025-11-14 22:25:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3620
2025-11-14 22:25:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:25:34 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.429
2025-11-14 22:25:34 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:25:34 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:25:35 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:25:37 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6877
2025-11-14 22:25:39 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4866
2025-11-14 22:25:42 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3316
2025-11-14 22:25:44 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3108
2025-11-14 22:25:45 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4270
2025-11-14 22:25:45 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:25:47 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.600
2025-11-14 22:25:47 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:25:47 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:25:48 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:25:48 | INFO | __main__ | 
================================================================================
2025-11-14 22:25:48 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:25:48 | INFO | __main__ | ================================================================================
2025-11-14 22:25:48 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:25:48 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:25:48 | INFO | __main__ |   Total models: 49
2025-11-14 22:25:48 | INFO | __main__ |   Feature count: 231
2025-11-14 22:25:48 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:25:48 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:25:48 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:25:48 | INFO | __main__ |     - fomc_week
2025-11-14 22:25:48 | INFO | __main__ |     - futures_rollover
2025-11-14 22:25:48 | INFO | __main__ |     - mid_cycle
2025-11-14 22:25:48 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:25:48 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:25:48 | INFO | __main__ | ================================================================================

2025-11-14 22:25:48 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_222548.json
2025-11-14 22:25:48 | INFO | __main__ | 
================================================================================
2025-11-14 22:25:48 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:25:48 | INFO | __main__ | ================================================================================
2025-11-14 22:25:48 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:25:48 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:25:48 | INFO | __main__ | ================================================================================

2025-11-14 22:26:04 | INFO | __main__ | 
================================================================================
2025-11-14 22:26:04 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================
2025-11-14 22:26:04 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:26:04 | INFO | __main__ | Date: 2025-11-14 22:26:04
2025-11-14 22:26:04 | INFO | __main__ | Output: models
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================

2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================
2025-11-14 22:26:04 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:26:04 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:26:04 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:26:04 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:26:04 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:26:04 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:26:04 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:26:04 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================
2025-11-14 22:26:04 | INFO | __main__ | 
2025-11-14 22:26:04 | INFO | __main__ | 
================================================================================
2025-11-14 22:26:04 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:26:04 | INFO | __main__ | ================================================================================
2025-11-14 22:26:04 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:26:04 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:26:04 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:26:04 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:37:03 | INFO | __main__ | 
================================================================================
2025-11-14 22:37:03 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================
2025-11-14 22:37:03 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:37:03 | INFO | __main__ | Date: 2025-11-14 22:37:03
2025-11-14 22:37:03 | INFO | __main__ | Output: models
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================

2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================
2025-11-14 22:37:03 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:37:03 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:37:03 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:37:03 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:37:03 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:37:03 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:37:03 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:37:03 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================
2025-11-14 22:37:03 | INFO | __main__ | 
2025-11-14 22:37:03 | INFO | __main__ | 
================================================================================
2025-11-14 22:37:03 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:37:03 | INFO | __main__ | ================================================================================
2025-11-14 22:37:03 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:37:03 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:37:03 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:37:03 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:37:07 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:37:07 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:37:07 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:37:07 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:37:07 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:37:07 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:37:07 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:37:07 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:37:07 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:37:07 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:37:07 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:37:07 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:37:07 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:37:07 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:37:07 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:37:07 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:37:07 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:37:07 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:37:07 | INFO | __main__ | ================================================================================

2025-11-14 22:37:07 | INFO | __main__ | 
2025-11-14 22:37:07 | INFO | __main__ | ================================================================================
2025-11-14 22:37:07 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:37:07 | INFO | __main__ | ================================================================================
2025-11-14 22:37:07 | INFO | __main__ | 
2025-11-14 22:37:07 | INFO | __main__ | Starting training...
2025-11-14 22:37:07 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:37:07 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:37:07 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:37:07 | INFO | __main__ | 
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:07 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:37:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0774
2025-11-14 22:37:11 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7772
2025-11-14 22:37:13 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6611
2025-11-14 22:37:15 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.6246
2025-11-14 22:37:17 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4666
2025-11-14 22:37:17 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:37:19 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.542
2025-11-14 22:37:19 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:37:19 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.034
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:21 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:37:23 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5936
2025-11-14 22:37:25 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4282
2025-11-14 22:37:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4936
2025-11-14 22:37:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4694
2025-11-14 22:37:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6441
2025-11-14 22:37:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:37:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:37:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:37:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3499
2025-11-14 22:37:34 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:35 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1678
2025-11-14 22:37:35 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:35 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0176
2025-11-14 22:37:35 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1381
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3402
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:37:36 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:37 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2200
2025-11-14 22:37:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0661
2025-11-14 22:37:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:38 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0163
2025-11-14 22:37:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:38 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1195
2025-11-14 22:37:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3897
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.978
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:37:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:37:46 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6750
2025-11-14 22:37:55 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4889
2025-11-14 22:38:06 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4444
2025-11-14 22:38:16 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4443
2025-11-14 22:38:24 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5254
2025-11-14 22:38:24 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:38:28 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.601
2025-11-14 22:38:28 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:38:28 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:38:31 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:38:33 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6401
2025-11-14 22:38:35 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4623
2025-11-14 22:38:38 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3677
2025-11-14 22:38:40 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3336
2025-11-14 22:38:42 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3620
2025-11-14 22:38:42 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:38:44 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.429
2025-11-14 22:38:44 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:38:44 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:38:45 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:38:46 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6877
2025-11-14 22:38:49 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4866
2025-11-14 22:38:51 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3316
2025-11-14 22:38:53 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3108
2025-11-14 22:38:55 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4270
2025-11-14 22:38:55 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:38:56 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.600
2025-11-14 22:38:56 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:38:56 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:38:57 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:38:57 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:38:57 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:38:58 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:38:58 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:38:58 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:38:58 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:38:58 | INFO | __main__ | 
================================================================================
2025-11-14 22:38:58 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:38:58 | INFO | __main__ | ================================================================================
2025-11-14 22:38:58 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:38:58 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:38:58 | INFO | __main__ |   Total models: 49
2025-11-14 22:38:58 | INFO | __main__ |   Feature count: 231
2025-11-14 22:38:58 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:38:58 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:38:58 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:38:58 | INFO | __main__ |     - fomc_week
2025-11-14 22:38:58 | INFO | __main__ |     - futures_rollover
2025-11-14 22:38:58 | INFO | __main__ |     - mid_cycle
2025-11-14 22:38:58 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:38:58 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:38:58 | INFO | __main__ | ================================================================================

2025-11-14 22:38:58 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_223858.json
2025-11-14 22:38:58 | INFO | __main__ | 
================================================================================
2025-11-14 22:38:58 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:38:58 | INFO | __main__ | ================================================================================
2025-11-14 22:38:58 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:38:58 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:38:58 | INFO | __main__ | ================================================================================

2025-11-14 22:43:00 | INFO | __main__ | 
================================================================================
2025-11-14 22:43:00 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================
2025-11-14 22:43:00 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:43:00 | INFO | __main__ | Date: 2025-11-14 22:43:00
2025-11-14 22:43:00 | INFO | __main__ | Output: models
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================

2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================
2025-11-14 22:43:00 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:43:00 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:43:00 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:43:00 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:43:00 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:43:00 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:43:00 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:43:00 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================
2025-11-14 22:43:00 | INFO | __main__ | 
2025-11-14 22:43:00 | INFO | __main__ | 
================================================================================
2025-11-14 22:43:00 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:43:00 | INFO | __main__ | ================================================================================
2025-11-14 22:43:00 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:43:00 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:43:00 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:43:00 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:43:06 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:43:06 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:43:06 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:43:06 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:43:06 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:43:06 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:43:06 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:43:06 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:43:06 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:43:06 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:43:06 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:43:06 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:43:06 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:43:06 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:43:06 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:43:06 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:43:06 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:43:06 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:43:06 | INFO | __main__ | ================================================================================

2025-11-14 22:43:06 | INFO | __main__ | 
2025-11-14 22:43:06 | INFO | __main__ | ================================================================================
2025-11-14 22:43:06 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:43:06 | INFO | __main__ | ================================================================================
2025-11-14 22:43:06 | INFO | __main__ | 
2025-11-14 22:43:06 | INFO | __main__ | Starting training...
2025-11-14 22:43:06 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:43:06 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:43:06 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:43:06 | INFO | __main__ | 
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:06 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:43:08 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0774
2025-11-14 22:43:10 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7772
2025-11-14 22:43:12 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6611
2025-11-14 22:43:14 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.6246
2025-11-14 22:43:15 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4666
2025-11-14 22:43:15 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.542
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.034
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:17 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:43:19 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5936
2025-11-14 22:43:21 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4282
2025-11-14 22:43:24 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4936
2025-11-14 22:43:26 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4694
2025-11-14 22:43:28 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6441
2025-11-14 22:43:28 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:43:29 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:43:29 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:43:29 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3499
2025-11-14 22:43:30 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:31 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1678
2025-11-14 22:43:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:31 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0176
2025-11-14 22:43:31 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1381
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3402
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:43:32 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:33 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2200
2025-11-14 22:43:33 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:33 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0661
2025-11-14 22:43:33 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:34 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0163
2025-11-14 22:43:34 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1195
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3897
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.978
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:43:35 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:43:43 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6750
2025-11-14 22:43:52 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4889
2025-11-14 22:44:02 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4444
2025-11-14 22:44:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4443
2025-11-14 22:44:19 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5254
2025-11-14 22:44:19 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:44:23 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.601
2025-11-14 22:44:23 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:44:23 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:44:25 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:44:27 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6401
2025-11-14 22:44:29 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4623
2025-11-14 22:44:32 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3677
2025-11-14 22:44:34 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3336
2025-11-14 22:44:36 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3620
2025-11-14 22:44:36 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:44:37 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.429
2025-11-14 22:44:37 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:44:37 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:44:38 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:44:40 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6877
2025-11-14 22:44:42 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4866
2025-11-14 22:44:45 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3316
2025-11-14 22:44:47 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3108
2025-11-14 22:44:49 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4270
2025-11-14 22:44:49 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:44:50 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.600
2025-11-14 22:44:50 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:44:50 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:44:51 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:44:51 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:44:51 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:44:52 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:44:52 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:44:52 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:44:52 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:44:52 | INFO | __main__ | 
================================================================================
2025-11-14 22:44:52 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:44:52 | INFO | __main__ | ================================================================================
2025-11-14 22:44:52 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:44:52 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:44:52 | INFO | __main__ |   Total models: 49
2025-11-14 22:44:52 | INFO | __main__ |   Feature count: 231
2025-11-14 22:44:52 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:44:52 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:44:52 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:44:52 | INFO | __main__ |     - fomc_week
2025-11-14 22:44:52 | INFO | __main__ |     - futures_rollover
2025-11-14 22:44:52 | INFO | __main__ |     - mid_cycle
2025-11-14 22:44:52 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:44:52 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:44:52 | INFO | __main__ | ================================================================================

2025-11-14 22:44:52 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_224452.json
2025-11-14 22:44:52 | INFO | __main__ | 
================================================================================
2025-11-14 22:44:52 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:44:52 | INFO | __main__ | ================================================================================
2025-11-14 22:44:52 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:44:52 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:44:52 | INFO | __main__ | ================================================================================

2025-11-14 22:55:34 | INFO | __main__ | 
================================================================================
2025-11-14 22:55:34 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================
2025-11-14 22:55:34 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-14 22:55:34 | INFO | __main__ | Date: 2025-11-14 22:55:34
2025-11-14 22:55:34 | INFO | __main__ | Output: models
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================

2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================
2025-11-14 22:55:34 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Point estimate removed
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-14 22:55:34 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-14 22:55:34 | INFO | __main__ |   Expected models per cohort: 7
2025-11-14 22:55:34 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-14 22:55:34 | INFO | __main__ |     - 1 direction classifier
2025-11-14 22:55:34 | INFO | __main__ |     - 1 confidence scorer
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-14 22:55:34 | INFO | __main__ |   ✅ Confidence model configured
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-14 22:55:34 | INFO | __main__ |    All checks successful - ready to train
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================
2025-11-14 22:55:34 | INFO | __main__ | 
2025-11-14 22:55:34 | INFO | __main__ | 
================================================================================
2025-11-14 22:55:34 | INFO | __main__ | DATA PREPARATION
2025-11-14 22:55:34 | INFO | __main__ | ================================================================================
2025-11-14 22:55:34 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-14 22:55:34 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-14 22:55:34 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-14 22:55:34 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-14 22:55:40 | INFO | __main__ | 
  Features created: 235
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-14 22:55:40 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-14 22:55:40 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-14 22:55:40 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-14 22:55:40 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-14 22:55:40 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-14 22:55:40 | INFO | __main__ |   Cohort distribution:
2025-11-14 22:55:40 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-14 22:55:40 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-14 22:55:40 | INFO | __main__ |     fomc_week: 37 samples
2025-11-14 22:55:40 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-14 22:55:40 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-14 22:55:40 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-14 22:55:40 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-14 22:55:40 | INFO | __main__ | 
  Final dataframe shape: (1066, 236)
2025-11-14 22:55:40 | INFO | __main__ |   Columns: features (233) + vix + spx + calendar_cohort
2025-11-14 22:55:40 | INFO | __main__ | 
✅ Data preparation complete
2025-11-14 22:55:40 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-14 22:55:40 | INFO | __main__ | ================================================================================

2025-11-14 22:55:40 | INFO | __main__ | 
2025-11-14 22:55:40 | INFO | __main__ | ================================================================================
2025-11-14 22:55:40 | INFO | __main__ | MODEL TRAINING
2025-11-14 22:55:40 | INFO | __main__ | ================================================================================
2025-11-14 22:55:40 | INFO | __main__ | 
2025-11-14 22:55:40 | INFO | __main__ | Starting training...
2025-11-14 22:55:40 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-14 22:55:40 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-14 22:55:40 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-14 22:55:40 | INFO | __main__ | 
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | 
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:55:40 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:55:41 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0774
2025-11-14 22:55:43 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.7772
2025-11-14 22:55:45 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6611
2025-11-14 22:55:47 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.6246
2025-11-14 22:55:49 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4666
2025-11-14 22:55:49 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:55:50 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.542
2025-11-14 22:55:50 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:55:50 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.034
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:55:51 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:55:53 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5936
2025-11-14 22:55:55 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4282
2025-11-14 22:55:57 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4936
2025-11-14 22:55:59 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4694
2025-11-14 22:56:01 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6441
2025-11-14 22:56:01 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:56:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.583
2025-11-14 22:56:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:56:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:56:03 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3499
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1678
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0176
2025-11-14 22:56:04 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1381
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3402
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:56:05 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2200
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0661
2025-11-14 22:56:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:07 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0163
2025-11-14 22:56:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:07 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1195
2025-11-14 22:56:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3897
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.978
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:08 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:56:15 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6750
2025-11-14 22:56:25 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4889
2025-11-14 22:56:35 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4444
2025-11-14 22:56:44 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4443
2025-11-14 22:56:51 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.5254
2025-11-14 22:56:51 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:56:55 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.601
2025-11-14 22:56:55 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:56:55 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:56:57 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:56:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6401
2025-11-14 22:57:02 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4623
2025-11-14 22:57:05 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3677
2025-11-14 22:57:07 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3336
2025-11-14 22:57:09 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3620
2025-11-14 22:57:09 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:57:10 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.429
2025-11-14 22:57:10 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:57:10 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-14 22:57:11 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-14 22:57:13 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6877
2025-11-14 22:57:15 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4866
2025-11-14 22:57:17 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3316
2025-11-14 22:57:19 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3108
2025-11-14 22:57:21 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4270
2025-11-14 22:57:21 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-14 22:57:23 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.600
2025-11-14 22:57:23 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-14 22:57:23 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-14 22:57:24 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-14 22:57:24 | INFO | __main__ | 
================================================================================
2025-11-14 22:57:24 | INFO | __main__ | TRAINING SUMMARY
2025-11-14 22:57:24 | INFO | __main__ | ================================================================================
2025-11-14 22:57:24 | INFO | __main__ |   Cohorts trained: 7
2025-11-14 22:57:24 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-14 22:57:24 | INFO | __main__ |   Total models: 49
2025-11-14 22:57:24 | INFO | __main__ |   Feature count: 231
2025-11-14 22:57:24 | INFO | __main__ | 
  Cohorts:
2025-11-14 22:57:24 | INFO | __main__ |     - earnings_heavy
2025-11-14 22:57:24 | INFO | __main__ |     - fomc_minus_3
2025-11-14 22:57:24 | INFO | __main__ |     - fomc_week
2025-11-14 22:57:24 | INFO | __main__ |     - futures_rollover
2025-11-14 22:57:24 | INFO | __main__ |     - mid_cycle
2025-11-14 22:57:24 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-14 22:57:24 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-14 22:57:24 | INFO | __main__ | ================================================================================

2025-11-14 22:57:24 | INFO | __main__ | ✅ Training report saved: models/training_report_20251114_225724.json
2025-11-14 22:57:24 | INFO | __main__ | 
================================================================================
2025-11-14 22:57:24 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-14 22:57:24 | INFO | __main__ | ================================================================================
2025-11-14 22:57:24 | INFO | __main__ |   Models saved to: models/
2025-11-14 22:57:24 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-14 22:57:24 | INFO | __main__ | ================================================================================

2025-11-15 02:31:55 | INFO | __main__ | 
================================================================================
2025-11-15 02:31:55 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================
2025-11-15 02:31:55 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 02:31:55 | INFO | __main__ | Date: 2025-11-15 02:31:55
2025-11-15 02:31:55 | INFO | __main__ | Output: models
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================

2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================
2025-11-15 02:31:55 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 02:31:55 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 02:31:55 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 02:31:55 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 02:31:55 | INFO | __main__ |     - 1 direction classifier
2025-11-15 02:31:55 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 02:31:55 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 02:31:55 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================
2025-11-15 02:31:55 | INFO | __main__ | 
2025-11-15 02:31:55 | INFO | __main__ | 
================================================================================
2025-11-15 02:31:55 | INFO | __main__ | DATA PREPARATION
2025-11-15 02:31:55 | INFO | __main__ | ================================================================================
2025-11-15 02:31:55 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 02:31:55 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 02:31:55 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 02:31:55 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 02:32:00 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 02:32:00 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 02:32:00 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 02:32:00 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 02:32:00 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 02:32:00 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 02:32:00 | INFO | __main__ |   Cohort distribution:
2025-11-15 02:32:00 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 02:32:00 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 02:32:00 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 02:32:00 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 02:32:00 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 02:32:00 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 02:32:00 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 02:32:00 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 02:32:00 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 02:32:00 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 02:32:00 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 02:32:00 | INFO | __main__ | ================================================================================

2025-11-15 02:32:00 | INFO | __main__ | 
2025-11-15 02:32:00 | INFO | __main__ | ================================================================================
2025-11-15 02:32:00 | INFO | __main__ | MODEL TRAINING
2025-11-15 02:32:00 | INFO | __main__ | ================================================================================
2025-11-15 02:32:00 | INFO | __main__ | 
2025-11-15 02:32:00 | INFO | __main__ | Starting training...
2025-11-15 02:32:00 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 02:32:00 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 02:32:00 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 02:32:00 | INFO | __main__ | 
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:00 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:32:01 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0856
2025-11-15 02:32:03 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.9139
2025-11-15 02:32:05 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6182
2025-11-15 02:32:06 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5674
2025-11-15 02:32:08 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4667
2025-11-15 02:32:08 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:32:08 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 02:32:08 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:32:08 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:32:11 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5758
2025-11-15 02:32:13 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4625
2025-11-15 02:32:15 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4877
2025-11-15 02:32:17 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4910
2025-11-15 02:32:18 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6514
2025-11-15 02:32:18 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:32:19 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 02:32:19 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:32:19 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3141
2025-11-15 02:32:20 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1789
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0243
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1008
2025-11-15 02:32:21 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3284
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2391
2025-11-15 02:32:22 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:23 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0563
2025-11-15 02:32:23 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:23 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0171
2025-11-15 02:32:23 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1225
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3291
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:32:24 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:32:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6515
2025-11-15 02:32:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4628
2025-11-15 02:32:45 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4513
2025-11-15 02:32:52 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4396
2025-11-15 02:32:58 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4985
2025-11-15 02:32:58 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:33:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 02:33:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:33:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:33:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:33:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6654
2025-11-15 02:33:07 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4371
2025-11-15 02:33:09 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3889
2025-11-15 02:33:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3449
2025-11-15 02:33:13 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3578
2025-11-15 02:33:13 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:33:14 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 02:33:14 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:33:14 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 02:33:15 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 02:33:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6463
2025-11-15 02:33:18 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3719
2025-11-15 02:33:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2959
2025-11-15 02:33:22 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3107
2025-11-15 02:33:24 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4314
2025-11-15 02:33:24 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 02:33:25 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 02:33:25 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 02:33:25 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 02:33:26 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 02:33:26 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 02:33:26 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 02:33:27 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 02:33:27 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 02:33:27 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 02:33:27 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 02:33:27 | INFO | __main__ | 
================================================================================
2025-11-15 02:33:27 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 02:33:27 | INFO | __main__ | ================================================================================
2025-11-15 02:33:27 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 02:33:27 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 02:33:27 | INFO | __main__ |   Total models: 49
2025-11-15 02:33:27 | INFO | __main__ |   Feature count: 164
2025-11-15 02:33:27 | INFO | __main__ | 
  Cohorts:
2025-11-15 02:33:27 | INFO | __main__ |     - earnings_heavy
2025-11-15 02:33:27 | INFO | __main__ |     - fomc_minus_3
2025-11-15 02:33:27 | INFO | __main__ |     - fomc_week
2025-11-15 02:33:27 | INFO | __main__ |     - futures_rollover
2025-11-15 02:33:27 | INFO | __main__ |     - mid_cycle
2025-11-15 02:33:27 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 02:33:27 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 02:33:27 | INFO | __main__ | ================================================================================

2025-11-15 02:33:27 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_023327.json
2025-11-15 02:33:27 | INFO | __main__ | 
================================================================================
2025-11-15 02:33:27 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 02:33:27 | INFO | __main__ | ================================================================================
2025-11-15 02:33:27 | INFO | __main__ |   Models saved to: models/
2025-11-15 02:33:27 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 02:33:27 | INFO | __main__ | ================================================================================

2025-11-15 11:59:14 | INFO | __main__ | 
================================================================================
2025-11-15 11:59:14 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================
2025-11-15 11:59:14 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 11:59:14 | INFO | __main__ | Date: 2025-11-15 11:59:14
2025-11-15 11:59:14 | INFO | __main__ | Output: models
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================

2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================
2025-11-15 11:59:14 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 11:59:14 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 11:59:14 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 11:59:14 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 11:59:14 | INFO | __main__ |     - 1 direction classifier
2025-11-15 11:59:14 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 11:59:14 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 11:59:14 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================
2025-11-15 11:59:14 | INFO | __main__ | 
2025-11-15 11:59:14 | INFO | __main__ | 
================================================================================
2025-11-15 11:59:14 | INFO | __main__ | DATA PREPARATION
2025-11-15 11:59:14 | INFO | __main__ | ================================================================================
2025-11-15 11:59:14 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 11:59:14 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 11:59:14 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 11:59:14 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 11:59:19 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 11:59:19 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 11:59:19 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 11:59:19 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 11:59:19 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 11:59:19 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 11:59:19 | INFO | __main__ |   Cohort distribution:
2025-11-15 11:59:19 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 11:59:19 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 11:59:19 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 11:59:19 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 11:59:19 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 11:59:19 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 11:59:19 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 11:59:19 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 11:59:19 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 11:59:19 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 11:59:19 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 11:59:19 | INFO | __main__ | ================================================================================

2025-11-15 11:59:19 | INFO | __main__ | 
2025-11-15 11:59:19 | INFO | __main__ | ================================================================================
2025-11-15 11:59:19 | INFO | __main__ | MODEL TRAINING
2025-11-15 11:59:19 | INFO | __main__ | ================================================================================
2025-11-15 11:59:19 | INFO | __main__ | 
2025-11-15 11:59:19 | INFO | __main__ | Starting training...
2025-11-15 11:59:19 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 11:59:19 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 11:59:19 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 11:59:19 | INFO | __main__ | 
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:19 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 11:59:20 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0856
2025-11-15 11:59:22 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.9139
2025-11-15 11:59:24 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6182
2025-11-15 11:59:25 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5674
2025-11-15 11:59:27 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4667
2025-11-15 11:59:27 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 11:59:27 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 11:59:27 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 11:59:27 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:28 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 11:59:30 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5758
2025-11-15 11:59:32 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4625
2025-11-15 11:59:34 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4877
2025-11-15 11:59:36 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4910
2025-11-15 11:59:37 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6514
2025-11-15 11:59:37 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 11:59:38 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 11:59:38 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 11:59:38 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3141
2025-11-15 11:59:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1789
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0243
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1008
2025-11-15 11:59:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3284
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2391
2025-11-15 11:59:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:42 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0563
2025-11-15 11:59:42 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:42 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0171
2025-11-15 11:59:42 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1225
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3291
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 11:59:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 11:59:49 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6515
2025-11-15 11:59:57 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4628
2025-11-15 12:00:05 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4513
2025-11-15 12:00:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4396
2025-11-15 12:00:18 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4985
2025-11-15 12:00:18 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 12:00:21 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 12:00:21 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 12:00:21 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 12:00:23 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 12:00:24 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6654
2025-11-15 12:00:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4371
2025-11-15 12:00:29 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3889
2025-11-15 12:00:31 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3449
2025-11-15 12:00:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3578
2025-11-15 12:00:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 12:00:34 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 12:00:34 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 12:00:34 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 12:00:35 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 12:00:36 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6463
2025-11-15 12:00:38 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3719
2025-11-15 12:00:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2959
2025-11-15 12:00:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3107
2025-11-15 12:00:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4314
2025-11-15 12:00:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 12:00:44 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 12:00:44 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 12:00:44 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 12:00:45 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 12:00:45 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 12:00:45 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 12:00:46 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 12:00:46 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 12:00:46 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 12:00:46 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 12:00:46 | INFO | __main__ | 
================================================================================
2025-11-15 12:00:46 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 12:00:46 | INFO | __main__ | ================================================================================
2025-11-15 12:00:46 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 12:00:46 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 12:00:46 | INFO | __main__ |   Total models: 49
2025-11-15 12:00:46 | INFO | __main__ |   Feature count: 164
2025-11-15 12:00:46 | INFO | __main__ | 
  Cohorts:
2025-11-15 12:00:46 | INFO | __main__ |     - earnings_heavy
2025-11-15 12:00:46 | INFO | __main__ |     - fomc_minus_3
2025-11-15 12:00:46 | INFO | __main__ |     - fomc_week
2025-11-15 12:00:46 | INFO | __main__ |     - futures_rollover
2025-11-15 12:00:46 | INFO | __main__ |     - mid_cycle
2025-11-15 12:00:46 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 12:00:46 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 12:00:46 | INFO | __main__ | ================================================================================

2025-11-15 12:00:46 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_120046.json
2025-11-15 12:00:46 | INFO | __main__ | 
================================================================================
2025-11-15 12:00:46 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 12:00:46 | INFO | __main__ | ================================================================================
2025-11-15 12:00:46 | INFO | __main__ |   Models saved to: models/
2025-11-15 12:00:46 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 12:00:46 | INFO | __main__ | ================================================================================

2025-11-15 19:37:13 | INFO | __main__ | 
================================================================================
2025-11-15 19:37:13 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================
2025-11-15 19:37:13 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 19:37:13 | INFO | __main__ | Date: 2025-11-15 19:37:13
2025-11-15 19:37:13 | INFO | __main__ | Output: models
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================

2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================
2025-11-15 19:37:13 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 19:37:13 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 19:37:13 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 19:37:13 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 19:37:13 | INFO | __main__ |     - 1 direction classifier
2025-11-15 19:37:13 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 19:37:13 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 19:37:13 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================
2025-11-15 19:37:13 | INFO | __main__ | 
2025-11-15 19:37:13 | INFO | __main__ | 
================================================================================
2025-11-15 19:37:13 | INFO | __main__ | DATA PREPARATION
2025-11-15 19:37:13 | INFO | __main__ | ================================================================================
2025-11-15 19:37:13 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 19:37:13 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 19:37:13 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 19:37:13 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 19:37:16 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 19:37:16 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 19:37:16 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 19:37:16 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 19:37:16 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 19:37:16 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 19:37:16 | INFO | __main__ |   Cohort distribution:
2025-11-15 19:37:16 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 19:37:16 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 19:37:16 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 19:37:16 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 19:37:16 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 19:37:16 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 19:37:16 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 19:37:16 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 19:37:16 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 19:37:16 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 19:37:16 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 19:37:16 | INFO | __main__ | ================================================================================

2025-11-15 19:37:16 | INFO | __main__ | 
2025-11-15 19:37:16 | INFO | __main__ | ================================================================================
2025-11-15 19:37:16 | INFO | __main__ | MODEL TRAINING
2025-11-15 19:37:16 | INFO | __main__ | ================================================================================
2025-11-15 19:37:16 | INFO | __main__ | 
2025-11-15 19:37:16 | INFO | __main__ | Starting training...
2025-11-15 19:37:16 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 19:37:16 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 19:37:16 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 19:37:16 | INFO | __main__ | 
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:16 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:37:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0856
2025-11-15 19:37:19 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.9139
2025-11-15 19:37:21 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6182
2025-11-15 19:37:22 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5674
2025-11-15 19:37:24 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4667
2025-11-15 19:37:24 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:37:24 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 19:37:24 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:37:24 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:25 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:37:27 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5758
2025-11-15 19:37:29 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4625
2025-11-15 19:37:31 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4877
2025-11-15 19:37:33 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4910
2025-11-15 19:37:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6514
2025-11-15 19:37:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:37:35 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 19:37:35 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:37:36 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3141
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1789
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0243
2025-11-15 19:37:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1008
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3284
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:38 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2391
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0563
2025-11-15 19:37:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0171
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1225
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3291
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:37:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:37:41 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:37:47 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6515
2025-11-15 19:37:55 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4628
2025-11-15 19:38:03 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4513
2025-11-15 19:38:10 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4396
2025-11-15 19:38:17 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4985
2025-11-15 19:38:17 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:38:20 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 19:38:20 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:38:20 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:38:22 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:38:24 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6654
2025-11-15 19:38:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4371
2025-11-15 19:38:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3889
2025-11-15 19:38:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3449
2025-11-15 19:38:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3578
2025-11-15 19:38:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:38:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 19:38:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:38:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 19:38:34 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 19:38:36 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6463
2025-11-15 19:38:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3719
2025-11-15 19:38:40 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2959
2025-11-15 19:38:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3107
2025-11-15 19:38:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4314
2025-11-15 19:38:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 19:38:44 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 19:38:44 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 19:38:44 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 19:38:45 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 19:38:45 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 19:38:45 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 19:38:46 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 19:38:46 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 19:38:46 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 19:38:46 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 19:38:46 | INFO | __main__ | 
================================================================================
2025-11-15 19:38:46 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 19:38:46 | INFO | __main__ | ================================================================================
2025-11-15 19:38:46 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 19:38:46 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 19:38:46 | INFO | __main__ |   Total models: 49
2025-11-15 19:38:46 | INFO | __main__ |   Feature count: 164
2025-11-15 19:38:46 | INFO | __main__ | 
  Cohorts:
2025-11-15 19:38:46 | INFO | __main__ |     - earnings_heavy
2025-11-15 19:38:46 | INFO | __main__ |     - fomc_minus_3
2025-11-15 19:38:46 | INFO | __main__ |     - fomc_week
2025-11-15 19:38:46 | INFO | __main__ |     - futures_rollover
2025-11-15 19:38:46 | INFO | __main__ |     - mid_cycle
2025-11-15 19:38:46 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 19:38:46 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 19:38:46 | INFO | __main__ | ================================================================================

2025-11-15 19:38:46 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_193846.json
2025-11-15 19:38:46 | INFO | __main__ | 
================================================================================
2025-11-15 19:38:46 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 19:38:46 | INFO | __main__ | ================================================================================
2025-11-15 19:38:46 | INFO | __main__ |   Models saved to: models/
2025-11-15 19:38:46 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 19:38:46 | INFO | __main__ | ================================================================================

2025-11-15 20:18:14 | INFO | __main__ | 
================================================================================
2025-11-15 20:18:14 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================
2025-11-15 20:18:14 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 20:18:14 | INFO | __main__ | Date: 2025-11-15 20:18:14
2025-11-15 20:18:14 | INFO | __main__ | Output: models
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================

2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================
2025-11-15 20:18:14 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 20:18:14 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 20:18:14 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 20:18:14 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 20:18:14 | INFO | __main__ |     - 1 direction classifier
2025-11-15 20:18:14 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 20:18:14 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 20:18:14 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================
2025-11-15 20:18:14 | INFO | __main__ | 
2025-11-15 20:18:14 | INFO | __main__ | 
================================================================================
2025-11-15 20:18:14 | INFO | __main__ | DATA PREPARATION
2025-11-15 20:18:14 | INFO | __main__ | ================================================================================
2025-11-15 20:18:14 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 20:18:14 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 20:18:14 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 20:18:14 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 20:18:17 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 20:18:17 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 20:18:17 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 20:18:17 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 20:18:17 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 20:18:17 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 20:18:17 | INFO | __main__ |   Cohort distribution:
2025-11-15 20:18:17 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 20:18:17 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 20:18:17 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 20:18:17 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 20:18:17 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 20:18:17 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 20:18:17 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 20:18:17 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 20:18:17 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 20:18:17 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 20:18:17 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 20:18:17 | INFO | __main__ | ================================================================================

2025-11-15 20:18:17 | INFO | __main__ | 
2025-11-15 20:18:17 | INFO | __main__ | ================================================================================
2025-11-15 20:18:17 | INFO | __main__ | MODEL TRAINING
2025-11-15 20:18:17 | INFO | __main__ | ================================================================================
2025-11-15 20:18:17 | INFO | __main__ | 
2025-11-15 20:18:17 | INFO | __main__ | Starting training...
2025-11-15 20:18:17 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 20:18:17 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 20:18:17 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 20:18:17 | INFO | __main__ | 
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:17 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:18:18 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0856, var=0.3612
2025-11-15 20:18:20 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.9139, var=0.3283
2025-11-15 20:18:22 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6182, var=0.2557
2025-11-15 20:18:24 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5674, var=0.2676
2025-11-15 20:18:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4667, var=0.3086
2025-11-15 20:18:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:18:26 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 20:18:26 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:18:26 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:27 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:18:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5758, var=0.3599
2025-11-15 20:18:30 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4625, var=0.2899
2025-11-15 20:18:32 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4877, var=0.2937
2025-11-15 20:18:34 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4910, var=0.2993
2025-11-15 20:18:36 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6514, var=0.2919
2025-11-15 20:18:36 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:18:37 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:38 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3141, var=0.1913
2025-11-15 20:18:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:38 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1789, var=0.1184
2025-11-15 20:18:38 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0243, var=0.0046
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1008, var=0.0332
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3284, var=0.1498
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:18:39 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2391, var=0.0602
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0563, var=0.0106
2025-11-15 20:18:40 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:41 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0171, var=0.0036
2025-11-15 20:18:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:41 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1225, var=0.0497
2025-11-15 20:18:41 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3291, var=0.1598
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:18:42 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:18:48 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6515, var=0.3134
2025-11-15 20:18:56 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4628, var=0.2994
2025-11-15 20:19:04 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4513, var=0.3267
2025-11-15 20:19:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4396, var=0.2987
2025-11-15 20:19:16 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4985, var=0.3083
2025-11-15 20:19:16 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:19:20 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 20:19:20 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:19:20 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:19:22 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:19:24 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6654, var=0.1864
2025-11-15 20:19:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4371, var=0.1833
2025-11-15 20:19:28 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3889, var=0.2171
2025-11-15 20:19:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3449, var=0.1869
2025-11-15 20:19:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3578, var=0.1864
2025-11-15 20:19:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:19:33 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 20:19:33 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:19:33 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:19:34 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:19:35 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6463, var=0.1538
2025-11-15 20:19:37 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3719, var=0.1213
2025-11-15 20:19:39 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2959, var=0.1358
2025-11-15 20:19:41 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3107, var=0.1338
2025-11-15 20:19:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4314, var=0.1569
2025-11-15 20:19:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:19:44 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 20:19:44 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:19:44 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 20:19:45 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:19:45 | INFO | __main__ | 
================================================================================
2025-11-15 20:19:45 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 20:19:45 | INFO | __main__ | ================================================================================
2025-11-15 20:19:45 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 20:19:45 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 20:19:45 | INFO | __main__ |   Total models: 49
2025-11-15 20:19:45 | INFO | __main__ |   Feature count: 164
2025-11-15 20:19:45 | INFO | __main__ | 
  Cohorts:
2025-11-15 20:19:45 | INFO | __main__ |     - earnings_heavy
2025-11-15 20:19:45 | INFO | __main__ |     - fomc_minus_3
2025-11-15 20:19:45 | INFO | __main__ |     - fomc_week
2025-11-15 20:19:45 | INFO | __main__ |     - futures_rollover
2025-11-15 20:19:45 | INFO | __main__ |     - mid_cycle
2025-11-15 20:19:45 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 20:19:45 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 20:19:45 | INFO | __main__ | ================================================================================

2025-11-15 20:19:45 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_201945.json
2025-11-15 20:19:45 | INFO | __main__ | 
================================================================================
2025-11-15 20:19:45 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 20:19:45 | INFO | __main__ | ================================================================================
2025-11-15 20:19:45 | INFO | __main__ |   Models saved to: models/
2025-11-15 20:19:45 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 20:19:45 | INFO | __main__ | ================================================================================

2025-11-15 20:22:33 | INFO | __main__ | 
================================================================================
2025-11-15 20:22:33 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================
2025-11-15 20:22:33 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 20:22:33 | INFO | __main__ | Date: 2025-11-15 20:22:33
2025-11-15 20:22:33 | INFO | __main__ | Output: models
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================

2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================
2025-11-15 20:22:33 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Target type correct: log_realized_volatility
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Volatility bounds: [10.0, 90.0]
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 20:22:33 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 20:22:33 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 20:22:33 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 20:22:33 | INFO | __main__ |     - 1 direction classifier
2025-11-15 20:22:33 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 20:22:33 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 20:22:33 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================
2025-11-15 20:22:33 | INFO | __main__ | 
2025-11-15 20:22:33 | INFO | __main__ | 
================================================================================
2025-11-15 20:22:33 | INFO | __main__ | DATA PREPARATION
2025-11-15 20:22:33 | INFO | __main__ | ================================================================================
2025-11-15 20:22:33 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 20:22:33 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 20:22:33 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 20:22:33 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 20:22:38 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 20:22:38 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 20:22:38 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 20:22:38 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 20:22:38 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 20:22:38 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 20:22:38 | INFO | __main__ |   Cohort distribution:
2025-11-15 20:22:38 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 20:22:38 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 20:22:38 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 20:22:38 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 20:22:38 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 20:22:38 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 20:22:38 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 20:22:38 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 20:22:38 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 20:22:38 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 20:22:38 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 20:22:38 | INFO | __main__ | ================================================================================

2025-11-15 20:22:38 | INFO | __main__ | 
2025-11-15 20:22:38 | INFO | __main__ | ================================================================================
2025-11-15 20:22:38 | INFO | __main__ | MODEL TRAINING
2025-11-15 20:22:38 | INFO | __main__ | ================================================================================
2025-11-15 20:22:38 | INFO | __main__ | 
2025-11-15 20:22:38 | INFO | __main__ | Starting training...
2025-11-15 20:22:38 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 20:22:38 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 20:22:38 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 20:22:38 | INFO | __main__ | 
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:38 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:22:40 | INFO | core.xgboost_trainer_v3 |     q10: MAE=1.0856, var=0.3612
2025-11-15 20:22:41 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.9139, var=0.3283
2025-11-15 20:22:43 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.6182, var=0.2557
2025-11-15 20:22:45 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.5674, var=0.2676
2025-11-15 20:22:46 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4667, var=0.3086
2025-11-15 20:22:46 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:22:47 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 20:22:47 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:22:47 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:48 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:22:50 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.5758, var=0.3599
2025-11-15 20:22:51 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4625, var=0.2899
2025-11-15 20:22:54 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4877, var=0.2937
2025-11-15 20:22:55 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4910, var=0.2993
2025-11-15 20:22:57 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.6514, var=0.2919
2025-11-15 20:22:57 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:22:58 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 20:22:58 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:22:58 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3141, var=0.1913
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1789, var=0.1184
2025-11-15 20:22:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0243, var=0.0046
2025-11-15 20:23:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:00 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1008, var=0.0332
2025-11-15 20:23:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3284, var=0.1498
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2391, var=0.0602
2025-11-15 20:23:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:02 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0563, var=0.0106
2025-11-15 20:23:02 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:02 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0171, var=0.0036
2025-11-15 20:23:02 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1225, var=0.0497
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3291, var=0.1598
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:23:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6515, var=0.3134
2025-11-15 20:23:17 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4628, var=0.2994
2025-11-15 20:23:25 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.4513, var=0.3267
2025-11-15 20:23:32 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.4396, var=0.2987
2025-11-15 20:23:38 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4985, var=0.3083
2025-11-15 20:23:38 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:23:42 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 20:23:42 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:23:42 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:44 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:23:46 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6654, var=0.1864
2025-11-15 20:23:48 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.4371, var=0.1833
2025-11-15 20:23:50 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.3889, var=0.2171
2025-11-15 20:23:52 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3449, var=0.1869
2025-11-15 20:23:54 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.3578, var=0.1864
2025-11-15 20:23:54 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:23:55 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 20:23:55 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:23:55 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 20:23:56 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 20:23:58 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.6463, var=0.1538
2025-11-15 20:23:59 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.3719, var=0.1213
2025-11-15 20:24:02 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2959, var=0.1358
2025-11-15 20:24:04 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.3107, var=0.1338
2025-11-15 20:24:05 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.4314, var=0.1569
2025-11-15 20:24:05 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 20:24:06 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 20:24:06 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 20:24:06 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 20:24:07 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 20:24:07 | INFO | __main__ | 
================================================================================
2025-11-15 20:24:07 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 20:24:07 | INFO | __main__ | ================================================================================
2025-11-15 20:24:07 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 20:24:07 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 20:24:07 | INFO | __main__ |   Total models: 49
2025-11-15 20:24:07 | INFO | __main__ |   Feature count: 164
2025-11-15 20:24:07 | INFO | __main__ | 
  Cohorts:
2025-11-15 20:24:07 | INFO | __main__ |     - earnings_heavy
2025-11-15 20:24:07 | INFO | __main__ |     - fomc_minus_3
2025-11-15 20:24:07 | INFO | __main__ |     - fomc_week
2025-11-15 20:24:07 | INFO | __main__ |     - futures_rollover
2025-11-15 20:24:07 | INFO | __main__ |     - mid_cycle
2025-11-15 20:24:07 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 20:24:07 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 20:24:07 | INFO | __main__ | ================================================================================

2025-11-15 20:24:07 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_202407.json
2025-11-15 20:24:07 | INFO | __main__ | 
================================================================================
2025-11-15 20:24:07 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 20:24:07 | INFO | __main__ | ================================================================================
2025-11-15 20:24:07 | INFO | __main__ |   Models saved to: models/
2025-11-15 20:24:07 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 20:24:07 | INFO | __main__ | ================================================================================

2025-11-15 21:10:51 | INFO | __main__ | 
================================================================================
2025-11-15 21:10:51 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 21:10:51 | INFO | __main__ | ================================================================================
2025-11-15 21:10:51 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 21:10:51 | INFO | __main__ | Date: 2025-11-15 21:10:51
2025-11-15 21:10:51 | INFO | __main__ | Output: models
2025-11-15 21:10:51 | INFO | __main__ | ================================================================================

2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | ================================================================================
2025-11-15 21:10:51 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 21:10:51 | INFO | __main__ | ================================================================================
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 21:10:51 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 21:10:51 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 21:10:51 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 21:10:51 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 21:10:51 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 21:10:51 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 21:10:51 | INFO | __main__ |     - 1 direction classifier
2025-11-15 21:10:51 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 21:10:51 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 21:10:51 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 21:10:51 | INFO | __main__ | 
2025-11-15 21:10:51 | ERROR | __main__ | ❌ Configuration validation FAILED
2025-11-15 21:10:51 | ERROR | __main__ |    Please fix the following issues:
2025-11-15 21:10:51 | ERROR | __main__ |   ❌ Target type incorrect: vix_pct_change (expected 'log_realized_volatility')
2025-11-15 21:10:51 | ERROR | __main__ |   ❌ Volatility bounds missing
2025-11-15 21:10:51 | INFO | __main__ | ================================================================================
2025-11-15 21:10:51 | ERROR | __main__ | 
❌ Configuration validation failed:
  ❌ Target type incorrect: vix_pct_change (expected 'log_realized_volatility')
  ❌ Volatility bounds missing
2025-11-15 21:13:49 | INFO | __main__ | 
================================================================================
2025-11-15 21:13:49 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================
2025-11-15 21:13:49 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 21:13:49 | INFO | __main__ | Date: 2025-11-15 21:13:49
2025-11-15 21:13:49 | INFO | __main__ | Output: models
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================

2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================
2025-11-15 21:13:49 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 21:13:49 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 21:13:49 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 21:13:49 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 21:13:49 | INFO | __main__ |     - 1 direction classifier
2025-11-15 21:13:49 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 21:13:49 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 21:13:49 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================
2025-11-15 21:13:49 | INFO | __main__ | 
2025-11-15 21:13:49 | INFO | __main__ | 
================================================================================
2025-11-15 21:13:49 | INFO | __main__ | DATA PREPARATION
2025-11-15 21:13:49 | INFO | __main__ | ================================================================================
2025-11-15 21:13:49 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 21:13:49 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 21:13:49 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 21:13:49 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 21:13:52 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 21:13:52 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 21:13:52 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 21:13:52 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 21:13:52 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 21:13:52 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 21:13:52 | INFO | __main__ |   Cohort distribution:
2025-11-15 21:13:52 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 21:13:52 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 21:13:52 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 21:13:52 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 21:13:52 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 21:13:52 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 21:13:52 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 21:13:52 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 21:13:52 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 21:13:52 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 21:13:52 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 21:13:52 | INFO | __main__ | ================================================================================

2025-11-15 21:13:52 | INFO | __main__ | 
2025-11-15 21:13:52 | INFO | __main__ | ================================================================================
2025-11-15 21:13:52 | INFO | __main__ | MODEL TRAINING
2025-11-15 21:13:52 | INFO | __main__ | ================================================================================
2025-11-15 21:13:52 | INFO | __main__ | 
2025-11-15 21:13:52 | INFO | __main__ | Starting training...
2025-11-15 21:13:52 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 21:13:52 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 21:13:52 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 21:13:52 | INFO | __main__ | 
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:13:52 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:13:54 | INFO | core.xgboost_trainer_v3 |     q10: MAE=17.6094
2025-11-15 21:13:55 | INFO | core.xgboost_trainer_v3 |     q25: MAE=14.7455
2025-11-15 21:13:58 | INFO | core.xgboost_trainer_v3 |     q50: MAE=14.8133
2025-11-15 21:14:00 | INFO | core.xgboost_trainer_v3 |     q75: MAE=18.2409
2025-11-15 21:14:01 | INFO | core.xgboost_trainer_v3 |     q90: MAE=17.1957
2025-11-15 21:14:01 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:14:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 21:14:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:14:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:14:04 | INFO | core.xgboost_trainer_v3 |     q10: MAE=13.5178
2025-11-15 21:14:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.1661
2025-11-15 21:14:37 | INFO | __main__ | 
================================================================================
2025-11-15 21:14:37 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================
2025-11-15 21:14:37 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 21:14:37 | INFO | __main__ | Date: 2025-11-15 21:14:37
2025-11-15 21:14:37 | INFO | __main__ | Output: models
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================

2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================
2025-11-15 21:14:37 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 21:14:37 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 21:14:37 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 21:14:37 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 21:14:37 | INFO | __main__ |     - 1 direction classifier
2025-11-15 21:14:37 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 21:14:37 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 21:14:37 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================
2025-11-15 21:14:37 | INFO | __main__ | 
2025-11-15 21:14:37 | INFO | __main__ | 
================================================================================
2025-11-15 21:14:37 | INFO | __main__ | DATA PREPARATION
2025-11-15 21:14:37 | INFO | __main__ | ================================================================================
2025-11-15 21:14:37 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 21:14:37 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 21:14:37 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 21:14:37 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 21:14:44 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 21:14:44 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 21:14:44 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 21:14:44 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 21:14:44 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 21:14:44 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 21:14:44 | INFO | __main__ |   Cohort distribution:
2025-11-15 21:14:44 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 21:14:44 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 21:14:44 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 21:14:44 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 21:14:44 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 21:14:44 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 21:14:44 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 21:14:44 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 21:14:44 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 21:14:44 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 21:14:44 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 21:14:44 | INFO | __main__ | ================================================================================

2025-11-15 21:14:44 | INFO | __main__ | 
2025-11-15 21:14:44 | INFO | __main__ | ================================================================================
2025-11-15 21:14:44 | INFO | __main__ | MODEL TRAINING
2025-11-15 21:14:44 | INFO | __main__ | ================================================================================
2025-11-15 21:14:44 | INFO | __main__ | 
2025-11-15 21:14:44 | INFO | __main__ | Starting training...
2025-11-15 21:14:44 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 21:14:44 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 21:14:44 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 21:14:44 | INFO | __main__ | 
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:44 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:14:45 | INFO | core.xgboost_trainer_v3 |     q10: MAE=17.6094
2025-11-15 21:14:47 | INFO | core.xgboost_trainer_v3 |     q25: MAE=14.7455
2025-11-15 21:14:49 | INFO | core.xgboost_trainer_v3 |     q50: MAE=14.8133
2025-11-15 21:14:51 | INFO | core.xgboost_trainer_v3 |     q75: MAE=18.2409
2025-11-15 21:14:52 | INFO | core.xgboost_trainer_v3 |     q90: MAE=17.1957
2025-11-15 21:14:52 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:14:53 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-15 21:14:53 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:14:53 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:14:54 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:14:56 | INFO | core.xgboost_trainer_v3 |     q10: MAE=13.5178
2025-11-15 21:14:58 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.1661
2025-11-15 21:15:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=14.7144
2025-11-15 21:15:02 | INFO | core.xgboost_trainer_v3 |     q75: MAE=19.1108
2025-11-15 21:15:03 | INFO | core.xgboost_trainer_v3 |     q90: MAE=25.1851
2025-11-15 21:15:03 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:15:04 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-15 21:15:04 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:15:04 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.6625
2025-11-15 21:15:05 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=5.2132
2025-11-15 21:15:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:06 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.7506
2025-11-15 21:15:06 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |     q75: MAE=6.0423
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |     q90: MAE=12.4842
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:15:07 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |     q10: MAE=10.9125
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |     q25: MAE=5.8569
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |     q50: MAE=1.1010
2025-11-15 21:15:08 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |     q75: MAE=2.5472
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |     q90: MAE=5.8954
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-15 21:15:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-15 21:15:10 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-15 21:15:10 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:10 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-15 21:15:10 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:10 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:15:15 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.9522
2025-11-15 21:15:22 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.0476
2025-11-15 21:15:30 | INFO | core.xgboost_trainer_v3 |     q50: MAE=9.5583
2025-11-15 21:15:37 | INFO | core.xgboost_trainer_v3 |     q75: MAE=11.2135
2025-11-15 21:15:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=13.2909
2025-11-15 21:15:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:15:47 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-15 21:15:47 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:15:47 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:15:49 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:15:50 | INFO | core.xgboost_trainer_v3 |     q10: MAE=12.7405
2025-11-15 21:15:52 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.8527
2025-11-15 21:15:55 | INFO | core.xgboost_trainer_v3 |     q50: MAE=17.1982
2025-11-15 21:15:57 | INFO | core.xgboost_trainer_v3 |     q75: MAE=33.1003
2025-11-15 21:15:59 | INFO | core.xgboost_trainer_v3 |     q90: MAE=34.7106
2025-11-15 21:15:59 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:16:00 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-15 21:16:00 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:16:00 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 21:16:01 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-15 21:16:02 | INFO | core.xgboost_trainer_v3 |     q10: MAE=15.5321
2025-11-15 21:16:04 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.6677
2025-11-15 21:16:07 | INFO | core.xgboost_trainer_v3 |     q50: MAE=13.0722
2025-11-15 21:16:08 | INFO | core.xgboost_trainer_v3 |     q75: MAE=23.7722
2025-11-15 21:16:10 | INFO | core.xgboost_trainer_v3 |     q90: MAE=37.7788
2025-11-15 21:16:10 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-15 21:16:11 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-15 21:16:11 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-15 21:16:11 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-15 21:16:12 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 21:16:12 | INFO | __main__ | 
================================================================================
2025-11-15 21:16:12 | INFO | __main__ | TRAINING SUMMARY
2025-11-15 21:16:12 | INFO | __main__ | ================================================================================
2025-11-15 21:16:12 | INFO | __main__ |   Cohorts trained: 7
2025-11-15 21:16:12 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-15 21:16:12 | INFO | __main__ |   Total models: 49
2025-11-15 21:16:12 | INFO | __main__ |   Feature count: 164
2025-11-15 21:16:12 | INFO | __main__ | 
  Cohorts:
2025-11-15 21:16:12 | INFO | __main__ |     - earnings_heavy
2025-11-15 21:16:12 | INFO | __main__ |     - fomc_minus_3
2025-11-15 21:16:12 | INFO | __main__ |     - fomc_week
2025-11-15 21:16:12 | INFO | __main__ |     - futures_rollover
2025-11-15 21:16:12 | INFO | __main__ |     - mid_cycle
2025-11-15 21:16:12 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-15 21:16:12 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-15 21:16:12 | INFO | __main__ | ================================================================================

2025-11-15 21:16:12 | INFO | __main__ | ✅ Training report saved: models/training_report_20251115_211612.json
2025-11-15 21:16:12 | INFO | __main__ | 
================================================================================
2025-11-15 21:16:12 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-15 21:16:12 | INFO | __main__ | ================================================================================
2025-11-15 21:16:12 | INFO | __main__ |   Models saved to: models/
2025-11-15 21:16:12 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-15 21:16:12 | INFO | __main__ | ================================================================================

2025-11-15 23:54:46 | INFO | __main__ | 
================================================================================
2025-11-15 23:54:46 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================
2025-11-15 23:54:46 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 23:54:46 | INFO | __main__ | Date: 2025-11-15 23:54:46
2025-11-15 23:54:46 | INFO | __main__ | Output: models
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================

2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================
2025-11-15 23:54:46 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 23:54:46 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 23:54:46 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 23:54:46 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 23:54:46 | INFO | __main__ |     - 1 direction classifier
2025-11-15 23:54:46 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 23:54:46 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 23:54:46 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================
2025-11-15 23:54:46 | INFO | __main__ | 
2025-11-15 23:54:46 | INFO | __main__ | 
================================================================================
2025-11-15 23:54:46 | INFO | __main__ | DATA PREPARATION
2025-11-15 23:54:46 | INFO | __main__ | ================================================================================
2025-11-15 23:54:46 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 23:54:46 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 23:54:46 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 23:54:46 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 23:54:48 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 23:54:48 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 23:54:48 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 23:54:48 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 23:54:48 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 23:54:48 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 23:54:48 | INFO | __main__ |   Cohort distribution:
2025-11-15 23:54:48 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 23:54:48 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 23:54:48 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 23:54:48 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 23:54:48 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 23:54:48 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 23:54:48 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 23:54:48 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 23:54:48 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 23:54:48 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 23:54:48 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 23:54:48 | INFO | __main__ | ================================================================================

2025-11-15 23:54:48 | INFO | __main__ | 
2025-11-15 23:54:48 | INFO | __main__ | ================================================================================
2025-11-15 23:54:48 | INFO | __main__ | MODEL TRAINING
2025-11-15 23:54:48 | INFO | __main__ | ================================================================================
2025-11-15 23:54:48 | INFO | __main__ | 
2025-11-15 23:54:48 | INFO | __main__ | Starting training...
2025-11-15 23:54:48 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 23:54:48 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 23:54:48 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 23:54:48 | INFO | __main__ | 
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 23:54:48 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 23:54:48 | ERROR | __main__ | 
❌ Training failed with error: 'target_log_rv'
2025-11-15 23:55:38 | INFO | __main__ | 
================================================================================
2025-11-15 23:55:38 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================
2025-11-15 23:55:38 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-15 23:55:38 | INFO | __main__ | Date: 2025-11-15 23:55:38
2025-11-15 23:55:38 | INFO | __main__ | Output: models
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================

2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================
2025-11-15 23:55:38 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Point estimate removed
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-15 23:55:38 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-15 23:55:38 | INFO | __main__ |   Expected models per cohort: 7
2025-11-15 23:55:38 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-15 23:55:38 | INFO | __main__ |     - 1 direction classifier
2025-11-15 23:55:38 | INFO | __main__ |     - 1 confidence scorer
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-15 23:55:38 | INFO | __main__ |   ✅ Confidence model configured
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-15 23:55:38 | INFO | __main__ |    All checks successful - ready to train
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================
2025-11-15 23:55:38 | INFO | __main__ | 
2025-11-15 23:55:38 | INFO | __main__ | 
================================================================================
2025-11-15 23:55:38 | INFO | __main__ | DATA PREPARATION
2025-11-15 23:55:38 | INFO | __main__ | ================================================================================
2025-11-15 23:55:38 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-15 23:55:38 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-15 23:55:38 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-15 23:55:38 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-15 23:55:43 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-15 23:55:43 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-15 23:55:43 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-15 23:55:43 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-15 23:55:43 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-15 23:55:43 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-15 23:55:43 | INFO | __main__ |   Cohort distribution:
2025-11-15 23:55:43 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-15 23:55:43 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-15 23:55:43 | INFO | __main__ |     fomc_week: 37 samples
2025-11-15 23:55:43 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-15 23:55:43 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-15 23:55:43 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-15 23:55:43 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-15 23:55:43 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-15 23:55:43 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-15 23:55:43 | INFO | __main__ | 
✅ Data preparation complete
2025-11-15 23:55:43 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-15 23:55:43 | INFO | __main__ | ================================================================================

2025-11-15 23:55:43 | INFO | __main__ | 
2025-11-15 23:55:43 | INFO | __main__ | ================================================================================
2025-11-15 23:55:43 | INFO | __main__ | MODEL TRAINING
2025-11-15 23:55:43 | INFO | __main__ | ================================================================================
2025-11-15 23:55:43 | INFO | __main__ | 
2025-11-15 23:55:43 | INFO | __main__ | Starting training...
2025-11-15 23:55:43 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-15 23:55:43 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-15 23:55:43 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-15 23:55:43 | INFO | __main__ | 
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | 
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-15 23:55:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-15 23:55:43 | ERROR | __main__ | 
❌ Training failed with error: 'target_log_rv'
2025-11-16 00:09:31 | INFO | __main__ | 
================================================================================
2025-11-16 00:09:31 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================
2025-11-16 00:09:31 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 00:09:31 | INFO | __main__ | Date: 2025-11-16 00:09:31
2025-11-16 00:09:31 | INFO | __main__ | Output: models
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================

2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================
2025-11-16 00:09:31 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 00:09:31 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 00:09:31 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 00:09:31 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 00:09:31 | INFO | __main__ |     - 1 direction classifier
2025-11-16 00:09:31 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 00:09:31 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 00:09:31 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================
2025-11-16 00:09:31 | INFO | __main__ | 
2025-11-16 00:09:31 | INFO | __main__ | 
================================================================================
2025-11-16 00:09:31 | INFO | __main__ | DATA PREPARATION
2025-11-16 00:09:31 | INFO | __main__ | ================================================================================
2025-11-16 00:09:31 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 00:09:31 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 00:09:31 | INFO | __main__ |   Target period: 3 years ending 2022-12-31
2025-11-16 00:09:31 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 00:09:37 | INFO | __main__ | 
  Features created: 168
  Date range: 2018-10-08 to 2022-12-30
  Total samples: 1066
2025-11-16 00:09:37 | INFO | __main__ |   Usable training samples (after warmup): 616
2025-11-16 00:09:37 | INFO | __main__ |   Effective training period: 2020-07-23 to 2022-12-30
2025-11-16 00:09:37 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 00:09:37 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 00:09:37 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 00:09:37 | INFO | __main__ |   Cohort distribution:
2025-11-16 00:09:37 | INFO | __main__ |     earnings_heavy: 90 samples
2025-11-16 00:09:37 | INFO | __main__ |     fomc_minus_3: 116 samples
2025-11-16 00:09:37 | INFO | __main__ |     fomc_week: 37 samples
2025-11-16 00:09:37 | INFO | __main__ |     futures_rollover: 46 samples
2025-11-16 00:09:37 | INFO | __main__ |     mid_cycle: 529 samples
2025-11-16 00:09:37 | INFO | __main__ |     monthly_opex_minus_1: 133 samples
2025-11-16 00:09:37 | INFO | __main__ |     monthly_opex_minus_5: 115 samples
2025-11-16 00:09:37 | INFO | __main__ | 
  Final dataframe shape: (1066, 169)
2025-11-16 00:09:37 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 00:09:37 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 00:09:37 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 00:09:37 | INFO | __main__ | ================================================================================

2025-11-16 00:09:37 | INFO | __main__ | 
2025-11-16 00:09:37 | INFO | __main__ | ================================================================================
2025-11-16 00:09:37 | INFO | __main__ | MODEL TRAINING
2025-11-16 00:09:37 | INFO | __main__ | ================================================================================
2025-11-16 00:09:37 | INFO | __main__ | 
2025-11-16 00:09:37 | INFO | __main__ | Starting training...
2025-11-16 00:09:37 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 00:09:37 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 00:09:37 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 00:09:37 | INFO | __main__ | 
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 |     Total samples: 1066
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 |     Valid targets: 1061
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (90 samples)
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:09:38 | INFO | core.xgboost_trainer_v3 |     q10: MAE=17.6094
2025-11-16 00:09:40 | INFO | core.xgboost_trainer_v3 |     q25: MAE=14.7455
2025-11-16 00:09:42 | INFO | core.xgboost_trainer_v3 |     q50: MAE=14.8133
2025-11-16 00:09:44 | INFO | core.xgboost_trainer_v3 |     q75: MAE=18.2409
2025-11-16 00:09:45 | INFO | core.xgboost_trainer_v3 |     q90: MAE=17.1957
2025-11-16 00:09:45 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 90 samples...
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |       q10: 10.0% coverage (target 10.0%)
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |       q25: 13.3% coverage (target 25.0%)
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |       q50: 40.0% coverage (target 50.0%)
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |       q75: 93.3% coverage (target 75.0%)
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |       q90: 98.9% coverage (target 90.0%)
2025-11-16 00:09:45 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:09:45 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:09:45 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:09:46 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.521
2025-11-16 00:09:46 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:09:46 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.031
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (116 samples)
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:47 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:09:49 | INFO | core.xgboost_trainer_v3 |     q10: MAE=13.5178
2025-11-16 00:09:51 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.1661
2025-11-16 00:09:53 | INFO | core.xgboost_trainer_v3 |     q50: MAE=14.7144
2025-11-16 00:09:55 | INFO | core.xgboost_trainer_v3 |     q75: MAE=19.1108
2025-11-16 00:09:56 | INFO | core.xgboost_trainer_v3 |     q90: MAE=25.1851
2025-11-16 00:09:56 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 116 samples...
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |       q10: 4.3% coverage (target 10.0%)
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |       q25: 9.5% coverage (target 25.0%)
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |       q50: 34.5% coverage (target 50.0%)
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |       q75: 93.1% coverage (target 75.0%)
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |       q90: 93.1% coverage (target 90.0%)
2025-11-16 00:09:56 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:09:56 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:09:56 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:09:57 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.450
2025-11-16 00:09:57 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:09:57 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.024
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (37 samples)
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:09:58 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.6625
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |     q25: MAE=5.2132
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.7506
2025-11-16 00:09:59 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |     q75: MAE=6.0423
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |     q90: MAE=12.4842
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 37 samples...
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |       q10: 18.9% coverage (target 10.0%)
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |       q25: 8.1% coverage (target 25.0%)
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |       q50: 64.9% coverage (target 50.0%)
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |       q75: 97.3% coverage (target 75.0%)
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |       q90: 89.2% coverage (target 90.0%)
2025-11-16 00:10:00 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.973
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.019
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (46 samples)
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:10:00 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |     q10: MAE=10.9125
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |     q25: MAE=5.8569
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |     q50: MAE=1.1010
2025-11-16 00:10:01 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |     q75: MAE=2.5472
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |     q90: MAE=5.8954
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 46 samples...
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |       q10: 2.2% coverage (target 10.0%)
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |       q25: 4.3% coverage (target 25.0%)
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |       q50: 32.6% coverage (target 50.0%)
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |       q75: 80.4% coverage (target 75.0%)
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |       q90: 84.8% coverage (target 90.0%)
2025-11-16 00:10:02 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.957
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:10:02 | INFO | core.xgboost_trainer_v3 |       Small cohort - training on all data without CV
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (529 samples)
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:03 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:10:08 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.9522
2025-11-16 00:10:16 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.0476
2025-11-16 00:10:23 | INFO | core.xgboost_trainer_v3 |     q50: MAE=9.5583
2025-11-16 00:10:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=11.2135
2025-11-16 00:10:36 | INFO | core.xgboost_trainer_v3 |     q90: MAE=13.2909
2025-11-16 00:10:36 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 524 samples...
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |       q10: 5.9% coverage (target 10.0%)
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |       q25: 16.4% coverage (target 25.0%)
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |       q50: 44.1% coverage (target 50.0%)
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |       q75: 86.3% coverage (target 75.0%)
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |       q90: 95.2% coverage (target 90.0%)
2025-11-16 00:10:36 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:10:36 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:10:36 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:10:40 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.595
2025-11-16 00:10:40 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:10:40 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (133 samples)
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:42 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:10:43 | INFO | core.xgboost_trainer_v3 |     q10: MAE=12.7405
2025-11-16 00:10:46 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.8527
2025-11-16 00:10:48 | INFO | core.xgboost_trainer_v3 |     q50: MAE=17.1982
2025-11-16 00:10:50 | INFO | core.xgboost_trainer_v3 |     q75: MAE=33.1003
2025-11-16 00:10:52 | INFO | core.xgboost_trainer_v3 |     q90: MAE=34.7106
2025-11-16 00:10:52 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 133 samples...
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |       q10: 9.8% coverage (target 10.0%)
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |       q25: 14.3% coverage (target 25.0%)
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |       q50: 26.3% coverage (target 50.0%)
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |       q75: 77.4% coverage (target 75.0%)
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |       q90: 96.2% coverage (target 90.0%)
2025-11-16 00:10:52 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:10:52 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:10:52 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:10:53 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.471
2025-11-16 00:10:53 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:10:53 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.023
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (115 samples)
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 00:10:54 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 00:10:55 | INFO | core.xgboost_trainer_v3 |     q10: MAE=15.5321
2025-11-16 00:10:57 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.6677
2025-11-16 00:11:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=13.0722
2025-11-16 00:11:02 | INFO | core.xgboost_trainer_v3 |     q75: MAE=23.7722
2025-11-16 00:11:03 | INFO | core.xgboost_trainer_v3 |     q90: MAE=37.7788
2025-11-16 00:11:03 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |       q10: 0.9% coverage (target 10.0%)
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |       q25: 14.8% coverage (target 25.0%)
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |       q50: 21.7% coverage (target 50.0%)
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |       q75: 87.8% coverage (target 75.0%)
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |       q90: 96.5% coverage (target 90.0%)
2025-11-16 00:11:03 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 00:11:03 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 00:11:03 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 00:11:04 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.567
2025-11-16 00:11:04 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 00:11:04 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 00:11:05 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.022
2025-11-16 00:11:05 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-16 00:11:05 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-16 00:11:06 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-16 00:11:06 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-16 00:11:06 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-16 00:11:06 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 00:11:06 | INFO | __main__ | 
================================================================================
2025-11-16 00:11:06 | INFO | __main__ | TRAINING SUMMARY
2025-11-16 00:11:06 | INFO | __main__ | ================================================================================
2025-11-16 00:11:06 | INFO | __main__ |   Cohorts trained: 7
2025-11-16 00:11:06 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-16 00:11:06 | INFO | __main__ |   Total models: 49
2025-11-16 00:11:06 | INFO | __main__ |   Feature count: 164
2025-11-16 00:11:06 | INFO | __main__ | 
  Cohorts:
2025-11-16 00:11:06 | INFO | __main__ |     - earnings_heavy
2025-11-16 00:11:06 | INFO | __main__ |     - fomc_minus_3
2025-11-16 00:11:06 | INFO | __main__ |     - fomc_week
2025-11-16 00:11:06 | INFO | __main__ |     - futures_rollover
2025-11-16 00:11:06 | INFO | __main__ |     - mid_cycle
2025-11-16 00:11:06 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-16 00:11:06 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-16 00:11:06 | INFO | __main__ | ================================================================================

2025-11-16 00:11:06 | INFO | __main__ | ✅ Training report saved: models/training_report_20251116_001106.json
2025-11-16 00:11:06 | INFO | __main__ | 
================================================================================
2025-11-16 00:11:06 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-16 00:11:06 | INFO | __main__ | ================================================================================
2025-11-16 00:11:06 | INFO | __main__ |   Models saved to: models/
2025-11-16 00:11:06 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-16 00:11:06 | INFO | __main__ | ================================================================================

2025-11-16 21:18:50 | INFO | __main__ | 
================================================================================
2025-11-16 21:18:50 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================
2025-11-16 21:18:50 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 21:18:50 | INFO | __main__ | Date: 2025-11-16 21:18:50
2025-11-16 21:18:50 | INFO | __main__ | Output: models
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================

2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================
2025-11-16 21:18:50 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 21:18:50 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 21:18:50 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 21:18:50 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 21:18:50 | INFO | __main__ |     - 1 direction classifier
2025-11-16 21:18:50 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 21:18:50 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 21:18:50 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================
2025-11-16 21:18:50 | INFO | __main__ | 
2025-11-16 21:18:50 | INFO | __main__ | 
================================================================================
2025-11-16 21:18:50 | INFO | __main__ | DATA PREPARATION
2025-11-16 21:18:50 | INFO | __main__ | ================================================================================
2025-11-16 21:18:50 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 21:18:50 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 21:18:50 | INFO | __main__ |   Target period: 20 years ending 2022-12-31
2025-11-16 21:18:50 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 21:18:59 | INFO | __main__ | 
  Features created: 168
  Date range: 2001-10-12 to 2022-12-30
  Total samples: 5342
2025-11-16 21:18:59 | INFO | __main__ |   Usable training samples (after warmup): 4892
2025-11-16 21:18:59 | INFO | __main__ |   Effective training period: 2003-07-29 to 2022-12-30
2025-11-16 21:18:59 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 21:18:59 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 21:18:59 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 21:18:59 | INFO | __main__ |   Cohort distribution:
2025-11-16 21:18:59 | INFO | __main__ |     earnings_heavy: 532 samples
2025-11-16 21:18:59 | INFO | __main__ |     fomc_minus_3: 349 samples
2025-11-16 21:18:59 | INFO | __main__ |     fomc_week: 115 samples
2025-11-16 21:18:59 | INFO | __main__ |     futures_rollover: 233 samples
2025-11-16 21:18:59 | INFO | __main__ |     mid_cycle: 2776 samples
2025-11-16 21:18:59 | INFO | __main__ |     monthly_opex_minus_1: 703 samples
2025-11-16 21:18:59 | INFO | __main__ |     monthly_opex_minus_5: 634 samples
2025-11-16 21:18:59 | INFO | __main__ | 
  Final dataframe shape: (5342, 169)
2025-11-16 21:18:59 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 21:18:59 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 21:18:59 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 21:18:59 | INFO | __main__ | ================================================================================

2025-11-16 21:18:59 | INFO | __main__ | 
2025-11-16 21:18:59 | INFO | __main__ | ================================================================================
2025-11-16 21:18:59 | INFO | __main__ | MODEL TRAINING
2025-11-16 21:18:59 | INFO | __main__ | ================================================================================
2025-11-16 21:18:59 | INFO | __main__ | 
2025-11-16 21:18:59 | INFO | __main__ | Starting training...
2025-11-16 21:18:59 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 21:18:59 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 21:18:59 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 21:18:59 | INFO | __main__ | 
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 |     Total samples: 5342
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 |     Valid targets: 5337
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (532 samples)
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:18:59 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:19:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.5094
2025-11-16 21:19:12 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.6205
2025-11-16 21:19:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.5393
2025-11-16 21:19:27 | INFO | core.xgboost_trainer_v3 |     q75: MAE=13.8999
2025-11-16 21:19:34 | INFO | core.xgboost_trainer_v3 |     q90: MAE=15.4492
2025-11-16 21:19:34 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 532 samples...
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |       q10: 3.0% coverage (target 10.0%)
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |       q25: 12.4% coverage (target 25.0%)
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |       q50: 38.5% coverage (target 50.0%)
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |       q75: 80.8% coverage (target 75.0%)
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |       q90: 96.1% coverage (target 90.0%)
2025-11-16 21:19:34 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:19:34 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:19:34 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:19:37 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.637
2025-11-16 21:19:37 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:19:37 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (349 samples)
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:19:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:19:43 | INFO | core.xgboost_trainer_v3 |     q10: MAE=17.4591
2025-11-16 21:19:47 | INFO | core.xgboost_trainer_v3 |     q25: MAE=15.2076
2025-11-16 21:19:52 | INFO | core.xgboost_trainer_v3 |     q50: MAE=15.1794
2025-11-16 21:19:56 | INFO | core.xgboost_trainer_v3 |     q75: MAE=17.7175
2025-11-16 21:20:00 | INFO | core.xgboost_trainer_v3 |     q90: MAE=22.0206
2025-11-16 21:20:00 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 349 samples...
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |       q10: 7.7% coverage (target 10.0%)
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |       q25: 12.9% coverage (target 25.0%)
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |       q50: 42.1% coverage (target 50.0%)
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |       q75: 89.1% coverage (target 75.0%)
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |       q90: 94.3% coverage (target 90.0%)
2025-11-16 21:20:00 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:20:00 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:20:00 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:20:02 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.618
2025-11-16 21:20:02 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:20:02 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.020
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (115 samples)
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:04 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:20:05 | INFO | core.xgboost_trainer_v3 |     q10: MAE=14.7365
2025-11-16 21:20:07 | INFO | core.xgboost_trainer_v3 |     q25: MAE=13.8287
2025-11-16 21:20:09 | INFO | core.xgboost_trainer_v3 |     q50: MAE=13.9826
2025-11-16 21:20:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=16.3797
2025-11-16 21:20:12 | INFO | core.xgboost_trainer_v3 |     q90: MAE=18.0173
2025-11-16 21:20:12 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |       q10: 1.7% coverage (target 10.0%)
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |       q25: 8.7% coverage (target 25.0%)
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |       q50: 56.5% coverage (target 50.0%)
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |       q75: 87.0% coverage (target 75.0%)
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |       q90: 98.3% coverage (target 90.0%)
2025-11-16 21:20:12 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:20:12 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:20:12 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:20:13 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.517
2025-11-16 21:20:13 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:20:13 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (233 samples)
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:14 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:20:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.6113
2025-11-16 21:20:21 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.6665
2025-11-16 21:20:25 | INFO | core.xgboost_trainer_v3 |     q50: MAE=10.8033
2025-11-16 21:20:29 | INFO | core.xgboost_trainer_v3 |     q75: MAE=12.4293
2025-11-16 21:20:32 | INFO | core.xgboost_trainer_v3 |     q90: MAE=14.0373
2025-11-16 21:20:32 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 233 samples...
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |       q10: 4.3% coverage (target 10.0%)
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |       q25: 10.7% coverage (target 25.0%)
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |       q50: 56.2% coverage (target 50.0%)
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |       q75: 90.6% coverage (target 75.0%)
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |       q90: 98.3% coverage (target 90.0%)
2025-11-16 21:20:32 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:20:32 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:20:32 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:20:34 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-16 21:20:34 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:20:34 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (2776 samples)
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:20:35 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:20:47 | INFO | core.xgboost_trainer_v3 |     q10: MAE=12.4650
2025-11-16 21:21:02 | INFO | core.xgboost_trainer_v3 |     q25: MAE=11.4466
2025-11-16 21:21:16 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.5464
2025-11-16 21:21:32 | INFO | core.xgboost_trainer_v3 |     q75: MAE=14.9850
2025-11-16 21:21:47 | INFO | __main__ | 
================================================================================
2025-11-16 21:21:47 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================
2025-11-16 21:21:47 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 21:21:47 | INFO | __main__ | Date: 2025-11-16 21:21:47
2025-11-16 21:21:47 | INFO | __main__ | Output: models
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================

2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================
2025-11-16 21:21:47 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Target type correct: vix_pct_change
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 21:21:47 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 21:21:47 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 21:21:47 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 21:21:47 | INFO | __main__ |     - 1 direction classifier
2025-11-16 21:21:47 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 21:21:47 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 21:21:47 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================
2025-11-16 21:21:47 | INFO | __main__ | 
2025-11-16 21:21:47 | INFO | __main__ | 
================================================================================
2025-11-16 21:21:47 | INFO | __main__ | DATA PREPARATION
2025-11-16 21:21:47 | INFO | __main__ | ================================================================================
2025-11-16 21:21:47 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 21:21:47 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 21:21:47 | INFO | __main__ |   Target period: 20 years ending 2022-12-31
2025-11-16 21:21:47 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 21:21:57 | INFO | __main__ | 
  Features created: 168
  Date range: 2001-10-12 to 2022-12-30
  Total samples: 5342
2025-11-16 21:21:57 | INFO | __main__ |   Usable training samples (after warmup): 4892
2025-11-16 21:21:57 | INFO | __main__ |   Effective training period: 2003-07-29 to 2022-12-30
2025-11-16 21:21:57 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 21:21:57 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 21:21:57 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 21:21:57 | INFO | __main__ |   Cohort distribution:
2025-11-16 21:21:57 | INFO | __main__ |     earnings_heavy: 532 samples
2025-11-16 21:21:57 | INFO | __main__ |     fomc_minus_3: 349 samples
2025-11-16 21:21:57 | INFO | __main__ |     fomc_week: 115 samples
2025-11-16 21:21:57 | INFO | __main__ |     futures_rollover: 233 samples
2025-11-16 21:21:57 | INFO | __main__ |     mid_cycle: 2776 samples
2025-11-16 21:21:57 | INFO | __main__ |     monthly_opex_minus_1: 703 samples
2025-11-16 21:21:57 | INFO | __main__ |     monthly_opex_minus_5: 634 samples
2025-11-16 21:21:57 | INFO | __main__ | 
  Final dataframe shape: (5342, 169)
2025-11-16 21:21:57 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 21:21:57 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 21:21:57 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 21:21:57 | INFO | __main__ | ================================================================================

2025-11-16 21:21:57 | INFO | __main__ | 
2025-11-16 21:21:57 | INFO | __main__ | ================================================================================
2025-11-16 21:21:57 | INFO | __main__ | MODEL TRAINING
2025-11-16 21:21:57 | INFO | __main__ | ================================================================================
2025-11-16 21:21:57 | INFO | __main__ | 
2025-11-16 21:21:57 | INFO | __main__ | Starting training...
2025-11-16 21:21:57 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 21:21:57 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 21:21:57 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 21:21:57 | INFO | __main__ | 
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 |     Total samples: 5342
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 |     Valid targets: 5337
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (532 samples)
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:21:57 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:22:04 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.5094
2025-11-16 21:22:11 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.6205
2025-11-16 21:22:19 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.5393
2025-11-16 21:22:26 | INFO | core.xgboost_trainer_v3 |     q75: MAE=13.8999
2025-11-16 21:22:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=15.4492
2025-11-16 21:22:33 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 532 samples...
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |       q10: 3.0% coverage (target 10.0%)
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |       q25: 12.4% coverage (target 25.0%)
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |       q50: 38.5% coverage (target 50.0%)
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |       q75: 80.8% coverage (target 75.0%)
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |       q90: 96.1% coverage (target 90.0%)
2025-11-16 21:22:33 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:22:33 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:22:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:22:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.637
2025-11-16 21:22:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:22:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (349 samples)
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:22:38 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:22:44 | INFO | core.xgboost_trainer_v3 |     q10: MAE=17.4591
2025-11-16 21:22:48 | INFO | core.xgboost_trainer_v3 |     q25: MAE=15.2076
2025-11-16 21:22:53 | INFO | core.xgboost_trainer_v3 |     q50: MAE=15.1794
2025-11-16 21:22:58 | INFO | core.xgboost_trainer_v3 |     q75: MAE=17.7175
2025-11-16 21:23:01 | INFO | core.xgboost_trainer_v3 |     q90: MAE=22.0206
2025-11-16 21:23:01 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 349 samples...
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |       q10: 7.7% coverage (target 10.0%)
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |       q25: 12.9% coverage (target 25.0%)
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |       q50: 42.1% coverage (target 50.0%)
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |       q75: 89.1% coverage (target 75.0%)
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |       q90: 94.3% coverage (target 90.0%)
2025-11-16 21:23:01 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:23:01 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:23:01 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:23:04 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.618
2025-11-16 21:23:04 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:23:04 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.020
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (115 samples)
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:05 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:23:06 | INFO | core.xgboost_trainer_v3 |     q10: MAE=14.7365
2025-11-16 21:23:08 | INFO | core.xgboost_trainer_v3 |     q25: MAE=13.8287
2025-11-16 21:23:10 | INFO | core.xgboost_trainer_v3 |     q50: MAE=13.9826
2025-11-16 21:23:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=16.3797
2025-11-16 21:23:13 | INFO | core.xgboost_trainer_v3 |     q90: MAE=18.0173
2025-11-16 21:23:13 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |       q10: 1.7% coverage (target 10.0%)
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |       q25: 8.7% coverage (target 25.0%)
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |       q50: 56.5% coverage (target 50.0%)
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |       q75: 87.0% coverage (target 75.0%)
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |       q90: 98.3% coverage (target 90.0%)
2025-11-16 21:23:13 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:23:13 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:23:13 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.517
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (233 samples)
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:15 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:23:18 | INFO | core.xgboost_trainer_v3 |     q10: MAE=11.6113
2025-11-16 21:23:22 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.6665
2025-11-16 21:23:27 | INFO | core.xgboost_trainer_v3 |     q50: MAE=10.8033
2025-11-16 21:23:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=12.4293
2025-11-16 21:23:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=14.0373
2025-11-16 21:23:33 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 233 samples...
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |       q10: 4.3% coverage (target 10.0%)
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |       q25: 10.7% coverage (target 25.0%)
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |       q50: 56.2% coverage (target 50.0%)
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |       q75: 90.6% coverage (target 75.0%)
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |       q90: 98.3% coverage (target 90.0%)
2025-11-16 21:23:33 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:23:33 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:23:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:23:35 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-16 21:23:35 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:23:35 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (2776 samples)
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:23:36 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:23:49 | INFO | core.xgboost_trainer_v3 |     q10: MAE=12.4650
2025-11-16 21:24:03 | INFO | core.xgboost_trainer_v3 |     q25: MAE=11.4466
2025-11-16 21:24:17 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.5464
2025-11-16 21:24:31 | INFO | core.xgboost_trainer_v3 |     q75: MAE=14.9850
2025-11-16 21:24:43 | INFO | core.xgboost_trainer_v3 |     q90: MAE=19.5876
2025-11-16 21:24:43 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 2771 samples...
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |       q10: 7.8% coverage (target 10.0%)
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |       q25: 26.0% coverage (target 25.0%)
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |       q50: 47.6% coverage (target 50.0%)
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |       q75: 77.0% coverage (target 75.0%)
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |       q90: 92.0% coverage (target 90.0%)
2025-11-16 21:24:43 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:24:43 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:24:43 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:24:54 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.569
2025-11-16 21:24:54 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:24:54 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.013
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (703 samples)
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:24:59 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:25:09 | INFO | core.xgboost_trainer_v3 |     q10: MAE=12.1251
2025-11-16 21:25:19 | INFO | core.xgboost_trainer_v3 |     q25: MAE=10.9616
2025-11-16 21:25:30 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.1644
2025-11-16 21:25:39 | INFO | core.xgboost_trainer_v3 |     q75: MAE=15.7910
2025-11-16 21:25:46 | INFO | core.xgboost_trainer_v3 |     q90: MAE=20.0851
2025-11-16 21:25:46 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 703 samples...
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |       q10: 7.7% coverage (target 10.0%)
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |       q25: 15.4% coverage (target 25.0%)
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |       q50: 43.8% coverage (target 50.0%)
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |       q75: 83.2% coverage (target 75.0%)
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |       q90: 94.9% coverage (target 90.0%)
2025-11-16 21:25:46 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:25:46 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:25:46 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:25:51 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.623
2025-11-16 21:25:51 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:25:51 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (634 samples)
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 21:25:53 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 21:25:59 | INFO | core.xgboost_trainer_v3 |     q10: MAE=13.2031
2025-11-16 21:26:07 | INFO | core.xgboost_trainer_v3 |     q25: MAE=12.0807
2025-11-16 21:26:16 | INFO | core.xgboost_trainer_v3 |     q50: MAE=11.3397
2025-11-16 21:26:24 | INFO | core.xgboost_trainer_v3 |     q75: MAE=12.3791
2025-11-16 21:26:31 | INFO | core.xgboost_trainer_v3 |     q90: MAE=13.7415
2025-11-16 21:26:31 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 634 samples...
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |       q10: 5.7% coverage (target 10.0%)
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |       q25: 15.5% coverage (target 25.0%)
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |       q50: 40.7% coverage (target 50.0%)
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |       q75: 86.9% coverage (target 75.0%)
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |       q90: 96.1% coverage (target 90.0%)
2025-11-16 21:26:31 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 21:26:31 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 21:26:31 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 21:26:35 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.502
2025-11-16 21:26:35 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 21:26:35 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 21:26:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 21:26:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-16 21:26:37 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-16 21:26:38 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-16 21:26:38 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-16 21:26:38 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-16 21:26:38 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 21:26:38 | INFO | __main__ | 
================================================================================
2025-11-16 21:26:38 | INFO | __main__ | TRAINING SUMMARY
2025-11-16 21:26:38 | INFO | __main__ | ================================================================================
2025-11-16 21:26:38 | INFO | __main__ |   Cohorts trained: 7
2025-11-16 21:26:38 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-16 21:26:38 | INFO | __main__ |   Total models: 49
2025-11-16 21:26:38 | INFO | __main__ |   Feature count: 164
2025-11-16 21:26:38 | INFO | __main__ | 
  Cohorts:
2025-11-16 21:26:38 | INFO | __main__ |     - earnings_heavy
2025-11-16 21:26:38 | INFO | __main__ |     - fomc_minus_3
2025-11-16 21:26:38 | INFO | __main__ |     - fomc_week
2025-11-16 21:26:38 | INFO | __main__ |     - futures_rollover
2025-11-16 21:26:38 | INFO | __main__ |     - mid_cycle
2025-11-16 21:26:38 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-16 21:26:38 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-16 21:26:38 | INFO | __main__ | ================================================================================

2025-11-16 21:26:38 | INFO | __main__ | ✅ Training report saved: models/training_report_20251116_212638.json
2025-11-16 21:26:38 | INFO | __main__ | 
================================================================================
2025-11-16 21:26:38 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-16 21:26:38 | INFO | __main__ | ================================================================================
2025-11-16 21:26:38 | INFO | __main__ |   Models saved to: models/
2025-11-16 21:26:38 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-16 21:26:38 | INFO | __main__ | ================================================================================

2025-11-16 22:19:16 | INFO | __main__ | 
================================================================================
2025-11-16 22:19:16 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 22:19:16 | INFO | __main__ | ================================================================================
2025-11-16 22:19:16 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 22:19:16 | INFO | __main__ | Date: 2025-11-16 22:19:16
2025-11-16 22:19:16 | INFO | __main__ | Output: models
2025-11-16 22:19:16 | INFO | __main__ | ================================================================================

2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | ================================================================================
2025-11-16 22:19:16 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 22:19:16 | INFO | __main__ | ================================================================================
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 22:19:16 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 22:19:16 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 22:19:16 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 22:19:16 | INFO | __main__ |     - 1 direction classifier
2025-11-16 22:19:16 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 22:19:16 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 22:19:16 | INFO | __main__ | 
2025-11-16 22:19:16 | ERROR | __main__ | ❌ Configuration validation FAILED
2025-11-16 22:19:16 | ERROR | __main__ |    Please fix the following issues:
2025-11-16 22:19:16 | ERROR | __main__ |   ❌ Target type incorrect: log_vix_change (expected 'vix_pct_change')
2025-11-16 22:19:16 | INFO | __main__ | ================================================================================
2025-11-16 22:19:16 | ERROR | __main__ | 
❌ Configuration validation failed:
  ❌ Target type incorrect: log_vix_change (expected 'vix_pct_change')
2025-11-16 22:19:45 | INFO | __main__ | 
================================================================================
2025-11-16 22:19:45 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 22:19:45 | INFO | __main__ | ================================================================================
2025-11-16 22:19:45 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 22:19:45 | INFO | __main__ | Date: 2025-11-16 22:19:45
2025-11-16 22:19:45 | INFO | __main__ | Output: models
2025-11-16 22:19:45 | INFO | __main__ | ================================================================================

2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | ================================================================================
2025-11-16 22:19:45 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 22:19:45 | INFO | __main__ | ================================================================================
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 22:19:45 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 22:19:45 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 22:19:45 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 22:19:45 | INFO | __main__ |     - 1 direction classifier
2025-11-16 22:19:45 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 22:19:45 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 22:19:45 | INFO | __main__ | 
2025-11-16 22:19:45 | ERROR | __main__ | ❌ Configuration validation FAILED
2025-11-16 22:19:45 | ERROR | __main__ |    Please fix the following issues:
2025-11-16 22:19:45 | ERROR | __main__ |   ❌ Target type incorrect: log_vix_change (expected 'vix_pct_change')
2025-11-16 22:19:45 | INFO | __main__ | ================================================================================
2025-11-16 22:19:45 | ERROR | __main__ | 
❌ Configuration validation failed:
  ❌ Target type incorrect: log_vix_change (expected 'vix_pct_change')
2025-11-16 22:21:58 | INFO | __main__ | 
================================================================================
2025-11-16 22:21:58 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================
2025-11-16 22:21:58 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 22:21:58 | INFO | __main__ | Date: 2025-11-16 22:21:58
2025-11-16 22:21:58 | INFO | __main__ | Output: models
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================

2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================
2025-11-16 22:21:58 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Target type: log_vix_change
2025-11-16 22:21:58 | INFO | __main__ |   ℹ️  Training in LOG-SPACE, converting to percentage for output
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 22:21:58 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 22:21:58 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 22:21:58 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 22:21:58 | INFO | __main__ |     - 1 direction classifier
2025-11-16 22:21:58 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 22:21:58 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 22:21:58 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================
2025-11-16 22:21:58 | INFO | __main__ | 
2025-11-16 22:21:58 | INFO | __main__ | 
================================================================================
2025-11-16 22:21:58 | INFO | __main__ | DATA PREPARATION
2025-11-16 22:21:58 | INFO | __main__ | ================================================================================
2025-11-16 22:21:58 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 22:21:58 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 22:21:58 | INFO | __main__ |   Target period: 20 years ending 2022-12-31
2025-11-16 22:21:58 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 22:22:09 | INFO | __main__ | 
  Features created: 168
  Date range: 2001-10-12 to 2022-12-30
  Total samples: 5342
2025-11-16 22:22:09 | INFO | __main__ |   Usable training samples (after warmup): 4892
2025-11-16 22:22:09 | INFO | __main__ |   Effective training period: 2003-07-29 to 2022-12-30
2025-11-16 22:22:09 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 22:22:09 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 22:22:09 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 22:22:09 | INFO | __main__ |   Cohort distribution:
2025-11-16 22:22:09 | INFO | __main__ |     earnings_heavy: 532 samples
2025-11-16 22:22:09 | INFO | __main__ |     fomc_minus_3: 349 samples
2025-11-16 22:22:09 | INFO | __main__ |     fomc_week: 115 samples
2025-11-16 22:22:09 | INFO | __main__ |     futures_rollover: 233 samples
2025-11-16 22:22:09 | INFO | __main__ |     mid_cycle: 2776 samples
2025-11-16 22:22:09 | INFO | __main__ |     monthly_opex_minus_1: 703 samples
2025-11-16 22:22:09 | INFO | __main__ |     monthly_opex_minus_5: 634 samples
2025-11-16 22:22:09 | INFO | __main__ | 
  Final dataframe shape: (5342, 169)
2025-11-16 22:22:09 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 22:22:09 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 22:22:09 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 22:22:09 | INFO | __main__ | ================================================================================

2025-11-16 22:22:09 | INFO | __main__ | 
2025-11-16 22:22:09 | INFO | __main__ | ================================================================================
2025-11-16 22:22:09 | INFO | __main__ | MODEL TRAINING
2025-11-16 22:22:09 | INFO | __main__ | ================================================================================
2025-11-16 22:22:09 | INFO | __main__ | 
2025-11-16 22:22:09 | INFO | __main__ | Starting training...
2025-11-16 22:22:09 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 22:22:09 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 22:22:09 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 22:22:09 | INFO | __main__ | 
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |     Total samples: 5342
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |     Valid targets: 5337
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |     Training in: LOG-SPACE
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |     Output in: PERCENTAGE-SPACE
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (532 samples)
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:22:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:22:17 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0684 (log-space)
2025-11-16 22:22:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0348 (log-space)
2025-11-16 22:22:34 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0196 (log-space)
2025-11-16 22:22:41 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0310 (log-space)
2025-11-16 22:22:47 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0689 (log-space)
2025-11-16 22:22:47 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 532 samples...
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |       q10: 1.7% coverage (target 10.0%)
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |       q25: 14.1% coverage (target 25.0%)
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |       q50: 49.6% coverage (target 50.0%)
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |       q75: 79.9% coverage (target 75.0%)
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |       q90: 95.5% coverage (target 90.0%)
2025-11-16 22:22:47 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:22:47 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:22:47 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:22:49 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.994
2025-11-16 22:22:49 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:22:49 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.014
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (349 samples)
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:22:51 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:22:54 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1085 (log-space)
2025-11-16 22:22:59 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0621 (log-space)
2025-11-16 22:23:04 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0389 (log-space)
2025-11-16 22:23:09 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0590 (log-space)
2025-11-16 22:23:12 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0897 (log-space)
2025-11-16 22:23:12 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 349 samples...
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |       q10: 3.7% coverage (target 10.0%)
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |       q25: 9.2% coverage (target 25.0%)
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |       q50: 49.6% coverage (target 50.0%)
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |       q75: 84.8% coverage (target 75.0%)
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |       q90: 92.8% coverage (target 90.0%)
2025-11-16 22:23:12 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:23:12 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:23:12 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:23:13 | INFO | core.xgboost_trainer_v3 |     Accuracy: 1.000
2025-11-16 22:23:13 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:23:13 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.020
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (115 samples)
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:23:14 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:23:16 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1159 (log-space)
2025-11-16 22:23:17 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0755 (log-space)
2025-11-16 22:23:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0495 (log-space)
2025-11-16 22:23:21 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0979 (log-space)
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1187 (log-space)
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |       q10: 3.5% coverage (target 10.0%)
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |       q25: 15.7% coverage (target 25.0%)
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |       q50: 75.7% coverage (target 50.0%)
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |       q75: 92.2% coverage (target 75.0%)
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |       q90: 99.1% coverage (target 90.0%)
2025-11-16 22:23:23 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |     Accuracy: 1.000
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:23:23 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (233 samples)
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:23:24 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:23:27 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0804 (log-space)
2025-11-16 22:23:30 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0545 (log-space)
2025-11-16 22:23:35 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0291 (log-space)
2025-11-16 22:23:38 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0442 (log-space)
2025-11-16 22:23:41 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0693 (log-space)
2025-11-16 22:23:41 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 233 samples...
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |       q10: 6.0% coverage (target 10.0%)
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |       q25: 18.0% coverage (target 25.0%)
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |       q50: 44.2% coverage (target 50.0%)
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |       q75: 89.3% coverage (target 75.0%)
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |       q90: 96.1% coverage (target 90.0%)
2025-11-16 22:23:41 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:23:41 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:23:41 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:23:42 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.993
2025-11-16 22:23:42 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:23:42 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (2776 samples)
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:23:43 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:23:55 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0281 (log-space)
2025-11-16 22:24:09 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0154 (log-space)
2025-11-16 22:24:24 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0114 (log-space)
2025-11-16 22:24:37 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0133 (log-space)
2025-11-16 22:24:49 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0267 (log-space)
2025-11-16 22:24:49 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 2771 samples...
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |       q10: 8.0% coverage (target 10.0%)
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |       q25: 21.2% coverage (target 25.0%)
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |       q50: 50.2% coverage (target 50.0%)
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |       q75: 72.4% coverage (target 75.0%)
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |       q90: 91.8% coverage (target 90.0%)
2025-11-16 22:24:49 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:24:49 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:24:49 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:24:52 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.997
2025-11-16 22:24:52 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:24:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.013
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (703 samples)
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:24:55 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:25:02 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0601 (log-space)
2025-11-16 22:25:10 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0307 (log-space)
2025-11-16 22:25:20 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0232 (log-space)
2025-11-16 22:25:29 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0330 (log-space)
2025-11-16 22:25:35 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0700 (log-space)
2025-11-16 22:25:35 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 703 samples...
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |       q10: 5.7% coverage (target 10.0%)
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |       q25: 22.0% coverage (target 25.0%)
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |       q50: 48.8% coverage (target 50.0%)
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |       q75: 80.7% coverage (target 75.0%)
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |       q90: 95.6% coverage (target 90.0%)
2025-11-16 22:25:35 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:25:35 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:25:35 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:25:37 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.996
2025-11-16 22:25:37 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:25:37 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (634 samples)
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 22:25:39 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 22:25:45 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.0680 (log-space)
2025-11-16 22:25:54 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0306 (log-space)
2025-11-16 22:26:03 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.0207 (log-space)
2025-11-16 22:26:11 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.0274 (log-space)
2025-11-16 22:26:17 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.0538 (log-space)
2025-11-16 22:26:17 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 634 samples...
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |       q10: 6.5% coverage (target 10.0%)
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |       q25: 16.1% coverage (target 25.0%)
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |       q50: 62.6% coverage (target 50.0%)
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |       q75: 78.1% coverage (target 75.0%)
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |       q90: 96.2% coverage (target 90.0%)
2025-11-16 22:26:17 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 22:26:17 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 22:26:17 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 22:26:19 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.998
2025-11-16 22:26:19 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 22:26:19 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 22:26:21 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 22:26:21 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-16 22:26:21 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-16 22:26:22 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-16 22:26:22 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-16 22:26:22 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-16 22:26:22 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 22:26:22 | INFO | __main__ | 
================================================================================
2025-11-16 22:26:22 | INFO | __main__ | TRAINING SUMMARY
2025-11-16 22:26:22 | INFO | __main__ | ================================================================================
2025-11-16 22:26:22 | INFO | __main__ |   Cohorts trained: 7
2025-11-16 22:26:22 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-16 22:26:22 | INFO | __main__ |   Total models: 49
2025-11-16 22:26:22 | INFO | __main__ |   Feature count: 167
2025-11-16 22:26:22 | INFO | __main__ | 
  Cohorts:
2025-11-16 22:26:22 | INFO | __main__ |     - earnings_heavy
2025-11-16 22:26:22 | INFO | __main__ |     - fomc_minus_3
2025-11-16 22:26:22 | INFO | __main__ |     - fomc_week
2025-11-16 22:26:22 | INFO | __main__ |     - futures_rollover
2025-11-16 22:26:22 | INFO | __main__ |     - mid_cycle
2025-11-16 22:26:22 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-16 22:26:22 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-16 22:26:22 | INFO | __main__ | ================================================================================

2025-11-16 22:26:22 | INFO | __main__ | ✅ Training report saved: models/training_report_20251116_222622.json
2025-11-16 22:26:22 | INFO | __main__ | 
================================================================================
2025-11-16 22:26:22 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-16 22:26:22 | INFO | __main__ | ================================================================================
2025-11-16 22:26:22 | INFO | __main__ |   Models saved to: models/
2025-11-16 22:26:22 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-16 22:26:22 | INFO | __main__ | ================================================================================

2025-11-16 23:11:34 | INFO | __main__ | 
================================================================================
2025-11-16 23:11:34 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================
2025-11-16 23:11:34 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 23:11:34 | INFO | __main__ | Date: 2025-11-16 23:11:34
2025-11-16 23:11:34 | INFO | __main__ | Output: models
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================

2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================
2025-11-16 23:11:34 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Target type: log_vix_change
2025-11-16 23:11:34 | INFO | __main__ |   ℹ️  Training in LOG-SPACE, converting to percentage for output
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 23:11:34 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 23:11:34 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 23:11:34 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 23:11:34 | INFO | __main__ |     - 1 direction classifier
2025-11-16 23:11:34 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 23:11:34 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 23:11:34 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================
2025-11-16 23:11:34 | INFO | __main__ | 
2025-11-16 23:11:34 | INFO | __main__ | 
================================================================================
2025-11-16 23:11:34 | INFO | __main__ | DATA PREPARATION
2025-11-16 23:11:34 | INFO | __main__ | ================================================================================
2025-11-16 23:11:34 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 23:11:34 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 23:11:34 | INFO | __main__ |   Target period: 20 years ending 2022-12-31
2025-11-16 23:11:34 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 23:11:42 | INFO | __main__ | 
  Features created: 168
  Date range: 2001-10-12 to 2022-12-30
  Total samples: 5342
2025-11-16 23:11:42 | INFO | __main__ |   Usable training samples (after warmup): 4892
2025-11-16 23:11:42 | INFO | __main__ |   Effective training period: 2003-07-29 to 2022-12-30
2025-11-16 23:11:42 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 23:11:42 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 23:11:42 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 23:11:42 | INFO | __main__ |   Cohort distribution:
2025-11-16 23:11:42 | INFO | __main__ |     earnings_heavy: 532 samples
2025-11-16 23:11:42 | INFO | __main__ |     fomc_minus_3: 349 samples
2025-11-16 23:11:42 | INFO | __main__ |     fomc_week: 115 samples
2025-11-16 23:11:42 | INFO | __main__ |     futures_rollover: 233 samples
2025-11-16 23:11:42 | INFO | __main__ |     mid_cycle: 2776 samples
2025-11-16 23:11:42 | INFO | __main__ |     monthly_opex_minus_1: 703 samples
2025-11-16 23:11:42 | INFO | __main__ |     monthly_opex_minus_5: 634 samples
2025-11-16 23:11:42 | INFO | __main__ | 
  Final dataframe shape: (5342, 169)
2025-11-16 23:11:42 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 23:11:42 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 23:11:42 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 23:11:42 | INFO | __main__ | ================================================================================

2025-11-16 23:11:42 | INFO | __main__ | 
2025-11-16 23:11:42 | INFO | __main__ | ================================================================================
2025-11-16 23:11:42 | INFO | __main__ | MODEL TRAINING
2025-11-16 23:11:42 | INFO | __main__ | ================================================================================
2025-11-16 23:11:42 | INFO | __main__ | 
2025-11-16 23:11:42 | INFO | __main__ | Starting training...
2025-11-16 23:11:42 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 23:11:42 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 23:11:42 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 23:11:42 | INFO | __main__ | 
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |     Total samples: 5342
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |     Valid targets: 5337
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |     Training in: LOG-SPACE
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |     Output in: PERCENTAGE-SPACE
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (532 samples)
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:11:42 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:11:49 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1129 (log-space)
2025-11-16 23:11:56 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1052 (log-space)
2025-11-16 23:12:05 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1093 (log-space)
2025-11-16 23:12:12 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1264 (log-space)
2025-11-16 23:12:18 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1459 (log-space)
2025-11-16 23:12:18 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 532 samples...
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |       q10: 5.3% coverage (target 10.0%)
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |       q25: 13.5% coverage (target 25.0%)
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |       q50: 45.3% coverage (target 50.0%)
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |       q75: 85.2% coverage (target 75.0%)
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |       q90: 93.4% coverage (target 90.0%)
2025-11-16 23:12:18 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:12:18 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:12:18 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:12:22 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.637
2025-11-16 23:12:22 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:12:22 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (349 samples)
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:12:24 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:12:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1697 (log-space)
2025-11-16 23:12:32 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1413 (log-space)
2025-11-16 23:12:37 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1336 (log-space)
2025-11-16 23:12:41 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1533 (log-space)
2025-11-16 23:12:45 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1781 (log-space)
2025-11-16 23:12:45 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 349 samples...
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |       q10: 2.9% coverage (target 10.0%)
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |       q25: 10.9% coverage (target 25.0%)
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |       q50: 57.3% coverage (target 50.0%)
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |       q75: 91.1% coverage (target 75.0%)
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |       q90: 95.7% coverage (target 90.0%)
2025-11-16 23:12:45 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:12:45 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:12:45 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:12:47 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.618
2025-11-16 23:12:47 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:12:47 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.020
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (115 samples)
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:12:48 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:12:50 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1461 (log-space)
2025-11-16 23:12:52 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1289 (log-space)
2025-11-16 23:12:54 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1335 (log-space)
2025-11-16 23:12:56 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1566 (log-space)
2025-11-16 23:12:57 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1577 (log-space)
2025-11-16 23:12:57 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |       q10: 1.7% coverage (target 10.0%)
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |       q25: 10.4% coverage (target 25.0%)
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |       q50: 48.7% coverage (target 50.0%)
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |       q75: 91.3% coverage (target 75.0%)
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |       q90: 98.3% coverage (target 90.0%)
2025-11-16 23:12:57 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:12:57 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:12:57 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:12:58 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.517
2025-11-16 23:12:58 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:12:58 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (233 samples)
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:12:59 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:13:02 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1099 (log-space)
2025-11-16 23:13:06 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.0982 (log-space)
2025-11-16 23:13:10 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1016 (log-space)
2025-11-16 23:13:14 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1133 (log-space)
2025-11-16 23:13:17 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1292 (log-space)
2025-11-16 23:13:17 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 233 samples...
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |       q10: 3.9% coverage (target 10.0%)
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |       q25: 11.6% coverage (target 25.0%)
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |       q50: 30.5% coverage (target 50.0%)
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |       q75: 87.1% coverage (target 75.0%)
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |       q90: 97.0% coverage (target 90.0%)
2025-11-16 23:13:17 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:13:17 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:13:17 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:13:18 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-16 23:13:18 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:13:19 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (2776 samples)
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:13:20 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:13:31 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1258 (log-space)
2025-11-16 23:13:45 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1122 (log-space)
2025-11-16 23:14:00 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1110 (log-space)
2025-11-16 23:14:14 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1352 (log-space)
2025-11-16 23:14:25 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1768 (log-space)
2025-11-16 23:14:25 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 2771 samples...
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |       q10: 8.9% coverage (target 10.0%)
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |       q25: 22.4% coverage (target 25.0%)
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |       q50: 51.5% coverage (target 50.0%)
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |       q75: 76.8% coverage (target 75.0%)
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |       q90: 90.8% coverage (target 90.0%)
2025-11-16 23:14:25 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:14:25 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:14:25 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:14:34 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.569
2025-11-16 23:14:34 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:14:34 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.013
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (703 samples)
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:14:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:14:44 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1208 (log-space)
2025-11-16 23:14:52 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1080 (log-space)
2025-11-16 23:15:01 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1092 (log-space)
2025-11-16 23:15:09 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1415 (log-space)
2025-11-16 23:15:15 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1685 (log-space)
2025-11-16 23:15:15 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 703 samples...
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |       q10: 5.4% coverage (target 10.0%)
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |       q25: 13.2% coverage (target 25.0%)
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |       q50: 41.1% coverage (target 50.0%)
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |       q75: 75.5% coverage (target 75.0%)
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |       q90: 96.9% coverage (target 90.0%)
2025-11-16 23:15:15 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:15:15 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:15:15 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:15:20 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.623
2025-11-16 23:15:20 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:15:20 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (634 samples)
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 |   Training on LOG-SPACE target (will convert to % for output)
2025-11-16 23:15:21 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:15:28 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.1325 (log-space)
2025-11-16 23:15:36 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1153 (log-space)
2025-11-16 23:15:44 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1077 (log-space)
2025-11-16 23:15:52 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1131 (log-space)
2025-11-16 23:15:59 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1281 (log-space)
2025-11-16 23:15:59 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 634 samples...
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |       q10: 5.7% coverage (target 10.0%)
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |       q25: 11.8% coverage (target 25.0%)
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |       q50: 36.6% coverage (target 50.0%)
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |       q75: 84.9% coverage (target 75.0%)
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |       q90: 95.0% coverage (target 90.0%)
2025-11-16 23:15:59 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:15:59 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:15:59 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:16:03 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.502
2025-11-16 23:16:03 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:16:03 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-16 23:16:05 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:16:05 | INFO | __main__ | 
================================================================================
2025-11-16 23:16:05 | INFO | __main__ | TRAINING SUMMARY
2025-11-16 23:16:05 | INFO | __main__ | ================================================================================
2025-11-16 23:16:05 | INFO | __main__ |   Cohorts trained: 7
2025-11-16 23:16:05 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-16 23:16:05 | INFO | __main__ |   Total models: 49
2025-11-16 23:16:05 | INFO | __main__ |   Feature count: 164
2025-11-16 23:16:05 | INFO | __main__ | 
  Cohorts:
2025-11-16 23:16:05 | INFO | __main__ |     - earnings_heavy
2025-11-16 23:16:05 | INFO | __main__ |     - fomc_minus_3
2025-11-16 23:16:05 | INFO | __main__ |     - fomc_week
2025-11-16 23:16:05 | INFO | __main__ |     - futures_rollover
2025-11-16 23:16:05 | INFO | __main__ |     - mid_cycle
2025-11-16 23:16:05 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-16 23:16:05 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-16 23:16:05 | INFO | __main__ | ================================================================================

2025-11-16 23:16:05 | INFO | __main__ | ✅ Training report saved: models/training_report_20251116_231605.json
2025-11-16 23:16:05 | INFO | __main__ | 
================================================================================
2025-11-16 23:16:05 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-16 23:16:05 | INFO | __main__ | ================================================================================
2025-11-16 23:16:05 | INFO | __main__ |   Models saved to: models/
2025-11-16 23:16:05 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-16 23:16:05 | INFO | __main__ | ================================================================================

2025-11-16 23:49:22 | INFO | __main__ | 
================================================================================
2025-11-16 23:49:22 | INFO | __main__ | PROBABILISTIC VIX FORECASTER - TRAINING PIPELINE
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================
2025-11-16 23:49:22 | INFO | __main__ | Version: 3.0 (Log-Transformed Realized Volatility)
2025-11-16 23:49:22 | INFO | __main__ | Date: 2025-11-16 23:49:22
2025-11-16 23:49:22 | INFO | __main__ | Output: models
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================

2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================
2025-11-16 23:49:22 | INFO | __main__ | CONFIGURATION VALIDATION
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | [1/4] Validating target configuration...
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Target type: log_vix_change
2025-11-16 23:49:22 | INFO | __main__ |   ℹ️  Training in LOG-SPACE, converting to percentage for output
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Movement bounds: [-50.0, 100.0]
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | [2/4] Validating model objectives...
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Point estimate removed
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Uncertainty estimate removed
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | [3/4] Validating quantile configuration...
2025-11-16 23:49:22 | INFO | __main__ |   ✅ All quantile objectives present
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Quantile objectives correctly configured
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | [4/4] Validating expected model count...
2025-11-16 23:49:22 | INFO | __main__ |   Expected models per cohort: 7
2025-11-16 23:49:22 | INFO | __main__ |     - 5 quantile regressors (q10, q25, q50, q75, q90)
2025-11-16 23:49:22 | INFO | __main__ |     - 1 direction classifier
2025-11-16 23:49:22 | INFO | __main__ |     - 1 confidence scorer
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Direction classifier configured
2025-11-16 23:49:22 | INFO | __main__ |   ✅ Confidence model configured
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | ✅ Configuration validation PASSED
2025-11-16 23:49:22 | INFO | __main__ |    All checks successful - ready to train
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================
2025-11-16 23:49:22 | INFO | __main__ | 
2025-11-16 23:49:22 | INFO | __main__ | 
================================================================================
2025-11-16 23:49:22 | INFO | __main__ | DATA PREPARATION
2025-11-16 23:49:22 | INFO | __main__ | ================================================================================
2025-11-16 23:49:22 | INFO | __main__ | 
[1/4] Initializing feature engineering pipeline...
2025-11-16 23:49:22 | INFO | __main__ | 
[2/4] Building feature set for training period...
2025-11-16 23:49:22 | INFO | __main__ |   Target period: 20 years ending 2022-12-31
2025-11-16 23:49:22 | INFO | __main__ |   This includes ~450 days warmup for technical indicators
2025-11-16 23:49:31 | INFO | __main__ | 
  Features created: 168
  Date range: 2001-10-12 to 2022-12-30
  Total samples: 5342
2025-11-16 23:49:31 | INFO | __main__ |   Usable training samples (after warmup): 4892
2025-11-16 23:49:31 | INFO | __main__ |   Effective training period: 2003-07-29 to 2022-12-30
2025-11-16 23:49:31 | INFO | __main__ | 
[3/4] Merging features with price data...
2025-11-16 23:49:31 | INFO | __main__ |   Assigning calendar cohorts using feature_engine logic...
2025-11-16 23:49:31 | INFO | __main__ | 
[4/4] Validating temporal hygiene...
2025-11-16 23:49:31 | INFO | __main__ |   Cohort distribution:
2025-11-16 23:49:31 | INFO | __main__ |     earnings_heavy: 532 samples
2025-11-16 23:49:31 | INFO | __main__ |     fomc_minus_3: 349 samples
2025-11-16 23:49:31 | INFO | __main__ |     fomc_week: 115 samples
2025-11-16 23:49:31 | INFO | __main__ |     futures_rollover: 233 samples
2025-11-16 23:49:31 | INFO | __main__ |     mid_cycle: 2776 samples
2025-11-16 23:49:31 | INFO | __main__ |     monthly_opex_minus_1: 703 samples
2025-11-16 23:49:31 | INFO | __main__ |     monthly_opex_minus_5: 634 samples
2025-11-16 23:49:31 | INFO | __main__ | 
  Final dataframe shape: (5342, 169)
2025-11-16 23:49:31 | INFO | __main__ |   Columns: features (166) + vix + spx + calendar_cohort
2025-11-16 23:49:31 | INFO | __main__ | 
✅ Data preparation complete
2025-11-16 23:49:31 | INFO | __main__ | ✅ Temporal hygiene validated: All data ≤ 2022-12-31
2025-11-16 23:49:31 | INFO | __main__ | ================================================================================

2025-11-16 23:49:31 | INFO | __main__ | 
2025-11-16 23:49:31 | INFO | __main__ | ================================================================================
2025-11-16 23:49:31 | INFO | __main__ | MODEL TRAINING
2025-11-16 23:49:31 | INFO | __main__ | ================================================================================
2025-11-16 23:49:31 | INFO | __main__ | 
2025-11-16 23:49:31 | INFO | __main__ | Starting training...
2025-11-16 23:49:31 | INFO | __main__ |   Models per cohort: 7 (5 quantiles, direction, confidence)
2025-11-16 23:49:31 | INFO | __main__ |   Primary forecast: Median (50th percentile)
2025-11-16 23:49:31 | INFO | __main__ |   Target: Log-transformed forward realized volatility
2025-11-16 23:49:31 | INFO | __main__ | 
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | REFACTORED QUANTILE REGRESSION TRAINING
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |   Target creation:
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |     Total samples: 5342
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |     Valid targets: 5337
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |     NaN targets: 5 (last 5 days)
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |     Training target: log(future_vix)
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |     Output format: percentage change
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | 
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | 
Training 7 cohorts: ['earnings_heavy', 'fomc_minus_3', 'fomc_week', 'futures_rollover', 'mid_cycle', 'monthly_opex_minus_1', 'monthly_opex_minus_5']
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | Cohort: earnings_heavy (532 samples)
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:49:31 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:49:37 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712 (log-space)
2025-11-16 23:49:44 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1725 (log-space)
2025-11-16 23:49:53 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1785 (log-space)
2025-11-16 23:50:01 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1779 (log-space)
2025-11-16 23:50:07 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2248 (log-space)
2025-11-16 23:50:07 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 532 samples...
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |       q10: 3.6% coverage (target 10.0%)
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |       q25: 16.5% coverage (target 25.0%)
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |       q50: 47.6% coverage (target 50.0%)
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |       q75: 80.8% coverage (target 75.0%)
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |       q90: 95.7% coverage (target 90.0%)
2025-11-16 23:50:07 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:50:07 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:50:07 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:50:11 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.637
2025-11-16 23:50:11 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:50:11 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 | ✅ Saved: earnings_heavy
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_minus_3 (349 samples)
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:50:13 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:50:16 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3581 (log-space)
2025-11-16 23:50:20 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.2599 (log-space)
2025-11-16 23:50:25 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2354 (log-space)
2025-11-16 23:50:30 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.2325 (log-space)
2025-11-16 23:50:33 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2919 (log-space)
2025-11-16 23:50:33 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 349 samples...
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |       q10: 4.0% coverage (target 10.0%)
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |       q25: 11.5% coverage (target 25.0%)
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |       q50: 42.4% coverage (target 50.0%)
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |       q75: 82.8% coverage (target 75.0%)
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |       q90: 93.1% coverage (target 90.0%)
2025-11-16 23:50:33 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:50:33 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:50:33 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:50:36 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.618
2025-11-16 23:50:36 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:50:36 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.020
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_minus_3
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 | Cohort: fomc_week (115 samples)
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:50:37 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:50:38 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.3488 (log-space)
2025-11-16 23:50:40 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.2432 (log-space)
2025-11-16 23:50:42 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.2109 (log-space)
2025-11-16 23:50:44 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1961 (log-space)
2025-11-16 23:50:45 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2354 (log-space)
2025-11-16 23:50:45 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 115 samples...
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |       q10: 4.3% coverage (target 10.0%)
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |       q25: 12.2% coverage (target 25.0%)
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |       q50: 59.1% coverage (target 50.0%)
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |       q75: 93.0% coverage (target 75.0%)
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |       q90: 93.0% coverage (target 90.0%)
2025-11-16 23:50:45 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:50:45 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:50:45 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:50:46 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.517
2025-11-16 23:50:46 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:50:46 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.017
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 | ✅ Saved: fomc_week
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 | Cohort: futures_rollover (233 samples)
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:50:47 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:50:51 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2225 (log-space)
2025-11-16 23:50:55 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1815 (log-space)
2025-11-16 23:50:59 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1574 (log-space)
2025-11-16 23:51:03 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1823 (log-space)
2025-11-16 23:51:06 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2342 (log-space)
2025-11-16 23:51:06 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 233 samples...
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |       q10: 6.0% coverage (target 10.0%)
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |       q25: 12.4% coverage (target 25.0%)
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |       q50: 30.0% coverage (target 50.0%)
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |       q75: 83.7% coverage (target 75.0%)
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |       q90: 95.3% coverage (target 90.0%)
2025-11-16 23:51:06 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:51:06 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:51:06 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:51:08 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.638
2025-11-16 23:51:08 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:51:08 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.016
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 | ✅ Saved: futures_rollover
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 | Cohort: mid_cycle (2776 samples)
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:51:09 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:51:21 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2045 (log-space)
2025-11-16 23:51:34 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1809 (log-space)
2025-11-16 23:51:48 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1582 (log-space)
2025-11-16 23:52:02 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1628 (log-space)
2025-11-16 23:52:14 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.1873 (log-space)
2025-11-16 23:52:14 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 2771 samples...
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |       q10: 8.3% coverage (target 10.0%)
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |       q25: 25.2% coverage (target 25.0%)
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |       q50: 48.5% coverage (target 50.0%)
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |       q75: 77.2% coverage (target 75.0%)
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |       q90: 92.7% coverage (target 90.0%)
2025-11-16 23:52:14 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:52:14 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:52:14 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:52:24 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.569
2025-11-16 23:52:24 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:52:24 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.013
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 | ✅ Saved: mid_cycle
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_1 (703 samples)
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:52:27 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:52:33 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2325 (log-space)
2025-11-16 23:52:41 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1665 (log-space)
2025-11-16 23:52:50 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1544 (log-space)
2025-11-16 23:52:58 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1903 (log-space)
2025-11-16 23:53:05 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2277 (log-space)
2025-11-16 23:53:05 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 703 samples...
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |       q10: 4.1% coverage (target 10.0%)
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |       q25: 14.8% coverage (target 25.0%)
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |       q50: 40.4% coverage (target 50.0%)
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |       q75: 76.7% coverage (target 75.0%)
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |       q90: 94.9% coverage (target 90.0%)
2025-11-16 23:53:05 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:53:05 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:53:05 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:53:10 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.623
2025-11-16 23:53:10 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:53:10 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_1
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 | 
────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 | Cohort: monthly_opex_minus_5 (634 samples)
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 | ────────────────────────────────────────────────────────────────────────────────
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 |   Training to predict log(future_vix)
2025-11-16 23:53:11 | INFO | core.xgboost_trainer_v3 |   Training quantile regression models...
2025-11-16 23:53:18 | INFO | core.xgboost_trainer_v3 |     q10: MAE=0.2712 (log-space)
2025-11-16 23:53:26 | INFO | core.xgboost_trainer_v3 |     q25: MAE=0.1936 (log-space)
2025-11-16 23:53:34 | INFO | core.xgboost_trainer_v3 |     q50: MAE=0.1797 (log-space)
2025-11-16 23:53:42 | INFO | core.xgboost_trainer_v3 |     q75: MAE=0.1652 (log-space)
2025-11-16 23:53:48 | INFO | core.xgboost_trainer_v3 |     q90: MAE=0.2284 (log-space)
2025-11-16 23:53:48 | INFO | core.xgboost_trainer_v3 |   Calibrating quantile predictions...
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |    Fitting quantile calibrator on 634 samples...
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |       q10: 4.3% coverage (target 10.0%)
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |       q25: 11.8% coverage (target 25.0%)
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |       q50: 43.5% coverage (target 50.0%)
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |       q75: 89.1% coverage (target 75.0%)
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |       q90: 86.4% coverage (target 90.0%)
2025-11-16 23:53:48 | INFO | core.forecast_calibrator |    ✅ Quantile calibrator fitted
2025-11-16 23:53:48 | INFO | core.xgboost_trainer_v3 |   ✅ Quantile calibration complete
2025-11-16 23:53:48 | INFO | core.xgboost_trainer_v3 |   Training direction classifier...
2025-11-16 23:53:52 | INFO | core.xgboost_trainer_v3 |     Accuracy: 0.502
2025-11-16 23:53:52 | INFO | core.xgboost_trainer_v3 |   Calibrating direction probabilities...
2025-11-16 23:53:52 | INFO | core.xgboost_trainer_v3 |   Training confidence model...
2025-11-16 23:53:54 | INFO | core.xgboost_trainer_v3 |     RMSE: 0.015
2025-11-16 23:53:54 | INFO | core.xgboost_trainer_v3 | ✅ Saved: monthly_opex_minus_5
2025-11-16 23:53:54 | INFO | core.xgboost_trainer_v3 |   Saved metrics: models/training_metrics.json
2025-11-16 23:53:55 | INFO | core.xgboost_trainer_v3 |   Saved plots: models/model_performance.png
2025-11-16 23:53:55 | INFO | core.xgboost_trainer_v3 | 
================================================================================
2025-11-16 23:53:55 | INFO | core.xgboost_trainer_v3 | TRAINING COMPLETE
2025-11-16 23:53:55 | INFO | core.xgboost_trainer_v3 | ================================================================================
2025-11-16 23:53:55 | INFO | __main__ | 
================================================================================
2025-11-16 23:53:55 | INFO | __main__ | TRAINING SUMMARY
2025-11-16 23:53:55 | INFO | __main__ | ================================================================================
2025-11-16 23:53:55 | INFO | __main__ |   Cohorts trained: 7
2025-11-16 23:53:55 | INFO | __main__ |   Models per cohort: 7 (5 quantiles + direction + confidence)
2025-11-16 23:53:55 | INFO | __main__ |   Total models: 49
2025-11-16 23:53:55 | INFO | __main__ |   Feature count: 164
2025-11-16 23:53:55 | INFO | __main__ | 
  Cohorts:
2025-11-16 23:53:55 | INFO | __main__ |     - earnings_heavy
2025-11-16 23:53:55 | INFO | __main__ |     - fomc_minus_3
2025-11-16 23:53:55 | INFO | __main__ |     - fomc_week
2025-11-16 23:53:55 | INFO | __main__ |     - futures_rollover
2025-11-16 23:53:55 | INFO | __main__ |     - mid_cycle
2025-11-16 23:53:55 | INFO | __main__ |     - monthly_opex_minus_1
2025-11-16 23:53:55 | INFO | __main__ |     - monthly_opex_minus_5
2025-11-16 23:53:55 | INFO | __main__ | ================================================================================

2025-11-16 23:53:55 | INFO | __main__ | ✅ Training report saved: models/training_report_20251116_235355.json
2025-11-16 23:53:55 | INFO | __main__ | 
================================================================================
2025-11-16 23:53:55 | INFO | __main__ | ✅ TRAINING COMPLETE
2025-11-16 23:53:55 | INFO | __main__ | ================================================================================
2025-11-16 23:53:55 | INFO | __main__ |   Models saved to: models/
2025-11-16 23:53:55 | INFO | __main__ |   Training report: models/training_report_*.json
2025-11-16 23:53:55 | INFO | __main__ | ================================================================================

